<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8" />

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<meta name="keywords" content="zhangyao blog">
<meta name="description" content="ç”Ÿæ­»çœ‹æ·¡ï¼Œä¸æœå°±å¹²">
<meta name="theme-color" content="#000">
<title>2019å¹´æ€»ç»“ | will</title>
<link rel="shortcut icon" href="/favicon.ico?v=1612427475879">
<link rel="stylesheet" href="/media/css/pisces.css">
<link rel="stylesheet" href="/media/fonts/font-awesome.css">
<link
  href="//fonts.googleapis.com/css?family=Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Rosario:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext"
  rel="stylesheet" type="text/css">

<link href="/media/hljs/styles/androidstudio.css"
  rel="stylesheet">

<link rel="stylesheet" href="/styles/main.css">

<script src="/media/hljs/highlight.js"></script>
<script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.0/velocity.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.0/velocity.ui.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css"
  integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">


<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js"
  integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js"
  integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"
  onload="renderMathInElement(document.body);"></script>





  <meta name="description" content="2019å¹´æ€»ç»“" />
  <meta name="keywords" content="æ€»ç»“" />
</head>

<body>
  <div class="head-top-line"></div>
  <div class="header-box">
    
<div class="pisces">
  <header class="header  ">
    <div class="blog-header box-shadow-wrapper bg-color " id="header">
      <div class="nav-toggle" id="nav_toggle">
        <div class="toggle-box">
          <div class="line line-top"></div>
          <div class="line line-center"></div>
          <div class="line line-bottom"></div>
        </div>
      </div>
      <div class="site-meta">       
        <div class="site-title">
          
            <a href="/" class="brand">
              <span>will</span>
            </a>  
          
        </div>
        
          <p class="subtitle">ç”Ÿæ­»çœ‹æ·¡ï¼Œä¸æœå°±å¹²</p>
        
      </div>
      <nav class="site-nav" id="site_nav">
        <ul id="nav_ul">
          
            
            
              
            
            <li class="nav-item ">
              
              
                <a href="/" target="_self">
                  <i class="fa fa-home"></i> é¦–é¡µ
                </a>
              
            </li>
          
            
            
              
            
            <li class="nav-item ">
              
              
                <a href="/archives/" target="_self">
                  <i class="fa fa-archive"></i> å½’æ¡£
                </a>
              
            </li>
          
            
            
              
            
            <li class="nav-item ">
              
              
                <a href="/tags/" target="_self">
                  <i class="fa fa-tags"></i> æ ‡ç­¾
                </a>
              
            </li>
          
            
            
              
            
            <li class="nav-item ">
              
              
                <a href="/post/about/" target="_self">
                  <i class="fa fa-user"></i> å…³äº
                </a>
              
            </li>
          
          
            
              <li class="nav-item ">
                <a href="/friends/" target="_self">
                  
                    <i class="fa fa-address-book"></i> å‹æƒ…é“¾æ¥
                  
                </a>
              </li>
            
          
          
            <li id="fa_search" class="nav-item">
              <a href="javascript:void(0);">
                <i class="fa fa-search"></i> <span class="language" data-lan="search">æœç´¢</span>
              </a>
            </li>
          
        </ul>
      </nav>
    </div>
  </header>
</div>

<script type="text/javascript"> 
 
  let showNav = true;

  let navToggle = document.querySelector('#nav_toggle'),
  siteNav = document.querySelector('#site_nav');
  
  function navClick() {
    let sideBar = document.querySelector('.sidebar');
    let navUl = document.querySelector('#nav_ul');
    navToggle.classList.toggle('nav-toggle-active');
    siteNav.classList.toggle('nav-menu-active');
    if (siteNav.classList.contains('nav-menu-active')) {
      siteNav.style = "height: " + (navUl.children.length * 42) +"px !important";
    } else {
      siteNav.style = "";
    }
  }

  navToggle.addEventListener('click',navClick);  
</script>
  </div>
  <div class="main-continer">
    
    <div
      class="section-layout pisces ">
      <div class="section-layout-wrapper">
        

<div class="sidebar">
  
    <div class="sidebar-box box-shadow-wrapper bg-color right-motion" id="sidebar">
      
        <div class="post-list-sidebar">
          <div class="sidebar-title">
            <span id="tocSideBar" class="sidebar-title-item sidebar-title-active language" data-lan="index">æ–‡ç« ç›®å½•</span>
            <span id="metaSideBar" class="sidebar-title-item language" data-lan="preview">ç«™ç‚¹æ¦‚è§ˆ</span>
          </div>
        </div>
      
      <div class="sidebar-body pisces" id="sidebar_body">
        
          
            
<div class="sidebar-wrapper box-shadow-wrapper bg-color">
  <div class="sidebar-item">
    <img class="site-author-image right-motion" src="/images/avatar.png"/>
    <p class="site-author-name">will</p>
    
  </div>
  <div class="sidebar-item side-item-stat right-motion">
    <div class="sidebar-item-box">
      <a href="/archives/">
        
        <span class="site-item-stat-count">14</span>
        <span class="site-item-stat-name language" data-lan="article">æ–‡ç« </span>
      </a>
    </div>
    <div class="sidebar-item-box">
      <a href="">
        <span class="site-item-stat-count">10</span>
        <span class="site-item-stat-name language" data-lan="category">åˆ†ç±»</span>
      </a>
    </div>
    <div class="sidebar-item-box">
      <a href="/tags/">
        <span class="site-item-stat-count">10</span>
        <span class="site-item-stat-name language" data-lan="tag">æ ‡ç­¾</span>
      </a>
    </div>
  </div>
  
    
      <div class="sidebar-item">
        <span class="site-item-rss">
            <i class="fa fa-rss"></i>
            <a href="https://zhangyaoo.github.io/atom.xml" target="_blank">RSS</a>
        </span>
      </div>
    
  
  



</div>
          
        
      </div>
    </div>
  
</div>
<script>
  const SIDEBAR_TITLE_ACTIVE = 'sidebar-title-active';
  const SIDEBAR_BODY_ACTIVE = 'sidebar-body-active';
  const SLIDE_UP_IN = 'slide-up-in';

  let sidebar = document.querySelector('#sidebar'),
  tocSideBar = document.querySelector('#tocSideBar'),
  metaSideBar = document.querySelector('#metaSideBar'),
  postToc = document.querySelector('#post_toc'),
  postSiteMeta = document.querySelector('#post_side_meta'),
  sidebarTitle = document.querySelector('.sidebar-title'),
  sidebarBody = document.querySelector('#sidebar_body');

  tocSideBar && tocSideBar.addEventListener('click', (e) => {
    toggleSidebar(e);
  });

  metaSideBar && metaSideBar.addEventListener('click', (e) => {
    toggleSidebar(e);
  });

  function toggleSidebar(e) {
    let currentTitle = document.querySelector("."+SIDEBAR_TITLE_ACTIVE);
    if (currentTitle == e.srcElement) {
      return ;
    }
    let current, showElement, hideElement;
    if (e.srcElement == metaSideBar) {
      showElement = postSiteMeta;
      hideElement = postToc;
    } else if (e.srcElement == tocSideBar){
      showElement = postToc;
      hideElement = postSiteMeta;
    }
    currentTitle.classList.remove(SIDEBAR_TITLE_ACTIVE);
    e.srcElement.classList.add(SIDEBAR_TITLE_ACTIVE);

    window.Velocity(hideElement, 'stop');
    window.Velocity(hideElement, 'transition.slideUpOut', {
      display: 'none',
      duration: 200,
      complete: function () {
        window.Velocity(showElement, 'transition.slideDownIn', {
          duration: 200
        });
      }
    })
    hideElement.classList.remove(SIDEBAR_BODY_ACTIVE);
    showElement.classList.add(SIDEBAR_BODY_ACTIVE);
  }

  postToc && postToc.addEventListener('transitionend', function() {
    this.classList.remove(SLIDE_UP_IN);
  });

  if (sidebarBody) {
    if (sidebarBody.classList.contains('pisces') || sidebarBody.classList.contains('gemini')) {
      let hasFix = false;
      let scrollEl = document.querySelector('.main-continer');
      let limitTop = document.querySelector('#nav_ul').children.length * 42 + 162;
      window.addEventListener('scroll', function(e) {
        if (document.scrollingElement.scrollTop >= limitTop) {
          if (!hasFix) {
            sidebar.classList.add('sidebar-fixed');
            hasFix = true;
          }
        } else {
          if (hasFix) {
            sidebar.classList.remove('sidebar-fixed');
            hasFix = false;
          }
        }
      });
    }
  }
  
</script>
        <div class="section-box box-shadow-wrapper">
          <div class="section bg-color post post-page">
            <header class="post-header">
  <h1 class="post-title">
    <a class="post-title-link" href="https://zhangyaoo.github.io/post/2019-nian-zong-jie/">
      2019å¹´æ€»ç»“
    </a>
  </h1>
  <div class="post-meta">
    
    <span class="meta-item pc-show">
      <i class="fa fa-calendar-o"></i>
      <span class="language" data-lan="publish">å‘å¸ƒäº</span>
      <span>2020-01-01</span>
      <span class="post-meta-divider pc-show">|</span>
    </span>
    
    <span class="meta-item">
      <i class="fa fa-folder-o"></i>
      <span class="pc-show language" data-lan="category-in">åˆ†ç±»äº</span>
      
      
      <a href="https://zhangyaoo.github.io/tag/hD1pMQ2Ri/">
        <span>æ€»ç»“</span>
      </a>
      
      
    </span>
    <span class="post-meta-divider">|</span>
    
    <span class="meta-item">
      <i class="fa fa-clock-o"></i>
      <span>6<span class="language" data-lan="minute">åˆ†é’Ÿ</span></span>
    </span>
    <span class="meta-item">
      <span class="post-meta-divider">|</span>
      <i class="fa fa-file-word-o"></i>
      <span>1758<span class="pc-show language" data-lan="words">å­—æ•°</span></span>
    </span>
    
  </div>
</header>
            <div class="post-body next-md-body" id="post_body">
              <p>å°æç¤ºï¼šé˜…è¯»æ­¤ç¯‡æ–‡ç« å¤§çº¦éœ€è¦ä¸‰åˆ†é’Ÿæ—¶é—´ï¼Œä»¥ä¸‹éƒ½æ˜¯ä¸ªäººä¸€äº›ç”Ÿæ´»å·¥ä½œä¸Šç¢ç¢å¿µå¿µï¼Œå” å¨ç¢è¯­ï¼Œè¯·æ–Ÿé…Œé˜…è¯»~</p>
<p>ç›®å½•<br>
å¼€å¤´<br>
å­¦ä¹ <br>
å·¥ä½œ<br>
è¿åŠ¨<br>
ç”Ÿæ´»<br>
æ¸¸æˆ<br>
ç¾é£Ÿ<br>
äº²æƒ…<br>
çˆ±æƒ…<br>
2020flag</p>
<p>â€”â€”â€”â€”â€”â€”â€”â€”æˆ‘æ˜¯åˆ†å‰²çº¿â€”â€”â€”â€”â€”â€”</p>
<p>å¼€å¤´<br>
åˆè¿‡äº†ä¸€å¹´ï¼Œè®°å¾—ä¸Šä¸€æ¬¡å†™å¹´ç»ˆæ€»ç»“è¿˜æ˜¯åœ¨æˆ‘ç‹—çª(å‡ºç§Ÿæˆ¿)é‡Œé¢å†™çš„ï¼Œè¿™ä¸€æ¬¡æ˜¯åœ¨å—äº¬å—ç«™å¼€å§‹å†™çš„ã€‚<br>
æ·±åœ³çš„å¤©æ°”å°±æ˜¯è¿™ä¹ˆç¥å¥‡ï¼Œä¸€å¹´åˆ°å¤´ç©¿çŸ­è¢–ï¼Œæ›¾å’Œæˆ‘æœ‹å‹ç«‹ä¸‹ä¸€ä¸ªflagï¼Œè¯´åœ¨æ·±åœ³365å¤©300å¤©ç©¿çŸ­è¢–ï¼Œä¸ç„¶å°±æ´—ä¸€ä¸ªæœˆç¢—ï¼Œä¼¼ä¹ä»Šå¹´æ¸©åº¦é™çš„æ—©ï¼Œæ—©æ—©å°±ç©¿ä¸Šäº†çŸ­è¢–ï¼Œ(flagæœç„¶å¯¹äºæˆ‘æ¥è¯´å°±æ˜¯æ‰“è„¸çš„)ï¼Œæ‰€ä»¥æ˜å¹´æ¥å°±ç»™è‡ªå·±è£…é€¼è¡Œä¸ºä»˜å‡ºä»£ä»·ï¼ˆâ•¯' - ')â•¯ï¸µ â”»â”â”»<br>
è¿™é‡Œä¸€ç›´éƒ½æ˜¯å¤å¤©ï¼Œä¸èƒ½åƒå®¶ä¹¡ä¸€æ ·èƒ½æ„Ÿå—åˆ°å››å­£çš„å˜åŒ–ï¼Œæ„Ÿè§‰æ—¶é—´è¿‡çš„ç‰¹åˆ«å¿«ï¼Œæœ‰ä¸€æ¬¡åœ¨å…¬å¸æ•²ä»£ç æ—¶å€™ï¼Œå¬åˆ°äº†é¸Ÿé¸£å£°ï¼Œç¬é—´å°±æƒ³èµ·äº†å®¶ä¹¡ç”°é‡ä¸­çš„é¸Ÿå«è™«é¸£ï¼Œè„‘æµ·é‡Œå°±æµ®ç°äº†é‚£å¹´å¤å¤©ï¼Œåƒç€å†°æ£ï¼Œå¬ç€è‰é¸£çš„æ—§æ—¶å…‰ã€‚<br>
è¿™ä¸€å¹´æœ‰è®¸å¤šå€¼å¾—å†™çš„ä¸œè¥¿ï¼Œç”Ÿæ´»ä¸­çš„å„ä¸ªæ–¹é¢éƒ½æœ‰ã€‚ç”¨æˆ‘è€çˆ¹ä¸€å¥è¯ï¼Œä¸€å¹´æ—¶é—´ä¸ç®¡æ˜¯è¿›æ­¥å¤šå°‘ï¼Œåªè¦ä¸æ˜¯åŸåœ°è¸æ­¥èµ°å°±å¯ä»¥ã€‚è¿™æ¬¡è¿˜æ˜¯åƒ2018å¹´æ€»ç»“ä¸€æ ·ç»™è‡ªå„åšä¸€äº›æ€»ç»“å’Œä¸€äº›ï¼ˆç»™è‡ªå·±æ‰“è„¸çš„ï¼‰flag</p>
<p>å­¦ä¹ <br>
è¯´èµ·å­¦ä¹ ï¼Œè¿™é‡Œæ”¾åœ¨æœ€å¼€å§‹å†™ï¼Œè‡ªè®¤ä¸ºå­¦ä¹ æ˜¯è‡ªå·±æå‡è‡ªå·±çš„æœ€ç›´æ¥æœ€æœ‰æ•ˆçš„æ–¹å¼ã€‚ä»å°å­¦åˆ°é«˜ä¸­ä»¥è‡³äºå¤§å­¦çš„çŸ¥è¯†ï¼Œéƒ½æ˜¯çš®æ¯›ã€‚é‡è¦æ˜¯åŸ¹å…»äº†å¿«é€Ÿå­¦ä¹ èƒ½åŠ›å’Œè‡ªå­¦çš„ä¹ æƒ¯ï¼Œè¿™ä¸ªå¯ä»¥è¯´æ˜¯è‡ªå„å­¦ä¸šç”Ÿæ¶¯ä¸­è·å¾—æœ€æœ‰ä»·å€¼çš„ä¸œè¥¿äº†ã€‚ä½†æ˜¯è¿™æ˜¯ä¸å¤Ÿçš„ï¼Œå¯¹äºç”Ÿæ´»ä¸­è®¤çŸ¥å’Œå·¥ä½œçš„æ–¹é¢ï¼Œè‡ªæˆ‘ç‹¬ç«‹æ€è€ƒä¹Ÿæ˜¯å¿…ä¸å¯å°‘çš„ã€‚è‡ªå„ä¹Ÿåœ¨ç‰¹æ„å»æ³¨é‡ï¼ŒåŸ¹å…»è‡ªå„çš„ç‹¬ç«‹æ€è€ƒçš„èƒ½åŠ›ã€‚<br>
åœ¨è¿™æ„Ÿè°¢äº‘æ™ºæƒ IPOæ‰€æœ‰åå°åŒå­¦ï¼Œä»¥åŠ@é™ˆç§¦åœ† åŒå­¦ï¼Œè®©è‡ªå·±è®¤è¯†åˆ°ç‹¬ç«‹æ€è€ƒå’Œå›¢é˜Ÿåˆä½œçš„é‡è¦æ€§ã€‚</p>
<p>è¿™ä¸€å¹´æœ‰å­¦ä¹ åˆ°ä¸œè¥¿æœ‰ï¼š<br>
æå®¢æ—¶é—´çš„æ•°æ®ç»“æ„å’Œç®—æ³•ä¹‹ç¾<br>
è®¾è®¡æ¨¡å¼ä¹‹ç¾(åªçœ‹äº†ä¸€ç« )<br>
ç‰›å®¢ç½‘çš„å‰‘æŒ‡offer(åªåˆ·äº†30é“)<br>
åŠ›æ‰£leetcode(åªåˆ·äº†60é“)<br>
ã€Šnettyå®æˆ˜ã€‹<br>
æ­å»ºå¼€æºé¡¹ç›®fast-imè„šæ‰‹æ¶<br>
é‡‘èä¸šåŠ¡çŸ¥è¯†<br>
æ²ˆå‰‘çš„æ¶æ„å¸ˆä¹‹è·¯ï¼ˆåªçœ‹äº†äºŒåç¯‡ï¼‰</p>
<p>æ¥å¹´ç›®æ ‡ï¼š<br>
ç»§ç»­å®Œæˆå¼€æºé¡¹ç›®<br>
ç»è¥å¥½ä¸ªäººåšå®¢<br>
æ¶æ„å¸ˆä¹‹è·¯å­¦ä¹ <br>
ã€Šredisè¿›é˜¶ã€‹<br>
ã€Šå‰‘æŒ‡offerã€‹<br>
å¤§æ•°æ®ç›¸å…³çŸ¥è¯†</p>
<p>çœ‹äº†å…¶ä»–ä¹¦ç±ï¼š<br>
ã€Šäº®å‰‘ã€‹<br>
ã€Šå¯»è·¯ä¸­å›½ã€‹</p>
<p>ç”»å¤–éŸ³ï¼šä¸€å¹´æ—¶é—´å­¦çš„è¿™ä¹ˆå°‘ï¼Œè¿˜è´´å‡ºæ¥ï¼ˆè„¸çš®æœ‰ç‚¹åšğŸ˜‚ï¼Œæ‰‹åŠ¨ç‹—å¤´ï¼‰</p>
<p>å·¥ä½œ<br>
åœ¨äº‘æ™ºæƒ çš„ä¸€å¹´åŠæ—¶é—´é‡Œï¼Œè‡ªå„å­¦ä¹ äº†è®¸å¤šå’Œå·¥ä½œç›¸å…³çš„çŸ¥è¯†ï¼Œè®¤è¯†äº†è®¸å¤šä¼˜ç§€çš„åŒå­¦ï¼Œæˆé•¿äº†å¹¶ä¸”æ”¶è·äº†è®¸å¤šï¼Œæ„Ÿè°¢äº‘æ™ºæƒ æä¾›çš„èŒåœºå¹³å°ã€‚è™½ç„¶ç°åœ¨å·²ç»å¿«è¦è§£æ•£äº†ï¼Œä½†æ˜¯è¿˜æ˜¯è¡¨ç¤ºè¡·å¿ƒæ„Ÿè°¢ã€‚æ±Ÿæ¹–å†è§ï¼</p>
<p>è¿åŠ¨<br>
å”¯ä¸€ä¸€ä¸ªåœ¨2019å¹´ç«‹å¾—æ²¡æœ‰è¢«æ‰“è„¸çš„flagï¼Œå°±æ˜¯è¿åŠ¨ã€‚æ¯å‘¨ä¸€æ¬¡ç¯®çƒæˆ–è€…è·‘æ­¥ã€‚<br>
è·‘æ­¥å‘¢ï¼Œä¸€èˆ¬è·‘ä¸ª4å…¬é‡Œä¸€æ¬¡ã€‚å¤§æ¦‚è·‘äº†äºŒåæ¬¡ï¼Œ100å…¬é‡Œå·¦å³ï¼Œè¿™é‡Œåªè®°å½•äº†ä¸€åŠï¼Œå¦å¤–ä¸€åŠæ²¡æœ‰è®°å½•ï¼ˆè¿™å¥æ˜¯çœŸçš„ï¼‰ã€Œå“­ç¬‘:-Dã€</p>
<p>ç¯®çƒå‘¢ï¼Œç°åœ¨æŠ•ç¯®ä¸å‡†ï¼Œè¿çƒè¾£çœ¼ç›ï¼Œå·²ç„¶ä¸€å‰¯è€å¹´ç¯®çƒçš„æ ·å­ã€‚ä½†æ˜¯è¿˜æ˜¯é˜»æŒ¡ä¸äº†æˆ‘å–œæ¬¢è¿™ä¸€é¡¹è¿åŠ¨ï¼Œå°±åƒçŒç¯®é«˜æ‰‹åŠ¨æ¼«ä¸­ä¸€å¥è¯â€œæ•™ç»ƒï¼Œæˆ‘æƒ³æ‰“ç¯®çƒâ€è¿™æ ·ï¼Œæºè‡ªäºå†…å¿ƒçš„çƒ­çˆ±ã€‚</p>
<p>ç”Ÿæ´»<br>
è¿™ä¸€å¹´æˆ‘æƒ³äº†å¾ˆä¹…ï¼Œå¾—åˆ°äº†ä»€ä¹ˆå¤±å»äº†ä»€ä¹ˆã€‚ã€‚æˆ‘æƒ³äº†å¾ˆä¹…ï¼Œçªç„¶æƒ³èµ·æ¥ï¼Œ<br>
å¾—åˆ°çš„å½“ç„¶æ˜¯è‚šå­çš„è‚¥è‚‰èµ˜è‚‰å’¯ï¼Œï¼Œå¤±å»çš„ä½ ä»¬ä¹ŸçŸ¥é“ï¼Œè‚¯å®šæ˜¯æˆ‘ç¨€è–„çš„å¤´å‘ã€‚ã€‚</p>
<p>å½“è‡ªå„å‘é™…çº¿è¶Šæ¥è¶Šé«˜çš„æ—¶å€™ï¼Œå°±åœ¨æ€è€ƒäººç”Ÿï¼Œä¸ºä»€ä¹ˆé•¿å¾—è¿™ä¹ˆå¸…ï¼Œåˆ°è¦æ‰å¤´å‘</p>
<p>ä»æ­¤èŠèŠ±èŒ¶â•æ¸æå·²æ˜¯æ ‡é…ï¼Œæ—©ç¡æ—©èµ·å·²æ˜¯äººç”Ÿç®´è¨€ğŸ˜‚ï¼Œç‹—å‘½è¦ç´§</p>
<p>æ¸¸æˆ<br>
å¹³å¸¸é¸­æ¢¨å¤§æ—¶å€™å¶å°”æ‰“æ‰“æ¸¸æˆæ”¾æ¾æ”¾æ¾ï¼Œ<br>
ä»Šå¹´å‡­å€Ÿè‡ªå·±çš„å¤©èµ‹(è£…ä¸€ä¸‹B)å’Œä¸æ‡ˆåŠªåŠ›ï¼Œæ‰“åˆ°ç™½é‡‘ä¸€ã€‚ç¦»è‡ªå·±çš„å°ç›®æ ‡åˆè¿‘äº†ä¸€æ­¥ï¼Œäº‰å–ä»Šå¹´ä¸Šç –çŸ³ï¼Œè®©æˆ‘å½“ä¸ªç –çŸ³å®ˆé—¨å‘˜ä¹Ÿè¡ŒğŸ¤ã€‚</p>
<p>åœ¨è¿™å†™ä¸Šæœ€å–œæ¬¢è‹±é›„çš‡å­çš„å°è¯ï¼šâ€œæ‰€åˆ°ä¹‹å¤„ï¼Œæ— äººèƒ½æŒ¡ï¼â€</p>
<p>ç¾é£Ÿ</p>
<p>ä»€ä¹ˆæœ€é‡è¦ï¼Œå½“ç„¶æ˜¯åƒã€‚<br>
æƒ³æƒ³è¿™ä¸€å¹´åšçš„ç¾é£Ÿï¼Œå’ŒåŒå­¦ä¸€èµ·åšçš„ï¼Œæ­¤å¤„@è‚‰å’Œæ¨ä¸½ä¸½ï¼Œæ„Ÿè°¢ä¸€èµ·ç›¸å¤„ä¸€å¹´ï¼Œå­¦åˆ°äº†å¾ˆå¤šç¾é£Ÿæ˜¯å¦‚ä½•åšçš„ï¼Œæˆ‘èº«è¾¹çš„éšè—å¤§å¨ğŸ˜‚ã€‚<br>
ä»Šå¹´å­¦åˆ°äº†æœ‰çº¢çƒ§é²«é±¼ï¼Œç³–é†‹æ’éª¨ï¼Œè‘±èŠ±é¥¼ï¼Œå¯ä¹é¸¡ç¿…ï¼Œçº¢çƒ§è‚‰ï¼Œè‡ªåˆ¶å‡‰èœï¼Œæ°´ç…®è‚‰ç‰‡ï¼Œè‡ªåˆ¶çƒ¤é±¼ï¼Œå›é”…è‚‰ç­‰ç­‰ç­‰ç­‰ï¼Œå°±æ”¾ä¸€å¼ å’ŒåŒå­¦ä¸€èµ·åšé¥ºå­çš„å›¾ç‰‡ï¼Œä¸å¤šæ”¾äº†ï¼Œå…å¾—æ™šä¸Šä¸­æ¯’å¤ªæ·±ã€‚ã€‚ã€‚</p>
<p>ç”»å¤–éŸ³ï¼šä¸Šé¢é¥ºå­ï¼ˆçœ‹èµ·æ¥åƒï¼‰çœŸçš„ä¸æ˜¯æˆ‘åŒ…çš„</p>
<p>äº²æƒ…<br>
ç‰¹åˆ«å–œæ¬¢ã€Šè¯·å›ç­”1988ã€‹é‡Œé¢å®¶åº­äº²æƒ…ï¼Œæ•´éƒ¨ç‰‡è™½ç„¶ä¸ä¹çˆ±æƒ…å‹æƒ…ç­‰ï¼Œä½†æ˜¯æˆ‘è§‰å¾—æ ¸å¿ƒæ˜¯äº²æƒ…ï¼Œæœ€æœ‰å°è±¡è¿˜æ˜¯å®æ‹‰å¦ˆå¦ˆä¸‹é›¨å¤©æŠ¤ç€å®æ‹‰é‚£æ®µã€‚&quot;äººçœŸæ­£å˜å¼ºå¤§ï¼Œä¸æ˜¯å› ä¸ºå®ˆæŠ¤ç€è‡ªå°Šå¿ƒï¼Œè€Œæ˜¯æŠ›å¼€è‡ªå°Šå¿ƒçš„æ—¶å€™ï¼Œå› ä¸ºæœ‰éœ€è¦å®ˆæŠ¤çš„äºº&quot;<br>
è¿™å¥è¯è¿˜æ˜¯éœ€è¦è‡ªå·±å»ç»å†ä½“ä¼šçš„ã€‚<br>
ä»¥å‰è§‰å¾—ï¼Œå‡ºçœä¸Šå­¦ï¼Œå‡ºçœå·¥ä½œï¼Œå¯ä»¥ç¦»å®¶äººè¿œä¸€ç‚¹ï¼Œå°±åƒæ˜¯æ˜¥å¤©çš„ç‡•å­ï¼Œé•¿å¤§äº†éƒ½æƒ³çœ‹çœ‹å¤–é¢çš„ä¸–ç•Œï¼Œå»é—¯è¡å»ç»å†ï¼Œå»ä¸°å¯Œè‡ªå·±çš„ç”Ÿæ´»å¢é•¿è‡ªå·±è§è¯†ã€‚å¯åˆ°äº†ä¸€å®šçš„å¹´é¾„æˆ–è€…è®¤çŸ¥ï¼Œä¼šæ„è¯†åˆ°ï¼Œæœ‰å®¶äººåœ¨çš„åœ°æ–¹ï¼Œéƒ½è§‰å¾—å¾ˆçŸ¥è¶³ã€‚ç‰¹åˆ«å–œæ¬¢ã€Šå››ä¸ªæ˜¥å¤©ã€‹çºªå½•ç‰‡é‡Œé¢ç‡•å­å½’æ¥ä¹‹æ—¶ï¼Œé‚£ç§æ„Ÿè§‰ï¼Œçºªå½•ç‰‡ä¸­çˆ¶æ¯çœ‹åˆ°ç‡•å­å½’æ¥ï¼Œå¿ƒé‡Œå¿µå¨ç€ï¼Œå’±å®¶å°ç‡•å­ä¹Ÿè¯¥å›å®¶äº†ã€‚</p>
<p>çˆ±æƒ…<br>
æ„Ÿè°¢å…šæ„Ÿè°¢å›½å®¶ç»™æˆ‘å‘äº†ä¸€ä¸ªå¥³æœ‹å‹ï¼Œå…è´¹æ»´ã€‚&lt;( Ë˜ Â³Ë˜)/ğŸ’¯<br>
ä»Šå¹´æœ€å¤§æ”¶è´§ï¼Œå½“ç„¶æ˜¯é‡åˆ°æ–¹å°çš®åŒå­¦å•¦ï¼Œï¼ˆé»˜é»˜æ’’ä¸€ä¸‹æ–°é²œç‹—ç²®ï¼‰å¸Œæœ›åœ¨ä»¥åçš„æ—¥å­é‡Œï¼Œä½ èƒ½å¤Ÿæ—©ç¡æ—©èµ·ï¼Œåƒå¥½å–å¥½ï¼Œèº«ä½“æ£’æ£’ã€‚</p>
<p>æœ€åè‚¯å®šæ˜¯å†™ä¸€äº›æ‰“è„¸çš„ä¸œè¥¿ã€‚ã€‚<br>
2020å¹´flag<br>
è‡ªä¿¡<br>
ä¸€å‘¨ä¸€æ¬¡è·‘æ­¥æˆ–è€…ç¯®çƒ<br>
çœ‹å®Œå‰©ä½™ä¹¦ç±<br>
ç»è¥å¥½ä¸ªäººåšå®¢<br>
æ´—è„šåŸæ´—ä¸€æ¬¡è„š(æœ‰ä»€ä¹ˆä¸œè¥¿æ¸—å…¥è¿›æ¥äº†)<br>
ä½“é‡ä¸è¶…130<br>
æ—©ç¡æ—©èµ·ï¼Œ11ç‚¹ä¹‹å‰ç¡ï¼ˆè™½ç„¶æ˜¯ä¸å¯èƒ½çš„ï¼‰<br>
å­¦ä¹ å¤§æ•°æ®ç›¸å…³çŸ¥è¯†<br>
ä¿æŠ¤çœ¼ç›</p>
<p>ä»¥ä¸Šï¼Œå®Œ</p>
<p><img src="https://zhangyaoo.github.io/post-images/1593268924481.jpg" alt="" loading="lazy"><br>
æœ€åè´´ä¸Šè‡ªå„æœ€å–œæ¬¢çš„ç…§ç‰‡ï¼Œ2015å¹´äºè¥¿è—æ‹</p>

            </div>
            
            
              <div class="post-footer">
  <ul class="post-copyright">
    <li class="post-copyright-author">
      <strong class="language" data-lan="author">æœ¬æ–‡ä½œè€…ï¼š</strong>
      will
    </li>
    <li class="post-copyright-link">
      <strong class="language" data-lan="link">æœ¬æ–‡é“¾æ¥ï¼š</strong>
      <a href="https://zhangyaoo.github.io/post/2019-nian-zong-jie/" title="2019å¹´æ€»ç»“">https://zhangyaoo.github.io/post/2019-nian-zong-jie/</a>
    </li>
    <li class="post-copyright-license">
      <strong class="language" data-lan="copyright">ç‰ˆæƒå£°æ˜ï¼š </strong>
      æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i> BY-NC-SA</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
    </li>
  </ul>
  <div class="tags">
    
      <a href="https://zhangyaoo.github.io/tag/hD1pMQ2Ri/"># æ€»ç»“</a>
    
  </div>
  <div class="nav">
    <div class="nav-prev">
      
        <i class="fa fa-chevron-left"></i>
        <a class="nav-pc-next" title="O(1)æ—¶é—´å¤æ‚åº¦ä¸‹ï¼ŒåŒå‘é“¾è¡¨å®ç°LRU" href="https://zhangyaoo.github.io/post/o1shi-jian-fu-za-du-xia-shuang-xiang-lian-biao-shi-xian-lru/">O(1)æ—¶é—´å¤æ‚åº¦ä¸‹ï¼ŒåŒå‘é“¾è¡¨å®ç°LRU</a class="nav-pc-next">
        <a class="nav-mobile-prev" title="O(1)æ—¶é—´å¤æ‚åº¦ä¸‹ï¼ŒåŒå‘é“¾è¡¨å®ç°LRU" href="https://zhangyaoo.github.io/post/o1shi-jian-fu-za-du-xia-shuang-xiang-lian-biao-shi-xian-lru/">ä¸Šä¸€ç¯‡</a>
      
    </div>
    <div class="nav-next">
      
        <a class="nav-pc-next" title="å…³äº" href="https://zhangyaoo.github.io/post/about/">å…³äº</a>
        <a class="nav-mobile-next" title="å…³äº" href="https://zhangyaoo.github.io/post/about/">ä¸‹ä¸€ç¯‡</a>
        <i class="fa fa-chevron-right"></i>
      
    </div>
  </div>
</div>
            
            
  

          </div>
        </div>
      </div>
    </div>
    <div class="footer-box">
  <footer class="footer">
    <div class="copyright">
      Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | Â© 2019-2020 Theme By <a
        href="https://github.com/hsxyhao/gridea-theme-next" target="_blank">HsxyHao</a>
    </div>
    <div class="poweredby">
      <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <span id="busuanzi_container_site_pv">æœ¬ç«™æ€»è®¿é—®é‡<span id="busuanzi_value_site_pv"></span>æ¬¡</span>
    </div>
  </footer>
  
  
  <div class="pisces back-to-top" id="back_to_top">
    <i class="fa fa-arrow-up"></i>
    
    <span class="scrollpercent">
      <span id="back_to_top_text">0</span>%
    </span>
    
  </div>
  
  
  
</div>
<script>

  let sideBarOpen = 'sidebar-open';
  let body = document.body;
  let back2Top = document.querySelector('#back_to_top'),
    back2TopText = document.querySelector('#back_to_top_text'),
    drawerBox = document.querySelector('#drawer_box'),
    rightSideBar = document.querySelector('.sidebar'),
    viewport = document.querySelector('body');

  function scrollAnimation(currentY, targetY) {

    let needScrollTop = targetY - currentY
    let _currentY = currentY
    setTimeout(() => {
      const dist = Math.ceil(needScrollTop / 10)
      _currentY += dist
      window.scrollTo(_currentY, currentY)
      if (needScrollTop > 10 || needScrollTop < -10) {
        scrollAnimation(_currentY, targetY)
      } else {
        window.scrollTo(_currentY, targetY)
      }
    }, 1)
  }

  back2Top.addEventListener("click", function (e) {
    scrollAnimation(document.scrollingElement.scrollTop, 0);
    e.stopPropagation();
    return false;
  });

  window.addEventListener('scroll', function (e) {
    let percent = document.scrollingElement.scrollTop / (document.scrollingElement.scrollHeight - document.scrollingElement.clientHeight) * 100;
    if (percent > 1 && !back2Top.classList.contains('back-top-active')) {
      back2Top.classList.add('back-top-active');
    }
    if (percent == 0) {
      back2Top.classList.remove('back-top-active');
    }
    if (back2TopText) {
      back2TopText.textContent = Math.floor(percent);
    }
  });


  let hasCacu = false;
  window.onresize = function () {
    calcuHeight();
  }

  function calcuHeight() {
    // åŠ¨æ€è°ƒæ•´ç«™ç‚¹æ¦‚è§ˆé«˜åº¦
    if (!hasCacu && back2Top.classList.contains('pisces') || back2Top.classList.contains('gemini')) {
      let sideBar = document.querySelector('.sidebar');
      let navUl = document.querySelector('#site_nav');
      sideBar.style = 'margin-top:' + (navUl.offsetHeight + navUl.offsetTop + 15) + 'px;';
      hasCacu = true;
    }
  }
  calcuHeight();

  let open = false, MOTION_TIME = 300, RIGHT_MOVE_DIS = '320px';

  if (drawerBox) {
    let rightMotions = document.querySelectorAll('.right-motion');
    let right = drawerBox.classList.contains('right');

    let transitionDir = right ? "transition.slideRightIn" : "transition.slideLeftIn";

    let openProp, closeProp;
    if (right) {
      openProp = {
        paddingRight: RIGHT_MOVE_DIS
      };
      closeProp = {
        paddingRight: '0px'
      };
    } else {
      openProp = {
        paddingLeft: RIGHT_MOVE_DIS
      };
      closeProp = {
        paddingLeft: '0px'
      };
    }

    drawerBox.onclick = function () {
      open = !open;
      window.Velocity(rightSideBar, 'stop');
      window.Velocity(viewport, 'stop');
      window.Velocity(rightMotions, 'stop');
      if (open) {
        window.Velocity(rightSideBar, {
          width: RIGHT_MOVE_DIS
        }, {
          duration: MOTION_TIME,
          begin: function () {
            window.Velocity(rightMotions, transitionDir, {});
          }
        })
        window.Velocity(viewport, openProp, {
          duration: MOTION_TIME
        });
      } else {
        window.Velocity(rightSideBar, {
          width: '0px'
        }, {
          duration: MOTION_TIME,
          begin: function () {
            window.Velocity(rightMotions, {
              opacity: 0
            });
          }
        })
        window.Velocity(viewport, closeProp, {
          duration: MOTION_TIME
        });
      }
      for (let i = 0; i < drawerBox.children.length; i++) {
        drawerBox.children[i].classList.toggle('muse-line');
      }
      drawerBox.classList.toggle(sideBarOpen);
    }
  }

  // é“¾æ¥è·³è½¬
  let newWindow = 'true'
  if (newWindow === 'true') {
    let links = document.querySelectorAll('.post-body a')
    links.forEach(item => {
      if (!item.classList.contains('btn')) {
        item.setAttribute("target", "_blank");
      }
    })
  }

  let faSearch = document.querySelector('#fa_search');
  faSearch.addEventListener('click', function () {
    document.querySelector('#search_mask').style = ''
  })

  // ä»£ç é«˜äº®
  hljs.initHighlightingOnLoad();
  
  // ç¦»å¼€å½“å‰é¡µtitleå˜åŒ–
  var leaveTitle = '';
  if (leaveTitle) {
    document.addEventListener('visibilitychange', function () {
      if (document.visibilityState == 'hidden') {
        normal_title = document.title;
        document.title = leaveTitle;
      } else {
        document.title = normal_title;
      }
    });
  }

</script>
    <div class="light-box" id="light_box"></div>
<script>
  let imgs = document.querySelectorAll('.post-body img');
  let lightBox = document.querySelector('#light_box');
  lightBox.addEventListener('mousedown', (e) => {
    e.preventDefault()
  })
  lightBox.addEventListener('mousewheel', (e) => {
    e.preventDefault()
  })
  let width = window.innerWidth * 0.8;
  lightBox.onclick = () => {
    let img = lightBox.querySelector('img');
    lightBox.style = '';
    img && img.remove();
  }
  imgs.forEach(item => {
    item.onclick = function (e) {
      let lightImg = document.createElement('img');
      lightImg.src = this.src;
      lightBox.style = `height: 100%; opacity: 1; background-color: rgba(0, 0, 0, 0.5);cursor: zoom-out;`;
      lightImg.style = `width: ${width}px; border: 1px solid #fff; border-radius: 2px;`;
      lightImg.onclick = function () {
        lightBox.style = '';
        this.remove();
      }
      lightBox.append(lightImg);
    }
  })
</script>
    <div class="reward-mask" style="display: none;">
  <div class="reward-relative">
    <span class="close" aria-hidden="true">x</span>
    <div class="reward-body">
      <h2>æ„Ÿè°¢æ‚¨çš„æ”¯æŒï¼Œæˆ‘ä¼šç»§ç»­åŠªåŠ›çš„!</h2>
      <div class="reward-img-box">
        <div style="position: relative; width: 140px; height: 140px;">
          
          
          
        </div>
      </div>
      <p class="reward-word">æ‰«ç æ‰“èµï¼Œä½ è¯´å¤šå°‘å°±å¤šå°‘</p>
      <p class="reward-tip">æ‰“å¼€å¾®ä¿¡æ‰«ä¸€æ‰«ï¼Œå³å¯è¿›è¡Œæ‰«ç æ‰“èµå“¦</p>
    </div>
    <div class="bottom">
      
      
    </div>
  </div>
</div>
<style>
  .reward-mask {
    position: fixed;
    z-index: 99999;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
    background-color: #00000054;
  }

  .reward-relative {
    position: relative;
    width: 480px;
    text-align: center;
    margin: 0 auto;
    border-radius: 5px;
    background-color: #fff;
    top: 50%;
    margin-top: -205px;
  }

  .reward-relative .close {
    position: absolute;
    right: 10px;
    font-weight: normal;
    font-size: 16px;
    color: #929292;
  }

  .reward-body {
    padding: 40px 20px 20px;
  }

  .bottom {
    display: flex;
  }

  .reward-btn {
    text-align: center;
  }

  .reward-btn-text {
    display: inline-block;
    cursor: pointer;
    width: 60px;
    height: 60px;
    line-height: 60px;
    border-radius: 50%;
    background-color: #ff9734;
    color: #FFF;
    margin-top: 20px;
  }

  .pay-text {
    margin-top: 10px;
    padding: 10px;
    flex: 1;
    transition: all .2s linear;
  }

  .pay-text:hover {
    background-color: #a5a5a536;
  }

  .reward-body h2 {
    padding-top: 10px;
    text-align: center;
    color: #a3a3a3;
    font-size: 16px;
    font-weight: normal;
    margin: 0 0 20px;
  }

  .reward-body h2:after,
  .reward-body h2:before {
    font-family: Arial, Helvetica, sans-serif;
    background: 0 0;
    width: 0;
    height: 0;
    font-style: normal;
    color: #eee;
    font-size: 80px;
    position: absolute;
    top: 20px;
  }

  .reward-body h2:before {
    content: '\201c';
    left: 50px;
  }

  .reward-body h2:after {
    content: '\201d';
    right: 80px;
  }

  .reward-img-box {
    display: inline-block;
    padding: 10px;
    border: 6px solid #ea5f00;
    margin: 0 auto;
    border-radius: 3px;
    position: relative;
  }

  .reward-img {
    position: absolute;
    left: 0px;
    top: 0px;
    width: 100%;
    height: 100%;
  }

  @media (max-width: 767px) {
    .reward-relative {
      height: 100%;
      top: 0px;
      margin-top: 0;
      width: auto;
    }

    .reward-relative .bottom {
      flex-direction: column;
    }

    .reward-relative .pay-text {
      width: 80%;
      margin: 5px auto;
      border: 1px solid silver;
      padding: 6px;
      border-radius: 4px;
    }

    .reward-body h2:after {
      right: 40px;
    }

    .reward-body h2:after,
    .reward-body h2:before {
      font-size: 60px;
    }

    .reward-body h2:before {
      left: 20px;
    }
  }
</style>
<script>
  !function () {
    var mask = document.querySelector('.reward-mask');
    let close = document.querySelector('.reward-relative .close');
    let rewardBtn = document.querySelector('.reward-btn');

    let zfb = document.querySelector('#zfb'),
      wx = document.querySelector('#wx'),
      zfbBtn = document.querySelector('#zfbBtn'),
      wxBtn = document.querySelector('#wxBtn');

    if (zfbBtn && wxBtn) {
      zfbBtn.addEventListener('click', () => {
        window.Velocity(zfb, 'transition.slideLeftIn', {
          duration: 400
        });
        window.Velocity(wx, 'transition.slideRightOut', {
          display: 'none',
          duration: 400
        });
      });

      wxBtn.addEventListener('click', () => {
        window.Velocity(wx, 'transition.slideRightIn', {
          duration: 400
        });
        window.Velocity(zfb, 'transition.slideLeftOut', {
          display: 'none',
          duration: 400
        });
      });
    }

    rewardBtn.addEventListener('click', (e) => {
      window.Velocity(mask, 'transition.slideDownIn', {
        duration: 400
      })
    });

    close.addEventListener('click', (e) => {
      e.preventDefault();
      window.Velocity(mask, 'transition.slideUpOut', {
        duration: 400
      })
    })
  }()
</script>

  </div>
</body>

  <div class="search-mask" id="search_mask" style="display: none;">
  <div class="search-box">
    <div class="search-title">
      <i class="fa fa-search"></i>
      <div class="input-box">
        <input id="search" type="text" class="language" data-lan="search" placeholder="æœç´¢">
      </div>
      <i id="close" class="fa fa-times-circle"></i>
    </div>
    <div class="stat-box">
      <span id="stat_count">0</span><span class="language" data-lan="stat">æ¡ç›¸å…³æ¡ç›®ï¼Œä½¿ç”¨äº†</span><span id="stat_times">0</span><span class="language" data-lan="stat-time">æ¯«ç§’</span>
      <hr>
    </div>
    <div class="result" id="result">
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://zhangyaoo.github.io/post/ji-yi-ci-duo-shu-ju-yuan-lu-you-zao-cheng-de-shu-ju-ku-lian-jie-nei-cun-xie-lu/"" data-c="
          &lt;h3 id=&#34;å‰è¨€&#34;&gt;å‰è¨€&lt;/h3&gt;
&lt;p&gt;ä¹‹å‰ä¸€ç¯‡æ–‡ç« è®²äº†è‡ªå·±å†™äº†ä¸€ä¸ªå¤šæ•°æ®æºè·¯ç”±ç»„ä»¶ç»™å…¬å¸å†…éƒ¨ä½¿ç”¨ï¼Œè¿›è¡Œå¿«é€Ÿè¿­ä»£ã€‚æ–‡ç« URLæ˜¯ &lt;a href=&#34;https://zhangyaoo.github.io/post/saas-xi-tong-duo-shu-ju-yuan-lu-you-you-ya-jie-jue-fang-an&#34;&gt;SaaSç³»ç»Ÿå¤šæ•°æ®æºè·¯ç”±ä¼˜é›…è§£å†³æ–¹æ¡ˆ&lt;/a&gt;&lt;br&gt;
éšç€æ—¶é—´æ¨ç§»ï¼ŒæŸä¸€å¤©è¿ç»´æ‰¾ä¸Šé—¨è¯´æ•°æ®åº“è¿æ¥æ‰“æ»¡ï¼Œå°±åˆšå¥½è¿™ä¸€å°æœºå™¨ä¸Šè£…äº†JavaæœåŠ¡å¯¼è‡´çš„ã€‚&lt;br&gt;
ä¸‹é¢æ–‡ç« å°±æ˜¯è®²çš„è¿™æ¬¡è¿æ¥æ³„éœ²å¯¼è‡´çš„æ•°æ®åº“hangä½é—®é¢˜ä»¥åŠåé¢çš„è§£å†³è¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ä¸€-æ¡ˆå‘å½“æ—¶çš„æƒ…å†µ&#34;&gt;ä¸€ã€æ¡ˆå‘å½“æ—¶çš„æƒ…å†µï¼š&lt;/h3&gt;
&lt;p&gt;çº¿ä¸ŠMySQL session é€æ¸å¢åŠ ï¼Œä¸æ´»è·ƒçš„çš„æ•°é‡é€æ¸å¢åŠ ï¼Œå¯¼è‡´çš„åæœï¼šå ç”¨é“¾æ¥ï¼Œå¯¼è‡´é“¾æ¥æ»¡äº†æ— æ³•åˆ†é…æ–°çš„è¿æ¥&lt;br&gt;
&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1612261925869.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;äºŒ-ç´§æ€¥å¤„ç†æ–¹å¼&#34;&gt;äºŒã€ç´§æ€¥å¤„ç†æ–¹å¼ï¼š&lt;/h3&gt;
&lt;p&gt;ç”¨è‡ªç ”çš„åº”ç”¨å±‚ç½‘å…³å°†æµé‡åˆ‡æ¢ä¸ºæ—§çš„ç‰ˆæœ¬ä¸­ï¼Œå¹¶ä¸”ä¸åœæœºåˆ‡æ¢ï¼Œç„¶åå°†å½“å‰çš„ç‰ˆæœ¬çš„æœåŠ¡åœè°ƒï¼Œç„¶åè§‚å¯Ÿé˜¿é‡Œäº‘çš„æ•°æ®åº“è¿æ¥æ•°é‡å˜å›æ­£å¸¸ã€‚&lt;/p&gt;
&lt;p&gt;ç›®å‰çº¿ä¸Šå­˜åœ¨å¤šä¸ªç‰ˆæœ¬å­˜åœ¨dockerï¼Œç„¶åç”¨K8séƒ¨ç½²ï¼Œå®ç°å¿«é€Ÿä¸åœæœºåˆ‡æ¢ä¸Šçº¿ã€‚&lt;br&gt;
è‡ªç ”ç½‘å…³è¿™ç¯‡æ–‡ç« æœ‰ä»‹ç»ï¼š &lt;a href=&#34;ying-yong-ceng-wang-guan-she-ji-yu-shi-xian&#34;&gt;åº”ç”¨å±‚ç½‘å…³è®¾è®¡å’Œå®ç°&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;ä¸‰-ç¬¬ä¸€æ¬¡æŸ¥æ‰¾é—®é¢˜å¹¶ä¸”è§£å†³çš„è¿‡ç¨‹&#34;&gt;ä¸‰ã€ç¬¬ä¸€æ¬¡æŸ¥æ‰¾é—®é¢˜å¹¶ä¸”è§£å†³çš„è¿‡ç¨‹ï¼š&lt;/h3&gt;
&lt;p&gt;1ã€å¼€å¯æœ¬åœ°æœåŠ¡ï¼Œè®©å®ƒé£ä¸€ä¼šï¼Œæˆ–è€…å¤šçº¿ç¨‹å¹¶ä¸”åˆ‡ç§Ÿæˆ·æŸ¥è¯¢æ•°æ®åº“ï¼Œdumpå†…å­˜å¿«ç…§è¿›è¡Œåˆ†æ&lt;br&gt;
&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1612253583270.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;2ã€ç„¶åæŸ¥çœ‹æœ¬åœ°æœåŠ¡ç›¸å…³æ•°æ®åº“è¿æ¥çš„å¯¹è±¡&lt;br&gt;
1ï¼‰åˆ†æsqlsession å¯¹è±¡ï¼Œå‘ç°sqlsessionå¯¹è±¡ä¸º0ï¼Œè€Œä¸”æ—¥å¿—ä¸­æœ‰æ‰“å°åŠæ—¶å…³é—­sqlsessionã€‚ç»“è®ºï¼šsqlsessionæ­£å¸¸ï¼Œè¯´æ˜æ­£å¸¸å…³é—­äº†sqlsession&lt;br&gt;
&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1612237357285.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
2ï¼‰åˆ†ædatasource å¯¹è±¡ï¼Œå‘ç°datasourceå¯¹è±¡å’Œæ•°æ®åº“è¿æ¥é…ç½®ä¸­çš„max-pool-sizeä¸€è‡´ã€‚ç»“è®ºï¼šdatasourceæ­£å¸¸ï¼Œè¯´æ˜æ­£å¸¸å…³é—­äº†datasource&lt;br&gt;
&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1612237380060.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
3ï¼‰åˆ†æconnectionå¯¹è±¡ï¼Œå‘ç°HikariProxyConnectionå¯¹è±¡å’Œæ•°æ®åº“é…ç½®ä¸€è‡´ã€‚ç»“è®ºï¼šHikariProxyConnectionæ­£å¸¸&lt;br&gt;
&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1612237411657.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;3ã€åœ¨åˆ†ææœ¬åœ°å†…å­˜å¿«ç…§ï¼Œå‘ç°ä¸€ä¸ªç±»éšç€æ—¶é—´çš„æ¨ç§»ï¼Œé€æ¸å¢å¤šï¼Œå¹¶ä¸”æ²¡æœ‰è¢«å›æ”¶ï¼Œæ­£æ˜¯connectionImplå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡æ˜¯MySQLåº•å±‚è¿æ¥çš„å®ç°ï¼Œæ¥è‡ªcom.mysql.cj.jdbc&lt;br&gt;
&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1612237433473.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ï¼ˆå›¾ç‰‡ä¸­æŒ‡çš„ç±»æœ‰100å¤šä¸ªå¯¹è±¡ï¼‰&lt;/p&gt;
&lt;p&gt;4ã€è·Ÿè¸ªäº†ä¸€æ³¢æºç ï¼Œå‘ç°HikariProxyConnectionå¯¹è±¡ï¼Œå®è´¨ä¸Šåº•å±‚å°±æ˜¯newäº†ä¸€ä¸ªå¹¶ç®¡ç†connectionImplå¯¹è±¡ï¼ŒçŒœæµ‹æŸä¸ªå› ä¸ºå‚æ•°åŸå› å¯¼è‡´HikariProxyConnectionåŠæ—¶é‡Šæ”¾ï¼Œè€ŒconnectionImplæ²¡æœ‰é‡Šæ”¾ï¼Œç§¯ç´¯æ²¡æœ‰åŠæ—¶æ¸…é™¤å¯¼è‡´çš„ã€‚&lt;/p&gt;
&lt;p&gt;5ã€ç»è¿‡GoogleæŸ¥æ‰¾é—®é¢˜ï¼Œæ€€ç–‘æ˜¯max_lifetimeå¯¼è‡´çš„é—®é¢˜ã€‚max_lifetimeå®˜ç½‘è§£é‡Šï¼šä¸€ä¸ªè¿æ¥çš„ç”Ÿå‘½æ—¶é•¿ï¼ˆæ¯«ç§’ï¼‰ï¼Œè¶…æ—¶è€Œä¸”æ²¡è¢«ä½¿ç”¨åˆ™è¢«é‡Šæ”¾ï¼ˆretiredï¼‰ã€‚å»ºè®®æ¯”æ•°æ®åº“çš„wait_timeoutå°å‡ åˆ†é’Ÿã€‚é»˜è®¤30åˆ†é’Ÿ&lt;br&gt;
&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1612237640791.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;6ã€æŸ¥çœ‹çº¿ä¸Šé…ç½®å’Œæµ‹è¯•ç¯å¢ƒé…ç½®ï¼Œæœç„¶æ˜¯åªé…ç½®äº†1åˆ†é’Ÿã€‚&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1612262047685.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
éšåå°†å…¶æ”¹æˆ30åˆ†é’Ÿï¼Œç„¶åç»§ç»­å¤šçº¿ç¨‹å¹¶å‘è·‘æµ‹è¯•ç”¨ä¾‹ã€‚æµ‹è¯•ç¯å¢ƒéªŒè¯ï¼Œdumpå†…å­˜ï¼Œè§‚å¯ŸconnectionImplå¯¹è±¡å¹¶æ²¡æœ‰éšç€æ—¶é—´çš„æ¨ç§»å¢åŠ ã€‚å‘ç°connectionImplå¯¹è±¡å¹¶æ²¡æœ‰éšç€æ—¶é—´çš„æ¨ç§»å¢åŠ ã€‚éªŒè¯äº†ä¸ªäººçš„çŒœæƒ³ã€‚&lt;br&gt;
&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1612237699007.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;7ã€æœ€ç»ˆå°†é…ç½®æ›´æ–°åä¸Šçº¿ï¼Œè¿‡äº†æ²¡2ä¸ªå°æ—¶ï¼Œè¿æ¥æ•°åˆé£™å‡ã€‚åˆæ­¥è§‚å¯Ÿè¿˜æ˜¯connectionImplå¯¹è±¡å¢å¤šï¼Œè¿æ¥æ²¡æœ‰é‡Šæ”¾ã€‚æ‰€ä»¥è®¤ä¸ºï¼Œä¸æ˜¯max_lifetimeé…ç½®çš„é—®é¢˜ã€‚è¿˜æ˜¯å¾—ä»æºç ä¸­å…¥æ‰‹å’Œçº¿ä¸Šçš„dumpå…¥æ‰‹çœ‹ã€‚&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸€æ¬¡æŸ¥æ‰¾é—®é¢˜å¹¶&lt;strong&gt;æ²¡æœ‰è§£å†³æ ¹æœ¬é—®é¢˜&lt;/strong&gt;ï¼Œå¯¹æ­¤æ€»ç»“äº†ä¸€ä¸‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;è‡ªå·±çš„çŒœæƒ³ç¼ºå°‘å®é™…çš„æ•°æ®æ”¯æŒå’Œå¤šæ–¹ä½çš„æœ‰åŠ›è¯æ˜&lt;/li&gt;
&lt;li&gt;å¯¹æºç ç ”ç©¶ä¸å¤Ÿæ·±å…¥ï¼Œåªæ˜¯åœç•™åœ¨è¡¨æ˜&lt;/li&gt;
&lt;li&gt;å¯¹å®˜ç½‘çš„é…ç½®å‚æ•°ç†è§£ä¸å¤Ÿé€å½»&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;å››-ç¬¬äºŒæ¬¡æŸ¥æ‰¾é—®é¢˜å¹¶ä¸”è§£å†³çš„è¿‡ç¨‹&#34;&gt;å››ã€ç¬¬äºŒæ¬¡æŸ¥æ‰¾é—®é¢˜å¹¶ä¸”è§£å†³çš„è¿‡ç¨‹ï¼š&lt;/h3&gt;
&lt;p&gt;æœ¬åœ°ç¯å¢ƒè§‚å¯Ÿæ²¡æœ‰é—®é¢˜ï¼Œæ­£å¼ç¯å¢ƒè§‚å¯Ÿå°±æœ‰é—®é¢˜ã€‚åƒè¿™ç§é—®é¢˜ç®—æ˜¯æ¯”è¾ƒéš¾è§£å†³çš„ï¼Œä¸ºäº†å¿«é€Ÿè§£å†³é—®é¢˜ï¼Œé¿å…æŠŠçº¿ä¸Šæ•°æ®copyåˆ°æœ¬åœ°è¿›è¡Œæµ‹è¯•ï¼Œç›´æ¥downçº¿ä¸Šçš„dumpæ–‡ä»¶ä¸‹æ¥è¿›è¡Œä»”ç»†åˆ†æã€‚&lt;/p&gt;
&lt;p&gt;1ã€æŸ¥æ‰¾çº¿ä¸Šçš„å†…å­˜ï¼Œdumpæ•°é‡ï¼Œåˆšå¥½100ä¸ªï¼Œå¹¶ä¸”éšç€æ—¶é—´åç§»ï¼Œè¿™ä¸ªç±»å¯¹è±¡è¶Šæ¥è¶Šå¤šï¼Œä¸ªäººçŒœæƒ³å°±æ˜¯è¿™ä¸ªå¯¹è±¡æ²¡æœ‰è¢«å›æ”¶å¯¼è‡´è¿æ¥æ•°æœªé‡Šæ”¾ã€‚æœ‰å¼ºå¼•ç”¨å¼•ç”¨è¿™ä¸ªå¯¹è±¡ã€‚&lt;br&gt;
&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1612420897419.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;2ã€æŸ¥æ‰¾è¿™ä¸ªå¯¹è±¡GC rootå¯¹è±¡ï¼Œå³é”®é€‰æ‹©Merge Shortest Paths to GC roots -&amp;gt; exclude all phantom/weak/soft etc.reference(æ’é™¤æ‰€æœ‰è™šå¼±è½¯å¼•ç”¨)ï¼Œå‘ç°è¿™100ä¸ªå¯¹è±¡å¤§éƒ¨åˆ†è¢«ä¸€ä¸ªåå­—å«åšhousekeeperçº¿ç¨‹æ‰€å¼ºå¼•ç”¨ï¼Œå¦‚ä¸‹å›¾ã€‚ä¸ªäººéªŒè¯çŒœæƒ³æ˜¯çº¿ç¨‹æ²¡æœ‰åŠæ—¶å›æ”¶å…³é—­æˆ–è€…æ˜¯æ²¡æœ‰å…³é—­çº¿ç¨‹æ± ã€‚&lt;br&gt;
&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1612423498302.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;3ã€è¿™ä¸ªæ—¶å€™dumpæ–‡ä»¶é‡Œé¢å°±æ²¡æ³•å‘ç°æ›´å¤šæœ‰ç”¨çš„ä¿¡æ¯äº†ï¼Œç„¶åå°±å»çœ‹æºç çœ‹è¿™ä¸ªhousekeeperçº¿ç¨‹ä¸ºä»€ä¹ˆä¸€ç›´å¼ºå¼•ç”¨ã€‚æŸ¥æ‰¾æºç å‘ç°åœ¨è·å–datasource çš„ getConnetcionæ–¹æ³•ï¼Œä¼šåˆå§‹åŒ–HikariPoolè¿æ¥æ± ã€‚&lt;br&gt;
&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1612423896839.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;åˆå§‹åŒ–è¿æ¥æ± é‡Œé¢ä¼šåˆå§‹åŒ–housekeeperè¿æ¥æ± ï¼Œåˆšå¥½å¯¹åº”äº†ä¸Šé¢åœ¨æ ¹å¼•ç”¨çš„å¯¹è±¡ã€‚&lt;br&gt;
&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1612423966034.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1612425624943.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;çœ‹äº†ä¸‹è¿™ä¸ªhousekeeperå¯¹è±¡çš„ä½œç”¨ï¼Œç›®çš„æ˜¯ä¸ºäº†ç»´æŒæœ€å°‘çš„ç©ºé—²çš„è¿æ¥ï¼Œè¯´ç™½äº†å°±æ˜¯æ ¹æ®é…ç½®å‚æ•°idleTimeoutå’ŒminIdleæ¥ç»´æŒæœ€å°çš„ç©ºé—²è¿æ¥æ•°ã€‚&lt;br&gt;
&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1612425545450.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;4ã€è‡³æ­¤ï¼Œå¯ä»¥åˆæ­¥å¾—å‡ºç»“è®ºï¼Œæ˜¯ç”±äºåº”ç”¨ç¨‹åºä¸åœçš„new HikariPoolï¼Œç„¶åæ²¡æœ‰åŠæ—¶closeå¯¼è‡´çš„é—®é¢˜ã€‚ç„¶åé¡ºç€è¿™ä¸ªç»“è®ºå»æŸ¥çœ‹åº”ç”¨ç¨‹åºçš„BUG&lt;/p&gt;
&lt;p&gt;5ã€åœ¨ç¨‹åºå‘ç°ä¸‹é¢é€»è¾‘ï¼Œä¸‹é¢è¿™ä¸€æ®µé€»è¾‘å°±æ˜¯æ ¹æ®ç§Ÿæˆ·æ¥è·å–ç¼“å­˜ä¸­ç§Ÿæˆ·å¯¹åº”çš„datasourceå¯¹è±¡&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;   /**
     * è·å–å·²ç¼“å­˜çš„æ•°æ®æº
     */
    private Optional&amp;lt;DataSource&amp;gt; getDataSourceIfCache(SelectRdsConfigDto rdsConfigDto) {
        String key = getUniqueMysqlKey(rdsConfigDto.getHost(), rdsConfigDto.getPort());
        if (Objects.nonNull(dataSourceCachePool.get(key))) {
            DataSourceCache dataSourceCache = dataSourceCachePool.get(key);
            //cacheä¸­å·²ç»ç¼“å­˜äº†ç§Ÿæˆ·çš„è¿æ¥å¹¶ä¸”æ²¡æœ‰ä¿®æ”¹rds configä¿¡æ¯
            if (dataSourceCache.verifyRdsConfig(rdsConfigDto)) {
                return Optional.ofNullable(dataSourceCachePool.get(key).getDataSource());
            }
            //cacheä¸­å·²ç»ç¼“å­˜äº†ç§Ÿæˆ·çš„è¿æ¥ï¼Œä½†æ˜¯æ ¡éªŒä¸é€šè¿‡
            else {
                dataSourceCachePool.remove(key);
                return Optional.empty();
            }
        }
        return Optional.empty();
    }

   // æ ¡éªŒ
   private boolean verifyRdsConfig(SelectRdsConfigDto rdsConfigDto) {
        return rdsConfigDto.getAccount().equals(this.account) &amp;amp;&amp;amp;
                rdsConfigDto.getHost().equals(this.host) &amp;amp;&amp;amp;
                rdsConfigDto.getPort().equals(this.port) &amp;amp;&amp;amp;    rdsConfigDto.getPwd().equals(this.pwd) &amp;amp;&amp;amp;ï¼›

    //  dataSourceCachePoolçš„keyç»„æˆï¼Œä¸€ä¸ªMySQLè¿æ¥å¯¹åº”çš„key
    private String getUniqueMysqlKey(String host, Integer port){
        return host + &amp;quot;:&amp;quot; + port;
    }

 }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿™é‡Œé€»è¾‘æœ‰ä¸€æ®µæ˜¯æ ¡éªŒä¸é€šè¿‡ï¼Œä¼šremoveå¯¹åº”çš„datasourceå¯¹è±¡ï¼Œé—®é¢˜å°±å‡ºç°åœ¨è¿™é‡Œï¼Œè¿™é‡Œæ²¡æœ‰åŠæ—¶closeã€‚æ ¡éªŒä¸é€šè¿‡çš„åŸå› å°±æ˜¯ï¼Œä¸€ä¸ªhost portä½œä¸ºä¸€ä¸ªdataSourceCachePoolçš„keyï¼Œå› ä¸ºçº¿ä¸Šæœ‰ä¸€ä¸ªMySQLå®ä¾‹å¤šä¸ªè´¦å·ï¼Œå¯¼è‡´æ ¡éªŒæ€»æ˜¯ä¸é€šè¿‡è¯¯ä»¥ä¸ºæˆæ˜¯ä¿®æ”¹äº†ç”¨æˆ·åæˆ–è€…å¯†ç ï¼Œéšåå°±æ˜¯ä¸€ç›´new datasourceå¯¹è±¡ã€‚&lt;/p&gt;
&lt;h3 id=&#34;äº”-æ ¹æœ¬åŸå› &#34;&gt;äº”ã€æ ¹æœ¬åŸå› &lt;/h3&gt;
&lt;p&gt;æ‰€ä»¥ç»¼ä¸Šï¼Œæœ€ç»ˆå¾—å‡ºç»“è®ºæ˜¯ï¼Œå› ä¸ºç¨‹åºé—®é¢˜å¯¼è‡´HikariDataSourceå¯¹è±¡å¢å¤šï¼Œè€Œä¸”å› ä¸ºHikariDataSourceå¯¹è±¡å†…éƒ¨æœ‰ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œå¦‚æœå¤–éƒ¨ä¸¢å¤±äº†å¯¹è¿™ä¸ªHikariDataSourceå¯¹è±¡çš„å¼•ç”¨ï¼Œä¹Ÿä¸ä¼šè¢«åƒåœ¾å›æ”¶ï¼Œå¯¼è‡´HikariDataSourceå¯¹è±¡ä¸é‡Šæ”¾ï¼Œç„¶åç»“æœå°±æ˜¯æ•°æ®åº“è¿æ¥æœªé‡Šæ”¾ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å…­-æœ€ç»ˆå¤„ç†æ–¹å¼&#34;&gt;å…­ã€æœ€ç»ˆå¤„ç†æ–¹å¼ï¼š&lt;/h3&gt;
&lt;p&gt;1ã€ä¿®æ”¹ä»£ç ï¼š&lt;br&gt;
1ï¼‰ dataSourceCachePoolçš„keyç»„æˆç”±host port æ”¹æˆ host port account pwd å››ä¸ªç»´åº¦ä½œä¸ºä¸€ä¸ªkeyã€‚&lt;/p&gt;
&lt;p&gt;2ï¼‰å…³é—­datasourceå¯¹è±¡ï¼Œremoveé‚£æ®µä»£ç çš„é€»è¾‘ä¿®æ”¹æˆä¸‹é¢è¿™ä¸ªæ ·å­&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;//cacheä¸­å·²ç»ç¼“å­˜äº†ç§Ÿæˆ·çš„è¿æ¥,ä½†æ˜¯ä¿®æ”¹äº†rds configä¿¡æ¯
        DataSource dataSource = dataSourceCachePool.remove(key).getDataSource();
        log.info(&amp;quot;remove datasource:{}, {}&amp;quot;, key, rdsConfigDto.toString());
        new Thread(() -&amp;gt; {
            while (true) {
                try {
                    TimeUnit.SECONDS.sleep(10);
                } catch (InterruptedException e) {
                    log.error(&amp;quot;e:&amp;quot;, e);
                }
                if (dataSource instanceof HikariDataSource) {
                    if (((HikariDataSource) dataSource).getHikariPoolMXBean().getActiveConnections() &amp;gt; 0){
                        log.info(&amp;quot;ActiveConnections &amp;gt; 0, continue&amp;quot;);
                        continue;
                    }
                    log.info(&amp;quot;HikariDataSource close...&amp;quot;);
                    ((HikariDataSource) dataSource).close();
                } else if (dataSource instanceof DruidDataSource) {
                    if (((DruidDataSource) dataSource).getActiveCount() &amp;gt; 0) {
                        log.info(&amp;quot;ActiveConnections &amp;gt; 0, continue&amp;quot;);
                        continue;
                    }
                    log.info(&amp;quot;DruidDataSource close...&amp;quot;);
                    ((DruidDataSource) dataSource).close();
                } else {
                    log.error(&amp;quot;close datasource|datasource is wrong&amp;quot;);
                    throw new RuntimeException(&amp;quot;close datasource|datasource is wrong&amp;quot;);
                }
                break;
            }
        }).start();
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Qï¼šä¸ºä»€ä¹ˆè¦åˆ¤æ–­æ´»è·ƒçš„è¿æ¥ ActiveCount &amp;gt; 0 ï¼Ÿ&lt;br&gt;
Aï¼šå› ä¸ºcloseçš„æ—¶å€™è¦åˆ¤æ–­æ˜¯å¦æœ‰æ­£åœ¨ä½¿ç”¨çš„connectionå¯¹è±¡ï¼Œå¦‚æœå¼ºåˆ¶å…³é—­ï¼Œé‚£ä¹ˆä¼šå‡ºç°ä¸€ä¸ªçº¿ç¨‹æŸ¥è¯¢çš„æ—¶å€™ï¼Œconnetionçªç„¶ä¸å¯ç”¨ï¼Œå¯¼è‡´é”™è¯¯ã€‚&lt;/p&gt;
&lt;p&gt;2ã€æ”¹é…ç½®ï¼Œæ”¹æˆå’Œå®˜æ–¹é»˜è®¤çš„é…ç½®&lt;br&gt;
&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1612426469625.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;æœ€åï¼Œé‡æ–°ä¸Šçº¿åï¼Œè§‚æµ‹å¯¹è±¡å†…å­˜æ•°æ®ï¼Œæ­£å¸¸ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ä¸ƒ-æ€»ç»“&#34;&gt;ä¸ƒã€æ€»ç»“&lt;/h3&gt;
&lt;p&gt;åº•å±‚çš„æ•°æ®åº“ç»„ä»¶çš„ä»£ç ç¼–å†™ï¼Œè¦æ³¨æ„ä½¿ç”¨æ•°æ®åº“è¿æ¥èµ„æºçš„æ—¶å€™ï¼Œä¸€å®šè¦æ£€æŸ¥ä»£ç ä¸­æ˜¯å¦é‡Šæ”¾ï¼Œä¸ç„¶ä¼šé€ æˆä¸¥é‡çš„äº‹æ•…ã€‚è€Œä¸”å¹³å¸¸è¿˜è¦ç†Ÿæ‚‰å®˜æ–¹é…ç½®ï¼Œå¹¶ä¸”å¤šç ”ç©¶æºç ã€‚ä»¥å…å‡ºç°è¿™ç§æƒ…å†µæ—¶æŸæ‰‹æ— ç­–ã€‚&lt;br&gt;
å¯ä»¥çš„è¯è¿˜å¯ä»¥å«èº«è¾¹çš„èµ„æ·±å¤§ç‰›ç»™reviewä»£ç ï¼Œåšåˆ°åŒé‡ä¿éšœã€‚&lt;/p&gt;
">è®°ä¸€æ¬¡å¤šæ•°æ®æºè·¯ç”±é€ æˆçš„æ•°æ®åº“è¿æ¥æ³„éœ²æ’æŸ¥è¿‡ç¨‹</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://zhangyaoo.github.io/post/2020-nian-zong-jie/"" data-c="
          &lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1609517863900.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;å¼€å¤´&#34;&gt;å¼€å¤´&lt;/h3&gt;
&lt;p&gt;ä»Šå¤©æ˜¯1æœˆ1å·ï¼Œæ–°å¹´ç¬¬ä¸€å¤©ï¼ŒæŠ“ä½2020å¹´çš„å°å°¾å·´ï¼Œéšä¾¿çµ®çµ®å¨å¨ä¸€ä¸‹ï¼Œåšä¸ªå°æ€»ç»“ã€‚å›æƒ³ä¸€ä¸‹ä»Šå¹´ä¸€æ•´å¹´ï¼Œå¼€å¿ƒï¼Œå›°éš¾ï¼Œå¿ƒé…¸ï¼Œå¤§éƒ¨åˆ†éƒ½ç»å†è¿‡ï¼Œæ²¡æœ‰ä»€ä¹ˆå€¼å¾—è¯´çš„ç»å†ï¼Œå€’æ˜¯å°äº‹æŒºå¤šã€‚&lt;/p&gt;
&lt;p&gt;å€¼å¾—æçš„äº‹æƒ…å°±æ˜¯ç–«æƒ…äº†ï¼Œä»Šå¹´ç–«æƒ…åœ¨å®¶å‘†äº†2ä¸ªæœˆï¼Œé‚£æ—¶å€™å› ä¸ºå¹´å‰è¢«è£ï¼Œå·²ç»æ˜¯å¤±ä¸šçš„çŠ¶æ€ï¼Œæ²¡æœ‰æ”¶å…¥æ¥æºï¼Œå¼€å§‹åç«‹ä¸å®‰ï¼Œçƒ¦èº ã€‚åé¢æ„è¯†åˆ°äº†åœ¨å®¶ä¹Ÿæœ‰åœ¨å®¶å€¼å¾—åšçš„äº‹æƒ…ï¼Œä¸å¿…å› ä¸ºç–«æƒ…æ‰“ä¹±è‡ªå·±çš„å†…å¿ƒï¼Œå……å®é™ªå®¶äººè¿‡æ¯ä¸€å¤©ã€‚&lt;/p&gt;
&lt;p&gt;ä½œä¸ºæˆå¹´äººï¼Œç°åœ¨è®¤ä¸ºæ—¶å¸¸å¼€å¿ƒå¿«ä¹å€’æ˜¯ä¸€ä»¶å¾ˆéš¾çš„äº‹æƒ…ï¼Œæƒ³èµ·ä¸€å¥è¯ï¼Œå°æ—¶å€™å¿«ä¹æ˜¯ä¸€ä»¶ç®€å•çš„äº‹æƒ…ï¼Œé•¿å¤§åï¼Œç®€å•æ˜¯ä¸€ä»¶å¿«ä¹çš„äº‹æƒ…ã€‚ä¸è¿‡åé¢è¿˜æ˜¯è¦æ—¶å¸¸å¼€å¿ƒä¸ºä¸»ï¼Œç„¶åå°±æ˜¯ä»Šå¹´ä»¥åè¦æ²‰é™ä¸‹æ¥ï¼Œç†æ€§æ€è€ƒï¼Œä¸ç®¡å¯¹äººè¿˜æ˜¯å¯¹äº‹ã€‚è¿˜è¦å¤šçœ‹äº›å…³äºç”Ÿæ´»ä¸Šçš„ä¹¦ï¼Œä¸åªæ˜¯ç›¯ç€æŠ€æœ¯ä¹¦æ­»å•ƒï¼Œæé†’ä¸€ä¸‹è‡ªå·±è¦åœä¸‹æ¥å¤šæ€è€ƒï¼Œä½å¤´åšäº‹ï¼ŒæŠ¬å¤´çœ‹è·¯ã€‚&lt;/p&gt;
&lt;p&gt;ä»Šå¹´æ€»ç»“æ–¹é¢æœ‰äº›å°‘ï¼Œå› ä¸ºæˆ‘è‡ªå·±è®¤ä¸ºè¿™äº›æ–¹é¢å€¼å¾—å»æ€»ç»“ï¼Œè‡³äºå…¶ä»–çš„ï¼Œå¯èƒ½æˆ‘æ²¡æœ‰æ„è¯†åˆ°æˆ–è€…æ˜¯ä»Šå¹´ç»å†äº‹æƒ…çš„å¤ªå°‘ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å­¦ä¹ &#34;&gt;å­¦ä¹ &lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1609517630829.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
å…³äºå­¦ä¹ è¿™ä»¶äº‹ï¼Œè¿˜æ˜¯è¦æ”¾åœ¨ç¬¬ä¸€æ¥è¯´ã€‚å­¦æ— æ­¢å¢ƒï¼Œæ´»åˆ°è€å­¦åˆ°è€ã€‚äººä¸èƒ½æ€»æ˜¯åœç•™åœ¨åŸåœ°ï¼Œè¿˜æ˜¯è¦å¤šçœ‹ä¹¦å¤šå­¦ä¹ ï¼Œå¢é•¿çŸ¥è¯†ã€‚ä¸­å›½äººå¤§éƒ¨åˆ†åŠ³åŠ¨äººæ°‘ä»¥å‰ï¼ˆ80å¹´ä»£ï¼‰æ˜¯åŸºæœ¬é åŠªåŠ›ï¼Œé å‹¤å¥‹ï¼Œè·å¾—å±äºè‡ªå·±çš„åŠ³åŠ¨æœå®ï¼Œç°åœ¨ä¿¡æ¯æ—¶ä»£ï¼Œé™¤äº†é åŠªåŠ›å‹¤å¥‹ä»¥å¤–ï¼Œè¿˜è¦æœ‰æ•ˆåˆ©ç”¨ä¸“ä¸šçŸ¥è¯†å»è§£å†³ç”Ÿæ´»å·¥ä½œä¸­çš„é—®é¢˜ï¼Œäº«å—ç°åœ¨ä¿¡æ¯æ—¶ä»£ç»™ä¸çš„æˆæœã€‚&lt;br&gt;
å°±åƒæ–‡è‡£æ­¦å°†ï¼Œè°‹å£«å½“å‡ºè°‹åˆ’ç­–ï¼Œæ­¦å£«å½“æˆ˜åœºå®æ€ã€‚æ¯ä¸ªäººå½“å»å‘æŒ¥è‡ªå·±çš„ä¸“ä¸šæœ¬é¢†ã€‚ä¸ç®¡æœ€ç»ˆç›®çš„æ˜¯å•¥ï¼Œç²¾å¿ æŠ¥å›½è¿˜æ˜¯å…»å®¶ç³Šå£ï¼Œå°æœ‰å°ä¹‰ï¼Œå¤§æœ‰å¤§ä¹‰ã€‚&lt;/p&gt;
&lt;p&gt;æ‰¯è¿œäº†ï¼Œä»Šå¹´å‡†å¤‡è¿˜æ˜¯ä»¥æŠ€æœ¯å­¦ä¹ ä¸ºä¸»ï¼Œç„¶åä»¥å…¬ä¼—å·å’ŒGitHubä¸ºè¾…åŠ©è¿›è¡Œå­¦ä¹ ã€‚&lt;br&gt;
ä»Šå¹´å‡†å¤‡çœ‹å®Œè¿™äº›å­¦ä¹ èµ„æ–™ï¼Œå…¶ä¸­æœ‰ä¹¦ç±ä»¥åŠç½‘ç»œè¯¾ç¨‹&lt;br&gt;
1ã€MySQLæ˜¯å¦‚ä½•è¿è¡Œçš„&lt;br&gt;
2ã€redisè®¾è®¡å’Œå®ç°&lt;br&gt;
3ã€æ¶æ„å¸ˆè§†é¢‘è¯¾&lt;br&gt;
4ã€æå®¢æ—¶é—´MySQL&lt;br&gt;
5ã€Nettyç½‘ç»œç¼–ç¨‹å­¦ä¹ +æŠ€æœ¯ä¹¦ç±+Nettyå®æˆ˜&lt;/p&gt;
&lt;p&gt;ä¸å¤šï¼Œåˆ—å¤šäº†å°±çœ‹ä¸å®Œäº†[dog]ã€‚&lt;/p&gt;
&lt;p&gt;å…¶ä»–åˆ™æŒ‰æ—¶åŠæ—¶æ€»ç»“å·¥ä½œä¸Šé‡åˆ°çš„é—®é¢˜ï¼Œæå‡è‡ªå·±çš„æŠ€æœ¯æ·±åº¦ã€‚æ¯•ç«Ÿå·¥ä½œä¸­é‡åˆ°çš„æœ€å®¹æ˜“åŠ æ·±ç†è§£çš„å’Œæå‡èƒ½åŠ›çš„ã€‚&lt;br&gt;
é¡ºä¾¿çœ‹ä¸€äº›ä¼˜ç§€çš„åšå®¢åŠæ—¶æ€»ç»“ï¼Œè¾“å‡ºè‡ªå·±çš„ç†è§£ã€‚ç„¶åç»´æŠ¤åˆ°è‡ªå·±çš„ä¸ªäººç½‘ç«™ä¸Šé¢å»ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åå…¶ä»–æ—¶é—´ï¼Œå‡†å¤‡çœ‹ä¸€äº›å…¶ä»–ç±»å‹çš„ä¹¦ç±ï¼Œæ¯”å¦‚äººæ–‡å†å²ï¼Œä»¥åŠå…¶ä»–ä¼˜ç§€çš„å›½å†…å¤–è‘—ä½œï¼Œç°åœ¨å·²ç»æƒ³å¥½çœ‹äº›ä»€ä¹ˆï¼Œå°±ä¸ä¸€ä¸€åˆ—ä¸¾äº†ï¼Œä»Šå¹´ä»Šåä¼šæŠ½ç©ºä½™æ—¶é—´å»çœ‹è¿™äº›ï¼Œæå‡è‡ªå·±å¯¹äººå’Œç”Ÿæ´»çš„ä¸€äº›æ€è€ƒã€‚&lt;/p&gt;
&lt;p&gt;æœ€åçš„è¯è¦æé†’è‡ªå·±å°‘çœ‹åŠ¨æ¼«äºŒæ¬¡å…ƒå¤šå­¦ä¹ ï¼Œæ—©ç¡æ—©èµ·~~&lt;/p&gt;
&lt;h3 id=&#34;è¿åŠ¨&#34;&gt;è¿åŠ¨&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1609517659211.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
è¿åŠ¨è¿™ä»¶äº‹æƒ…ï¼Œç®—æ˜¯æˆ‘ä¸ªäººæ¯å¹´ç«‹çš„flagä¸­ï¼Œè‡ªå·±æœ€æ»¡æ„çš„äº†ã€‚ä¸€å‘¨æœ€å°‘ä¸€æ¬¡è·‘æ­¥+ç¯®çƒã€‚åŸºæœ¬ä¸Šä¹Ÿä¸ç®—å…¨éƒ¨ï¼Œæ¯å‘¨éƒ½åšäº†ã€‚&lt;br&gt;
æˆ‘èº«è¾¹çš„æœ‹å‹æˆ–è€…äº²äººï¼Œæˆ‘ä¼šç»å¸¸æé†’ä»–ä»¬ï¼Œè¦é€‚å½“çš„é”»ç‚¼ã€‚è™½ç„¶æ€»æ˜¯è¢«å½“ä½œè€³è¾¹é£ï¼Œä½†æ˜¯æ¯æ¬¡è¿‡å¹´ç¥åˆ«äººèº«ä½“å¥åº·åªæ˜¯å™±å¤´ï¼Œåªæœ‰çœŸæ­£å…³å¿ƒä½ çš„äººä¼šåœ¨ä¹ä½ çš„å¥åº·ã€‚æˆ‘ä¸ªäººä¸ç®¡æ˜¯ç”Ÿæ—¥è¿˜æ˜¯æ–°å¹´æ„¿æœ›ï¼Œå¤§éƒ¨åˆ†éƒ½æ˜¯å¸Œæœ›èº«è¾¹çš„äººè¿‡çš„å¹³å¹³å®‰å®‰å¼€å¼€å¿ƒå¿ƒå°±è¡Œäº†ï¼Œå…¶ä»–éƒ½æ˜¯æ‰¯æ·¡ã€‚&lt;br&gt;
è€Œæˆ‘è‡ªå·±è¿åŠ¨çš„åŠ¨åŠ›æ¥æºæ˜¯ï¼Œå¦‚æœæˆ‘è‡ªå·±èº«ä½“ä¸è¡Œï¼Œé‚£å°±æ²¡æœ‰èƒ½åŠ›ç…§æŠ¤èº«è¾¹äººã€‚æˆ‘è‡ªå·±èƒ½å¤Ÿæˆé•¿ä¸ºå¤§æ ‘ï¼Œè®©åˆ«äººå®‰å¿ƒå€šé ã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨è™½ç„¶æ¯•ä¸šäº†3å¹´ï¼Œ6å—è…¹è‚Œå·²ç»å˜æˆäº†4å¿«ï¼Œèº«ä½“æ²¡æœ‰æ¯•ä¸šé‚£ä¼šå¥½ï¼Œä½†æ˜¯æˆ‘è‡ªå·±è¿˜æ˜¯ä¼šåšæŒçš„ï¼Œæœç€æ›´mançš„ç›®æ ‡å¥‹æ–—ã€‚æƒ³å½“å¹´æˆ‘å¯æ˜¯æ‹¥æœ‰8å—è…¹è‚Œçš„ç”·äººã€‚ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;h3 id=&#34;çˆ±æƒ…&#34;&gt;çˆ±æƒ…&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1609517842818.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ä»Šå¹´æœ€å¼€å¿ƒçš„å°±æ˜¯å’Œå¥³æœ‹å‹åº¦è¿‡ç¬¬ä¸€å¹´çš„æ‹çˆ±æœŸï¼ˆä¸è¦è„¸çš„æˆ‘ï¼Œè‡ªè®¤ä¸ºç½‘æ‹äº†ä¸€å¹´çš„çƒ­æ‹æœŸï¼‰ï¼Œè¿™ä¸€å¹´æœ‰å¼€å¿ƒå’Œéš¾è¿‡ï¼Œä¸è¿‡éš¾è¿‡æ—¶åˆ»å¾ˆå°‘ï¼Œå¤§éƒ¨åˆ†éƒ½æ˜¯å¼€å¿ƒæ—¶åˆ»ï¼Œæˆ‘è§‰å¾—å·²ç»å¯ä»¥äº†ï¼Œèƒ½å¤Ÿå’Œå¯¹æ–¹æ¯å¤©éƒ½å¾ˆå¼€å¿ƒï¼Œå·²ç»å¾ˆä¸é”™äº†ã€‚æ¯•ç«Ÿå’Œå–œæ¬¢çš„äººåœ¨ä¸€èµ·ä¸å°±æ˜¯å¼€å¿ƒæ’’ï¼Œè¿™ä¸ªæ˜¯æœ€éš¾èƒ½å¯è´µçš„ã€‚ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘è‡ªè®¤ä¸ºæˆ‘æ˜¯ä¸ªä¸å¥½iç›¸å¤„çš„äººï¼Œä¸ªäººçš„å°è„¾æ°”å¾ˆå¤šï¼Œè€Œä¸”æœ‰æ—¶å€™ä¼šå¸¸æœ‰ä¸è‡ªä¿¡ã€‚è°¢è°¢æˆ‘å¥³æœ‹å‹çš„ç†è§£å’Œé¼“åŠ±ã€‚ä»Šå¹´å¾€åï¼Œè¿˜å¸Œæœ›ä¸€èµ·å¼€å¿ƒåº¦è¿‡æ¯ä¸€å¤©ï¼Œå“ˆå“ˆå“ˆå“ˆã€‚&lt;/p&gt;
&lt;p&gt;æ–°çš„ä¸€å¹´ï¼Œå¸Œæœ›å’±ä¿©éƒ½èº«ä½“å¥åº·ï¼Œå¼€å¼€å¿ƒå¿ƒ~&lt;/p&gt;
&lt;h3 id=&#34;2021flag&#34;&gt;2021flag&lt;/h3&gt;
&lt;p&gt;å›½é™…æƒ¯ä¾‹ï¼Œæœ€åè¯´ä¸€äº›æ‰“è„¸çš„flag&lt;br&gt;
1ã€å®Œæˆä¸Šé¢çš„èµ„æ–™çš„å­¦ä¹ &lt;br&gt;
2ã€æ¯ä¸ªæœˆä¸€æ¬¡æ–‡ç« æ€»ç»“ï¼Œå·¥ä½œæ€»ç»“ï¼Œ4æ¬¡ä¸ªäººç½‘ç«™æ–‡ç« çš„å‘è¡¨å’Œç»´æŠ¤&lt;br&gt;
3ã€ä¸€å‘¨ä¸€æ¬¡è¿åŠ¨+ç¯®çƒ&lt;br&gt;
4ã€èº«ä½“ä½“é‡ä¸è¶…130&lt;br&gt;
5ã€ç»è¥å¥½ä¸ªäººåšå®¢&lt;br&gt;
6ã€ æ—©ç¡æ—©èµ·ï¼Œ11ç‚¹åŠä¹‹å‰ç¡&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;2021å¹´ï¼Œå¹²å°±å®Œäº‹&lt;/strong&gt;ã€‚&lt;br&gt;
&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1609517948326.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
">2020å¹´æ€»ç»“</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://zhangyaoo.github.io/post/ying-yong-ceng-wang-guan-she-ji-yu-shi-xian/"" data-c="
          &lt;p&gt;##è¿˜æ²¡å®Œæˆï¼Œæ•¬è¯·æœŸå¾…&lt;/p&gt;
">åº”ç”¨å±‚ç½‘å…³è®¾è®¡ä¸å®ç°</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://zhangyaoo.github.io/post/shou-lu-yi-ge-hong-bao-suan-fa/"" data-c="
          &lt;h3 id=&#34;1-è¦æ±‚&#34;&gt;1ã€è¦æ±‚&lt;/h3&gt;
&lt;p&gt;çº¢åŒ…ç®—æ³• functionï¼šæ‹¼æ‰‹æ°”çº¢åŒ…&lt;br&gt;
1ã€æ¯ä¸ªçº¢åŒ…è·å¾—çš„æ•°å­¦æ¦‚ç‡è¦ä¸€æ ·&lt;br&gt;
2ã€çº¢åŒ…æœ€å°å€¼ï¼š1åˆ†é’±&lt;/p&gt;
&lt;h3 id=&#34;2-æ€è·¯&#34;&gt;2ã€æ€è·¯ï¼š&lt;/h3&gt;
&lt;p&gt;åˆ©ç”¨åˆ‡ç‰‡çš„æ€æƒ³ï¼Œæ¯”å¦‚æœ‰5ä¸ªçº¢åŒ…ï¼Œ20åˆ†ï¼Œå°±ä»0-20çš„èŒƒå›´å†…è·å–å››ä¸ªéšæœºæ•°ï¼Œå°±è¢«åˆ†æˆ5ä»½ï¼Œç„¶åé¡ºåºæŠ½å–ã€‚è¿™æ ·ä¿è¯æ¯ä¸ªçº¢åŒ…çš„çš„æ¦‚ç‡ä¸€æ ·&lt;br&gt;
è¿™ç§æ–¹æ¡ˆéœ€è¦è€ƒè™‘åˆ°å‡ ä¸ªæ³¨æ„ç‚¹ï¼š&lt;br&gt;
1ï¼‰é‡å¤çš„éšæœºåˆ‡ç‰‡å¦‚ä½•å¤„ç†ï¼›&lt;br&gt;
2ï¼‰éœ€è¦è€ƒè™‘1åˆ†é’±å¦‚ä½•å¤„ç†ï¼›&lt;/p&gt;
&lt;h3 id=&#34;3-å®ç°&#34;&gt;3ã€å®ç°ï¼š&lt;/h3&gt;
&lt;p&gt;é‡åˆ°éšæœºåˆ‡ç‰‡é‡å¤:é‡æ–°ç”Ÿæˆåˆ‡ç‰‡ç›´è‡³ä¸é‡å¤&lt;br&gt;
1åˆ†é’±å¤„ç†ï¼šåˆ¤æ–­ç›¸é‚»é—´éš”çš„å¤§å°&lt;/p&gt;
&lt;p&gt;###4ã€ ä»£ç å®ç°ï¼š&lt;br&gt;
åˆ©ç”¨treeMapçš„é¡ºåºæœ‰åºæ€§&lt;/p&gt;
&lt;p&gt;ç›´æ¥ä¸Šä»£ç ï¼ˆç¬”è€…å·²ç»è°ƒè¯•è¿‡æ²¡æœ‰é—®é¢˜ï¼Œå¯ä»¥è¿è¡Œï¼‰&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class RedPackage {
   /**
    * çº¢åŒ…æœ€å°é‡‘é¢
    */
   private long minAmount = 1L;

   /**
    * æœ€å¤§çš„çº¢åŒ…æ˜¯å¹³å‡å€¼çš„Nå€
    */
   private static final long N = 2;

   /**
    * çº¢åŒ…æœ€å¤§é‡‘é¢
    */
   private long maxAmount;

   /**
    * çº¢åŒ…é‡‘é¢ åˆ†
    */
   private long packageAmount;

   /**
    * çº¢åŒ…ä¸ªæ•°
    */
   private long packageSize;

   /**
    * æ˜¯å¦æŠ¢å®Œ
    */
   private boolean finish;

   /**
    * å­˜å‚¨çº¢åŒ…çš„é‡‘é¢é¡ºåº
    */
   private final TreeMap&amp;lt;Long, Long&amp;gt; treeMap = Maps.newTreeMap((o1, o2) -&amp;gt; o1 &amp;gt; o2 ? 1 : o1.equals(o2) ? 0 : -1);

   /**
    * æ„é€ å‡½æ•°ä¸å†™ä¸šåŠ¡é€»è¾‘
    */
   public RedPackage(long packageAmount, int packageSize){
       this.packageAmount = packageAmount;
       this.packageSize = packageSize;
       maxAmount = (packageAmount * N)/ packageSize;
   }

   public RedPackage(long packageAmount, int packageSize, long minAmount){
       this.packageAmount = packageAmount;
       this.packageSize = packageSize;
       this.minAmount = minAmount;
   }

   /**
    * è·å–é‡‘é¢
    */
   public synchronized long nextAmount(){
       // å‰ç½®æ ¡éªŒï¼Œåˆå§‹åŒ–
       if(!finish &amp;amp;&amp;amp; treeMap.size() == 0){
           treeMap.put(packageAmount, 0L);
           for (int i = 0; i &amp;lt; packageSize - 1; i++) {
               // éšæœºæŠ½å–åˆ‡ç‰‡
               long splitNum = RandomUtils.nextLong(minAmount, packageAmount);
               Long higher = treeMap.higherKey(splitNum);
               higher = higher == null ? packageAmount : higher;
               Long lower = treeMap.lowerKey(splitNum);
               lower = lower == null ? 0 : lower;
               // ç›¸åŒåˆ‡ç‰‡é‡æ–°ç”Ÿæˆ,å’Œä¸Šä¸€ä¸ªæˆ–è€…ä¸‹ä¸€ä¸ªåˆ‡ç‰‡é—´éš”å°äºminAmountçš„é‡æ–°ç”Ÿæˆ
               while (higher - splitNum &amp;lt;= minAmount
                       || splitNum - lower &amp;lt;= minAmount
                       || treeMap.containsKey(splitNum)){
                   splitNum = RandomUtils.nextLong(minAmount, packageAmount);
               }
               // valueæ”¾å…¥ä¸Šä¸€ä¸ªentryçš„key,ç»„æˆé“¾æ¡ï¼Œé˜²æ­¢å†æ¬¡å¾ªç¯
               treeMap.put(splitNum, lower);
               treeMap.put(higher, splitNum);
           }
           System.out.println(&amp;quot;init finish&amp;quot;);
       }
       Map.Entry&amp;lt;Long, Long&amp;gt; entry = treeMap.pollFirstEntry();
       if(treeMap.size() == 0){
           // ç”¨å®Œçº¢åŒ…
           this.finish = true;
           if(entry == null){
               return 0L;
           }
       }
       return entry.getKey() - entry.getValue();
   }

   public static void main(String[] args) {
       RedPackage redPackage = new RedPackage(1500L, 10, 10L);
       long result = 0;
       for (int i = 0; i &amp;lt; 15; i++) {
           long amount = redPackage.nextAmount()ï¼›
           System.out.println(amount);
           result = result + amount;
       }
       System.out.println(result);
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;5-todo-è®¾ç½®å•ä¸ªçº¢åŒ…æœ€å¤§é™é¢å€¼&#34;&gt;5ã€TODO è®¾ç½®å•ä¸ªçº¢åŒ…æœ€å¤§é™é¢å€¼&lt;/h3&gt;
&lt;p&gt;ç›®å‰è¿˜æ²¡æœ‰å®ç°æ€è·¯&lt;/p&gt;
">æ¦‚ç‡ç›¸ç­‰çš„æ‹¼æ‰‹æ°”çº¢åŒ…ç®—æ³•å®ç°</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://zhangyaoo.github.io/post/di-pin-lu-da-shu-ju-liang-qiang-yi-zhi-xing-chang-jing-xia-jie-jue-si-lu/"" data-c="
          &lt;h1 id=&#34;&#34;&gt;&lt;/h1&gt;
">ä½é¢‘ç‡å¤§æ•°æ®é‡å¼ºä¸€è‡´æ€§åœºæ™¯ä¸‹è§£å†³æ€è·¯</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://zhangyaoo.github.io/post/jie-jue-dubbo-duo-ci-diao-yong-dao-zhi-yin-shi-can-shu-diu-shi-wen-ti/"" data-c="
          &lt;h1 id=&#34;&#34;&gt;&lt;/h1&gt;
">è§£å†³Dubboå¤šæ¬¡è°ƒç”¨å¯¼è‡´éšå¼å‚æ•°ä¸¢å¤±é—®é¢˜</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://zhangyaoo.github.io/post/hua-dong-chuang-kou-shi-xian-xian-liu-suan-fa-huan-xing-dui-lie-shi-xian/"" data-c="
          &lt;h3 id=&#34;&#34;&gt;&lt;/h3&gt;
">æ»‘åŠ¨çª—å£é™æµç®—æ³•â€”â€”ç¯å½¢é˜Ÿåˆ—å®ç°</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://zhangyaoo.github.io/post/xue-xi-bi-ji-mysql/"" data-c="
          &lt;h3 id=&#34;&#34;&gt;&lt;/h3&gt;
">å­¦ä¹ ç¬”è®°ï¼šMySQL</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://zhangyaoo.github.io/post/ji-yi-ci-cai-yong-fen-bu-shi-id-jie-jue-fen-ku-fen-biao-cai-de-keng/"" data-c="
          &lt;h3 id=&#34;ä¸€-èƒŒæ™¯&#34;&gt;ä¸€ã€èƒŒæ™¯&lt;/h3&gt;
&lt;p&gt;éšç€ä¸šåŠ¡æ¨¡å¼çš„æ‰©å¤§ï¼Œå¤šä¸ªå¹³å°ä¸‹ç”¨æˆ·æ•°é‡ä¸æ–­æ‰©å¤§ã€‚å¹¶ä¸”å› ä¸ºä¸šåŠ¡éœ€è¦ï¼Œéœ€è¦åˆå¹¶ä¸¤ä¸ªä¸šåŠ¡ç³»ç»Ÿçš„ç”¨æˆ·ä¸­å¿ƒï¼Œå› ä¸ºéœ€è¦å¯¹æ¥ä¸‰æ–¹ç³»ç»Ÿï¼Œæ‰€ä»¥è¦æ±‚ç”¨æˆ·çš„IDæ ‡è¯†ä¸èƒ½ä½“ç°å‡ºç³»ç»Ÿçš„ç”¨æˆ·é‡ã€‚&lt;br&gt;
æŠ€æœ¯å›¢é˜Ÿè€ƒè™‘åˆ°è¿™ç§åœºæ™¯ä»¥åŠåç»­ç”¨æˆ·çš„æ‰©å¤§ï¼Œéœ€è¦ä¸€ä¸ªæ–¹æ¡ˆå»è§£å†³åœ¨&lt;strong&gt;åˆ†å¸ƒå¼ç¯å¢ƒ&lt;/strong&gt;ä¸‹IDé€’å¢çš„é—®é¢˜ï¼Œç³»ç»Ÿè‡ªå·±çš„IDé€’å¢ç®—æ³•ä¹Ÿéœ€è¦åšæ”¹å˜ã€‚&lt;/p&gt;
&lt;h3 id=&#34;äºŒ-ä¸šç•Œæ¯”è¾ƒæµè¡Œçš„åˆ†å¸ƒå¼idè§£å†³æ–¹æ¡ˆ&#34;&gt;äºŒã€ä¸šç•Œæ¯”è¾ƒæµè¡Œçš„åˆ†å¸ƒå¼IDè§£å†³æ–¹æ¡ˆ&lt;/h3&gt;
&lt;p&gt;æŠ€æœ¯å›¢é˜Ÿé¦–å…ˆè€ƒå¯Ÿä¸šç•Œæ¯”è¾ƒæµè¡Œçš„åšæ³•ï¼Œæ€»ç»“ä¸åŒæ–¹æ¡ˆä¼˜ç¼ºç‚¹ï¼Œç„¶åæ ¹æ®è‡ªå·±çš„ä¸šåŠ¡æ¥é€‰æ‹©æ›´åˆé€‚çš„æ–¹æ¡ˆã€‚&lt;/p&gt;
&lt;h4 id=&#34;21-æ•°æ®åº“åˆ†æ‰¹idåˆ†å‘&#34;&gt;2.1 æ•°æ®åº“åˆ†æ‰¹IDåˆ†å‘&lt;/h4&gt;
&lt;p&gt;æ•°æ®åº“åˆ†æ‰¹IDåŸç†ä¸»è¦æ˜¯åˆ©ç”¨åˆ†æ‰¹æ€æƒ³ä»¥åŠä¹è§‚é”æ¥è§£å†³ï¼Œç›®å‰æ·˜å®ä¸­é—´ä»¶TDDLå…¶ä¸­çš„ä¸»é”®åˆ†é…å°±æ˜¯ç”¨äº†è¿™ä¸ªæ–¹æ¡ˆã€‚è¯¥æ–¹æ¡ˆå…·ä½“æ˜¯è¿™æ ·åšçš„ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ•°æ®åº“è¡¨ç»´æŠ¤ä¸€æ¡æ•°æ®ï¼Œè®°å½•å½“å‰åˆ†é…IDå·ä»¥åŠåç§»æ•°é‡ç­‰æ•°æ®&lt;/li&gt;
&lt;li&gt;ç¼–å†™æœåŠ¡ï¼Œåˆ©ç”¨ä¹è§‚é”å»CASæ›´æ–°æ•°æ®ï¼Œæ›´æ–°æˆåŠŸå°±è¯´æ˜æ‹¿åˆ°äº†ä¸€æ‰¹IDå·ï¼Œå¤±è´¥çš„è¯è¿›è¡Œé‡è¯•ï¼Œè®¾ç½®ä¸€å®šçš„é‡è¯•æ¬¡æ•°&lt;/li&gt;
&lt;li&gt;æ”¾å…¥æœ¬åœ°ç¼“å­˜æˆ–è€…redisåšæ‰£å‡ï¼Œå¦‚æœç”¨å®Œå°±é‡å¤æ­¥éª¤2&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å…·ä½“çš„çš„è¡¨å¯ä»¥æ˜¯ç±»ä¼¼è¿™æ ·çš„ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center&#34;&gt;å­—æ®µ&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;æè¿°&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;id&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;è‡ªå¢IDï¼Œæ²¡æœ‰ä¸šåŠ¡æ„ä¹‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;current_num&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;å½“å‰å·²ç»åˆ†é…çš„IDæœ€å¤§å€¼&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;limit&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;ä¸€æ¬¡åˆ†é…å¤šå°‘ä¸ªID&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;version&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;ç‰ˆæœ¬å·ï¼ŒCASæ›´æ–°ç”¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;create_time&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;è®°å½•åˆ›å»ºæ—¶é—´&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;update_time&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;è®°å½•æ›´æ–°æ—¶é—´&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;æ¯”å¦‚ï¼Œlimit=1000ï¼Œä¸€æ¬¡åˆ†é…1000ä¸ªIDï¼Œæ²¡åˆ†é…ä¹‹å‰current_num = 0ï¼Œç¬¬ä¸€æ¬¡current_num = 1000ï¼Œç¬¬äºŒæ¬¡ä¾æ¬¡ç±»æ¨ã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶ï¼Œä¸Šè¿°çš„æ–¹æ¡ˆä¹Ÿæœ‰ç¼ºç‚¹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä¸€æ¡æ•°æ®ï¼Œå¦‚æœæœ‰å¤§é‡æµç¨‹å»æ›´æ–°ï¼Œè¦ç«äº‰è·å–è¡Œé”ï¼Œä¼šæœ‰æ€§èƒ½é—®é¢˜ï¼Œï¼ˆå¯ä»¥å‚è€ƒè¡Œé”çš„åˆ©å¼Šï¼Œä¸å¥‡â€”â€”ç§’æ€åœºæ™¯ä¸‹MySQLçš„ä½æ•ˆï¼‰&lt;/li&gt;
&lt;li&gt;å¼ºä¾èµ–DBï¼Œå¦‚æœå½“å‰æ•°æ®åº“å®•æœºï¼Œå¯¼è‡´åˆ†å¸ƒå¼IDåˆ†å‘æœåŠ¡å°±ä¼šå‡ºç°é—®é¢˜&lt;/li&gt;
&lt;li&gt;å¦‚æœåœ¨ä¸»ä»æ•°æ®åº“åœºæ™¯ä¸‹ï¼Œéœ€è¦è€ƒè™‘åˆ°ä¸»ä»çš„å»¶è¿Ÿæ€§å¯¼è‡´åˆ†é…IDçš„ä¸ä¸€è‡´æ€§&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ‰€ä»¥ä¸ºäº†è§£å†³ä¸Šé¢çš„é—®é¢˜ï¼Œç¬”è€…å‚è€ƒconcurrentHashMapåˆ†æ®µé”çš„æ€æƒ³ï¼Œå°†ä¸€æ¡è®°å½•åˆ†æ®µä¸ºå¤šä¸ªï¼ŒåŒæ—¶ä¸ºäº†é¿å…DBå•ç‚¹å¯ç”¨æ€§ï¼Œå¯ä»¥å°†ä¸åŒçš„è®°å½•åˆ†å¸ƒåœ¨ä¸åŒçš„æ•°æ®åº“ä¸Šé¢ã€‚&lt;/p&gt;
&lt;p&gt;å…·ä½“çš„è¡¨å¯ä»¥æ˜¯ç±»ä¼¼è¿™æ ·çš„ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center&#34;&gt;å­—æ®µ&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;æè¿°&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;id&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;è‡ªå¢IDï¼Œæ²¡æœ‰ä¸šåŠ¡æ„ä¹‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;current_num&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;å½“å‰å·²ç»åˆ†é…çš„IDæœ€å¤§å€¼&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;limit&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;ä¸€æ¬¡åˆ†é…å¤šå°‘ä¸ªID&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;offset&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;å‰ååˆ†é…çš„IDé—´éš”æ•°&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;initial_id&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;åˆå§‹è‡ªå¢çš„ID&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;version&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;ç‰ˆæœ¬å·ï¼ŒCASæ›´æ–°ç”¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;create_time&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;è®°å½•åˆ›å»ºæ—¶é—´&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;update_time&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;è®°å½•æ›´æ–°æ—¶é—´&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;â€ƒæ–°å¢offsetåç§»å’Œinitial_idå­—æ®µï¼Œoffsetä»£è¡¨æ•°æ®åº“è¡¨è®°å½•å‰ååˆ†é…é—´éš”æ•°é‡ï¼Œinitial_idä»£è¡¨å¼€å§‹åˆå§‹çš„å€¼ã€‚&lt;br&gt;
â€ƒä¸¾ä¸ªä¾‹å­ï¼Œç°åœ¨å°†è®°å½•åˆ†ä¸º10æ¡ï¼Œåˆ†å¸ƒåœ¨ä¸åŒæ•°æ®åº“ä¸Šï¼Œé‚£ä¹ˆoffsetå°±æ˜¯10000ï¼Œlimitå°±æ˜¯1000ï¼Œç¬¬ä¸€æ¡è®°å½•ç¬¬ä¸€æ¬¡å¼€å§‹é…åˆè·å–0-1000ï¼Œç¬¬äºŒæ¬¡åˆ†é…è·å–10000-11000ï¼Œä¾æ¬¡ç±»æ¨ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒè¿™é‡Œéœ€è¦è€ƒè™‘ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å¦‚æœè¯·æ±‚IDåˆ†å‘çš„æœåŠ¡çš„æµé‡&lt;strong&gt;æ€ä¹ˆè·¯ç”±&lt;/strong&gt;åˆ°å…·ä½“çš„è®°å½•å‘¢ï¼Ÿå¦‚æœæµé‡å…¨éƒ¨éƒ½è¯·æ±‚åˆ°ç¬¬ä¸€æ¡è®°å½•ä¸Šäº†ï¼Œå°±ä¼šå¯¼è‡´è¯·æ±‚ä¸å‡ã€‚&lt;br&gt;
â€ƒè¿™ä¸ªé—®é¢˜å¾ˆç®€å•ï¼Œæœ‰ä¸€å®šå¼€å‘ç»éªŒçš„è¯»è€…è‡ªç„¶å¯ä»¥è”æƒ³åˆ°ç”¨ä¸€è‡´æ€§hashå»è·¯ç”±ï¼Œå…·ä½“è·¯ç”±çš„keyå¯ä»¥æ ¹æ®ä¸šåŠ¡å»å®šï¼Œæ¯”å¦‚ç”¨æˆ·æ‰‹æœºå·ã€‚ï¼ˆå…·ä½“ä¸€è‡´æ€§hashè·¯ç”±å¦‚ä½•å®ç°ï¼Œå¯ä»¥å‚è€ƒåˆ©ç”¨treeMapå®ç°ï¼‰&lt;/p&gt;
&lt;p&gt;â€ƒä»¥ä¸Šæ–¹æ¡ˆç®—æ˜¯è§£å†³æ€§èƒ½é—®é¢˜ï¼Œä½†æ˜¯è¿˜æœ‰æ¯”è¾ƒè‡´å‘½çš„é—®é¢˜ï¼Œå°±æ˜¯æ— æ³•æ¨ªå‘æ‰©å±•ã€‚å°±æ¯”å¦‚è¯´ç°åœ¨æœ‰10å°æœºå™¨ä¸åŒæ•°æ®åº“ï¼Œæ¯ä¸€ä¸ªæ•°æ®åº“ä¸€æ¡è®°å½•ã€‚å‡å¦‚ç°åœ¨æœ‰æ–°çš„æœºå™¨10å°æœºå™¨æƒ³è¦åŠ å…¥åˆ†é…çš„è¯ï¼Œé‚£ä¹ˆå°±è¦ä¿®æ”¹offsetå’Œinitial_idï¼Œæ‰€ä»¥åœ¨ä¸åœæœºå®ç°çš„è¯ï¼Œå¯èƒ½æ— æ³•å®ç°ï¼ˆç›®å‰ç¬”è€…æ²¡æœ‰æƒ³åˆ°æ–¹æ³•è§£å†³ï¼Œå¦‚æœè¯»è€…æœ‰ideaå¯ä»¥æ¬¢è¿å’Œæˆ‘è®¨è®ºï¼‰ã€‚è¿™é‡Œç¬”è€…æä¾›ä¸€ç§æ–¹æ³•å»è§£å†³ï¼š&lt;br&gt;
â€ƒæå‰é¢„å…ˆåˆ†é…100æ¡è®°å½•ï¼Œæ¯ä¸€æ¡è®°å½•ä¸€æ‰¹æ¬¡è·å–100ä¸ªIDï¼Œoffsetè®¾ç½®ä¸º10000ï¼Œå½“å‰10å°æœºå™¨æ¯ä¸€å°æœ‰10æ¡è®°å½•ï¼Œåç»­æœ‰æ–°æœºå™¨çš„è¯ç›´æ¥å°†è®°å½•ä¸åœæœºè½¬ç§»åˆ°æ–°æœºå™¨å°±å¯ä»¥äº†ã€‚&lt;/p&gt;
&lt;h4 id=&#34;22-redisåºåˆ—åŒ–åˆ†å‘&#34;&gt;2.2 Redisåºåˆ—åŒ–åˆ†å‘&lt;/h4&gt;
&lt;p&gt;Redisæ¥ç”ŸæˆIDï¼Œè¿™ä¸»è¦ä¾èµ–äºRedisæ˜¯å•çº¿ç¨‹çš„ï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥ç”¨ç”Ÿæˆå…¨å±€å”¯ä¸€çš„IDã€‚å¯ä»¥ç”¨Redisçš„åŸå­æ“ä½œ INCRå’ŒINCRBYæ¥å®ç°ã€‚ç›®å‰å•å°redisçš„qpsèƒ½å¤Ÿè¾¾åˆ°5Wï¼Œæ‰€ä»¥ä¸€å®šç¨‹åº¦ä¸Šèƒ½å¤Ÿè§£å†³æ€§èƒ½é—®é¢˜ã€‚å…·ä½“å®ç°ç¬”è€…è¿™é‡Œå°±ä¸é˜è¿°äº†ã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶ç”¨è¿™ä¸ªæ–¹æ¡ˆä¹Ÿæœ‰ç¼ºç‚¹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä¾èµ–redisï¼Œå¦‚æœä¸šåŠ¡ä¸­æ²¡æœ‰å°±è¦ä¾èµ–è¿™ä¸ªä¸­é—´ä»¶&lt;/li&gt;
&lt;li&gt;ç”Ÿæˆçš„IDæ˜¯å•è°ƒé€’å¢çš„ï¼Œå®¹æ˜“æš´éœ²ç³»ç»Ÿçš„ç”¨æˆ·æ•°&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;23-snowflakeé›ªèŠ±ç®—æ³•&#34;&gt;2.3 SnowFlakeé›ªèŠ±ç®—æ³•&lt;/h4&gt;
&lt;p&gt;ä»¥ä¸Š2.1 2.2æ–¹æ¡ˆéƒ½èƒ½è§£å†³æ€§èƒ½é—®é¢˜ï¼Œä½†æ˜¯äº§ç”Ÿçš„IDï¼Œæ˜¯è¿ç»­çš„ï¼Œå®¹æ˜“æš´éœ²è‡ªå·±ç³»ç»Ÿä¸­ç”¨æˆ·çš„æ•°é‡ã€‚æ‰€ä»¥æœ‰äº›ç³»ç»Ÿä¼šè¦æ±‚è¦è¶‹åŠ¿é€’å¢ï¼Œè€Œä¸”è¦ä¿æŒä¿¡æ¯å®‰å…¨ã€‚ç›®å‰é›ªèŠ±ç®—æ³•å°±èƒ½è§£å†³è¿™ä¸ªé—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;å…¶ä¸­åŸç†å°±æ˜¯ï¼šç»™ä¸€ä¸ª64ä½çš„äºŒè¿›åˆ¶æ•°å­—ï¼Œå…¶ä¸­&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç¬¬1ä½ç½®ä¸º0ã€‚&lt;/li&gt;
&lt;li&gt;ç¬¬2-42ä½æ˜¯ç›¸å¯¹æ—¶é—´æˆ³ï¼Œé€šè¿‡å½“å‰æ—¶é—´æˆ³å‡å»ä¸€ä¸ªå›ºå®šçš„å†å²æ—¶é—´æˆ³ç”Ÿæˆã€‚&lt;/li&gt;
&lt;li&gt;ç¬¬43-52ä½æ˜¯æœºå™¨å·workerIDï¼Œæ¯ä¸ªServerçš„æœºå™¨IDä¸åŒã€‚&lt;/li&gt;
&lt;li&gt;ç¬¬53-64ä½æ˜¯è‡ªå¢IDã€‚&lt;br&gt;
&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1604663039402.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿™ä¸ªæ–¹æ¡ˆä¹Ÿæœ‰ç¼ºç‚¹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å®ç°æ¯”è¾ƒå¤æ‚ï¼Œè€ƒéªŒå¼€å‘äººå‘˜&lt;/li&gt;
&lt;li&gt;éœ€è¦ç‹¬ç«‹éƒ¨ç½²å®ç°&lt;/li&gt;
&lt;li&gt;å¼ºä¾èµ–æ—¶é’Ÿï¼Œæ—¶é’Ÿå›æ‹¨ä¼šæœ‰é‡å¤çš„ID&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;ä¸‰-å½“å‰æ–¹æ¡ˆæ˜¯å¦‚ä½•åšçš„&#34;&gt;ä¸‰ã€å½“å‰æ–¹æ¡ˆæ˜¯å¦‚ä½•åšçš„&lt;/h3&gt;
&lt;p&gt;â€ƒå‚è€ƒä¸Šè¿°æ–¹æ¡ˆåï¼ŒæŠ€æœ¯å›¢é˜Ÿè€ƒè™‘åˆ°æœªæ¥ä¸šåŠ¡çš„å¢åŠ ï¼Œæµé‡çš„å¢é•¿ä»¥åŠåç»­çš„æ‰©å±•ï¼Œå‡†å¤‡åˆ©ç”¨æ–¹æ¡ˆä¸‰å»å®ç°ã€‚å…¶ä¸­å…·ä½“å®ç°å¯ä»¥å‚è€ƒç¬”è€…GitHubçš„å®ç°ï¼š&lt;a href=&#34;https://github.com/zhangyaoo/fastim/blob/master/fastim-leaf/src/main/java/com/zyblue/fastim/leaf/manager/SnowFlakeManager.java&#34;&gt;åˆ†å¸ƒå¼ID SnowFlakeå®ç°&lt;/a&gt;&lt;br&gt;
â€ƒå½“ç„¶ä½¿ç”¨æ–¹æ¡ˆä¸‰ä¹Ÿä¼šæœ‰ç¼ºé™·ï¼Œæ¯”å¦‚ä¼šå‘ç”Ÿæ—¶é’Ÿå›æ‹¨é—®é¢˜ï¼Œä»¥åŠåˆ†å¸ƒå¼IDåˆ†å‘æœåŠ¡å¼ºä¾èµ–zookeeperã€‚&lt;/p&gt;
&lt;h4 id=&#34;31-æ—¶é’Ÿå›æ‹¨&#34;&gt;3.1 æ—¶é’Ÿå›æ‹¨&lt;/h4&gt;
&lt;p&gt;â€ƒå‘ç”Ÿæ—¶é’Ÿå›æ‹¨çš„åŸå› æ˜¯ï¼Œå¦‚æœåˆ†å‘æœåŠ¡æ­£åœ¨ç”ŸæˆIDçš„è¿‡ç¨‹ä¸­ï¼Œç³»ç»Ÿæ—¶é—´å› ä¸ºä¸å¯æŠ—æ‹’çš„å› ç´ æˆ–è€…äººä¸ºå› ç´ å¯¼è‡´æ—¶é—´å€’æµäº†ï¼Œä¼šå¯¼è‡´å¯èƒ½ä¼šæœ‰é‡å¤çš„IDç”Ÿæˆï¼Œä½œä¸ºåˆ†å¸ƒå¼IDåˆ†å‘è¿™ä¸ªæ˜¯ä¸å‡†å‘ç”Ÿçš„ã€‚æ‰€ä»¥å¦‚æœå‘ç”Ÿæ—¶é’Ÿå›æ‹¨é‚£ä¹ˆå°±æŠ›å‡ºå¼‚å¸¸ï¼Œå®ç°å¦‚ä¸‹&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;long timestamp = System.currentTimeMillis();
// å¦‚æœå½“å‰æ—¶é—´æˆ³å°äºä¸Šæ¬¡åˆ†å‘çš„æ—¶é—´æˆ³
if (timestamp &amp;lt; lastTimestamp) {
    long offset = lastTimestamp - timestamp;
    if (offset &amp;lt;= 5) {
        // å¦‚æœæ—¶é—´æˆ³é—´éš”å°äº5ï¼Œé‚£ä¹ˆè¿›è¡Œç­‰å¾…ï¼Œç­‰å¾…çª—å£æ—¶é—´ï¼Œç„¶åå†è¿›è¡Œé‡è¯•
        try {
            wait(offset &amp;lt;&amp;lt; 1);
            timestamp = System.currentTimeMillis();
            if (timestamp &amp;lt; lastTimestamp) {
                throw new RuntimeException(String.format(&amp;quot;lastTimestamp %s is after reference time %s&amp;quot;, lastTimestamp, timestamp));
            }
        } catch (InterruptedException e) {
            logger.error(&amp;quot;wait interrupted&amp;quot;);
            throw new RuntimeException(String.format(&amp;quot;lastTimestamp %s is after reference time %s&amp;quot;, lastTimestamp, timestamp));
        }
    } else {
        // å¦‚æœç›¸å·®è¿‡å¤§ï¼Œç›´æ¥æŠ›å‡ºå¼‚å¸¸
        throw new RuntimeException(String.format(&amp;quot;lastTimestamp %s is after reference time %s&amp;quot;, lastTimestamp, timestamp));
    }
}
// å¦‚æœç­‰äºï¼Œè¡¨æ˜åŒä¸€æ—¶åˆ»
if (lastTimestamp == timestamp) {
    // å¦‚æœå°äºè®¡æ•°å™¨æœ€å¤§å€¼å°±ï¼Œå¢åŠ 
    if (this.counter &amp;lt; MAX_SEQUENCE) {
        this.counter++;
    } else {
        // è¡¨æ˜åŒä¸€æ—¶åˆ»ï¼ŒåŒä¸€æœºå™¨ä¸‹ï¼Œçš„æ‰€æœ‰è®¡æ•°å™¨éƒ½ç”¨å®Œäº†
        throw new RuntimeException(&amp;quot;Sequence exhausted at &amp;quot; + this.counter);
    }
} else {
    //å¦‚æœæ˜¯æ–°çš„mså¼€å§‹
    counter = 0L;
}
// è®°å½•è¿™ä¸€æ¬¡æ—¶é—´æˆ³ï¼Œç”¨ä½œä¸‹ä¸€æ¬¡æ¯”è¾ƒ
lastTimestamp = timestamp;
// åç»­çš„ç”ŸæˆIDé€»è¾‘
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;32-å¼ºä¾èµ–zookeeper&#34;&gt;3.2 å¼ºä¾èµ–zookeeper&lt;/h4&gt;
&lt;p&gt;ä»¥ä¸Šèƒ½è§£å†³æ—¶é’Ÿå›æ‹¨çš„é—®é¢˜ï¼Œä½†æ˜¯å¼ºä¾èµ–zookeeperæ¥ç”Ÿæˆåˆ†å¸ƒå¼ç¯å¢ƒä¸‹çš„å½“å‰æœºå™¨çš„IDã€‚ç¬”è€…å‚è€ƒdubboçš„è®¾è®¡æ€æƒ³ï¼Œå½“IDåˆ†å‘æœåŠ¡é€šè¿‡ID+ç«¯å£æ³¨å†Œåˆ°zookeeperçš„é€’å¢æŒä¹…èŠ‚ç‚¹åï¼Œè¿”å›çš„èŠ‚ç‚¹ç›´æ¥å­˜å‚¨å†æœ¬åœ°æ–‡ä»¶ä¸­ï¼Œå®ç°é«˜å¯ç”¨ï¼Œå¦‚ä¸‹&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
 * é«˜å¯ç”¨ï¼Œé˜²æ­¢zookeeperæŒ‚äº†ï¼Œæœ¬åœ°æœ¬æœºç”Ÿæ•ˆ
 * å†™å…¥æœ¬åœ°æ–‡ä»¶çš„æ—¶æœºï¼šå½“å‰æœºå™¨è·å–zookeeperçš„æŒä¹…èŠ‚ç‚¹å
 */
private void writeWorkerId2Local(int workerId){
    String path = WORKERID_PATH + File.separator + applicationName + File.separator + &amp;quot;workerId.properties&amp;quot;;
    File file = new File(path);
    if(file.exists() &amp;amp;&amp;amp; file.isFile()){
        try {
            FileUtils.writeStringToFile(file, &amp;quot;workerId=&amp;quot; + workerId, false);
        }catch (Exception e){
            logger.error(&amp;quot;e:&amp;quot;, e);
        }
    }else {
        boolean mkdirs = file.getParentFile().mkdirs();
        if(mkdirs){
            try {
                if (file.createNewFile()) {
                    FileUtils.writeStringToFile(file, &amp;quot;workerId=&amp;quot; + workerId, false);
                    logger.info(&amp;quot;local file cache workerID is {}&amp;quot;, workerId);
                }
            }catch (Exception e){
                logger.error(&amp;quot;e:&amp;quot;, e);
            }
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;å››-é‡‡ç”¨åˆ†å¸ƒå¼idä¸Šçº¿åäº§ç”Ÿçš„bug&#34;&gt;å››ã€é‡‡ç”¨åˆ†å¸ƒå¼IDä¸Šçº¿åäº§ç”Ÿçš„BUG&lt;/h3&gt;
&lt;h4 id=&#34;40-é—®é¢˜åˆ†æ&#34;&gt;4.0 é—®é¢˜åˆ†æ&lt;/h4&gt;
&lt;p&gt;å½“ä¸Šçº¿åˆ†å¸ƒå¼IDåˆ†å‘æœåŠ¡åï¼Œè§‚å¯Ÿæ—¥å¿—ï¼Œå‡ºç°å¤§é‡çš„æŠ¥é”™ï¼Œå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;io.lettuce.core.RedisCommandExecutionException: ERR bit offset is not an integer or out of range
at io.lettuce.core.ExceptionFactory.createExecutionException(ExceptionFactory.java:135) ~[lettuce-core-5.2.1.RELEASE.jar:5.2.1.RELEASE]
at io.lettuce.core.ExceptionFactory.createExecutionException(ExceptionFactory.java:108) ~[lettuce-core-5.2.1.RELEASE.jar:5.2.1.RELEASE]
at io.lettuce.core.protocol.AsyncCommand.completeResult(AsyncCommand.java:120) ~[lettuce-core-5.2.1.RELEASE.jar:5.2.1.RELEASE]
at io.lettuce.core.protocol.AsyncCommand.complete(AsyncCommand.java:111) ~[lettuce-core-5.2.1.RELEASE.jar:5.2.1.RELEASE]
at io.lettuce.core.protocol.CommandHandler.complete(CommandHandler.java:654) ~[lettuce-core-5.2.1.RELEASE.jar:5.2.1.RELEASE]
at io.lettuce.core.protocol.CommandHandler.decode(CommandHandler.java:614) ~[lettuce-core-5.2.1.RELEASE.jar:5.2.1.RELEASE]
â€¦â€¦â€¦â€¦
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¹çœ‹æ˜¯redisçš„æŠ›å‡ºæ¥çš„é”™è¯¯ï¼Œå’Œè¿™æ¬¡åˆ†å¸ƒå¼IDæ”¹é€ æ²¡æœ‰ä»€ä¹ˆå…³ç³»ï¼Œä½†æ˜¯ä»”ç»†é™ä¸‹æ¥æƒ³ä¸€æƒ³ï¼Œè¿™æ¬¡IDæ”¹é€ æ˜¯ä»åŸæ¥çš„æ•°æ®åº“è‡ªå¢æ”¹é€ çš„ï¼Œæ•°æ®åº“è‡ªå¢æ•°æ®ä¸»é”®å¾ˆå°æ˜¯intç±»å‹ï¼Œç„¶åç”¨äº†64ä½äºŒè¿›åˆ¶æ•°æ®å½“ä½œIDåï¼Œå¯¼è‡´redisä¸­ç”¨æˆ·çš„æ•°æ®å­˜ä¸ä¸‹å»ï¼Œç„¶åç¬”è€…å°±æŒ‰ç…§è¿™ä¸ªæ€è·¯å»å‘æ˜é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;ç¬”è€…ä»ä¸šåŠ¡æŠ›å‡ºçš„å †æ ˆä¸­å‘ç°ï¼Œè¿™ä¸ªé”™è¯¯æ˜¯åœ¨åˆ¤æ–­ç”¨æˆ·æ˜¯å¦æ˜¯æ–°ç”¨æˆ·æœåŠ¡æ–¹æ³•ä¸­æŠ›å‡ºçš„ï¼Œè€Œåˆ¤æ–­æ˜¯æ–°ç”¨æˆ·çš„é€»è¾‘å°±æ˜¯ï¼Œåˆ©ç”¨redisçš„bitmapæ¥è§£å†³çš„ï¼šgetbit new_user_key userIdï¼Œå…¶ä¸­ userIdä¸ºç”¨æˆ·IDï¼Œå¦‚æœç”¨æˆ·å‘ç”Ÿäº†äº¤æ˜“ä¿¡æ¯ï¼Œå°±ä¼šæ‰§è¡Œï¼šsetbit new_user_key userId 1 è¿™ä¸ªå‘½ä»¤ã€‚ ä¸ºä»€ä¹ˆè¦ç”¨bitmapè§£å†³å‘¢ï¼Œä¸»è¦æ˜¯å› ä¸ºå¦‚æœä»äº¤æ˜“è®°å½•è¡¨æŸ¥è¯¢æŸä¸ªç”¨æˆ·æ˜¯å¦äº¤æ˜“ä¿¡æ¯æ¥åˆ¤æ–­æ˜¯æ–°ç”¨æˆ·çš„è¯å°±ä¼šéå¸¸è€—æ—¶ï¼Œæ‰€ä»¥åªè¦æ˜¯å‘ç”Ÿäº†äº¤æ˜“ä¿¡æ¯å°±è®¾ç½®bitmapå°±å¯ä»¥äº†ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¸ºä»€ä¹ˆä¼šæŠ›å‡ºout of rangeè¿™ä¸ªé”™è¯¯å‘¢ï¼Œæˆ‘ä»¬çŸ¥é“bitmapåº•å±‚å…¶å®å°±æ˜¯Stringç±»å‹ï¼Œè€ŒStringç±»å‹çš„æœ€å¤§é•¿åº¦ä¸º512Mï¼Œå®˜ç½‘æˆªå›¾ï¼š&lt;br&gt;
&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1605157810715.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
æ‰€ä»¥å¦‚æœoffsetè¶…è¿‡512Mè¿™ä¸ªèŒƒå›´é‚£ä¹ˆå°±ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œ512M = 2^9 * 2^12 * 2^12 * 2^3 = 2^32 bitï¼Œä¹Ÿå°±æ˜¯æ”¯æŒIntegerç±»å‹çš„æœ€å¤§å€¼ï¼Œè€Œæˆ‘ä»¬è¿™æ¬¡åˆ†å¸ƒå¼IDæœåŠ¡IDæ˜¯64ä½çš„ï¼Œæ”¯æŒ2^64 bitï¼Œæ‰€ä»¥å¦‚æœoffsetä¹Ÿå°±æ˜¯userIdå¤§äº2^32çš„è¯å°±ä¼šæŠ›å‡ºout of rangeå¼‚å¸¸äº†ã€‚&lt;/p&gt;
&lt;h4 id=&#34;41-é—®é¢˜è§£å†³&#34;&gt;4.1 é—®é¢˜è§£å†³&lt;/h4&gt;
&lt;p&gt;æ‰¾åˆ°äº†é—®é¢˜ï¼Œä¹Ÿå°±å¥½å»åšä¼˜åŒ–äº†ï¼Œè¿™é‡Œç¬”è€…æä¾›å‡ ä¸ªæ–¹æ³•ä½œä¸ºå‚è€ƒ&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åœ¨æ•°æ®åº“ç”¨æˆ·è¡¨æˆ–è€…ç”¨æˆ·æ‰©å±•è¡¨ä¸­å¢åŠ ä¸€ä¸ªå­—æ®µï¼Œå¦‚æœå‘ç”Ÿäº†äº¤æ˜“ï¼Œé‚£ä¹ˆå°†å­—æ®µæ ‡è®°ä¸ºè€ç”¨æˆ·&lt;/li&gt;
&lt;li&gt;æŠŠç”¨æˆ·IDæ”¾å…¥redisé›†åˆsetä¸­ï¼Œåˆ©ç”¨SMISMEMBERå‘½ä»¤åˆ¤æ–­å½“å‰ç”¨æˆ·æ˜¯å¦åœ¨é›†åˆå†…ï¼Œå½“ç„¶è¿™ä¸ªä¼šæœ‰æ€§èƒ½é—®é¢˜ï¼Œå…¶æ–¹æ³•æ—¶é—´å¤æ‚åº¦ä½O(N)ï¼Œå®˜æ–¹æˆªå›¾:&lt;br&gt;
&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1605162870590.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;äº”-æ€»ç»“&#34;&gt;äº”ã€æ€»ç»“&lt;/h3&gt;
&lt;p&gt;â€ƒç¬”è€…ä»åˆ†å¸ƒå¼IDé€‰å‹å‡ºå‘ï¼Œä»‹ç»äº†å‡ ç§ä¸šç•Œå‡ ç§æ¯”è¾ƒå¸¸ç”¨çš„ç”Ÿæˆæ–¹æ³•ï¼Œå¹¶ä¸”ä»‹ç»äº†å…¶ä¼˜ç¼ºç‚¹ï¼Œç„¶åç»“åˆå®é™…ä¸šåŠ¡å‡ºå‘ï¼Œé€‰æ‹©åˆé€‚çš„æ–¹æ¡ˆã€‚ç„¶åä»‹ç»äº†ä½¿ç”¨SnowFlakeç®—æ³•å¯¼è‡´çš„ä¸šåŠ¡é—®é¢˜ï¼Œä»¥åŠåˆ†ææœ€åæä¾›è§£æ–¹æ³•ã€‚ä»è¿™æ¬¡è¸©å‘çš„ç»å†æ¥è¯´ï¼Œæˆ‘ä»¬è¦æ‡‚æŠ€æœ¯ä½“ç³»ï¼Œå¹¶ä¸”è¿˜è¦éå¸¸ç†Ÿæ‚‰ä¸šåŠ¡ï¼Œæœ€å¤§ç¨‹åº¦é¿å…åŠŸèƒ½ä¹‹é—´çš„ç›¸äº’çš„å½±å“å¯¼è‡´çš„bugã€‚&lt;/p&gt;
&lt;h3 id=&#34;å…­-å‚è€ƒ&#34;&gt;å…­ã€å‚è€ƒ&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ç¾å›¢åˆ†å¸ƒå¼ç®—æ³•IDå‡ ç§å®ç°æ–¹å¼â€”â€”https://tech.meituan.com/2017/04/21/mt-leaf.html&lt;/li&gt;
&lt;li&gt;SnowFlakeç®—æ³•â€”â€”https://github.com/twitter-archive/snowflake&lt;/li&gt;
&lt;/ul&gt;
">è®°ä¸€æ¬¡ç”¨æˆ·ä¸­å¿ƒé‡‡ç”¨åˆ†å¸ƒå¼IDè¸©çš„å‘</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://zhangyaoo.github.io/post/saas-xi-tong-duo-shu-ju-yuan-lu-you-you-ya-jie-jue-fang-an/"" data-c="
          &lt;h2 id=&#34;èƒŒæ™¯&#34;&gt;èƒŒæ™¯&lt;/h2&gt;
&lt;p&gt;åœ¨ç›®å‰çš„SaaSç³»ç»Ÿä¸­ï¼Œä¸šåŠ¡å¼€å‘è€…éœ€è¦é‡ç‚¹å…³æ³¨çš„ä¸€ä¸ªé—®é¢˜å°±æ˜¯æ•°æ®éš”ç¦»é—®é¢˜ï¼Œè¿™ä¸ªæ˜¯åšSaaSç³»ç»Ÿå¿…é¡»è¦è€ƒè™‘çš„ç‚¹ï¼Œå¤šç§Ÿæˆ·æ•°æ®éš”ç¦»æ˜¯æ¯ä¸ªSaaSç³»ç»Ÿéƒ½è¦é‡åˆ°å¹¶ä¸”è¦è§£å†³çš„é—®é¢˜ï¼Œç¬”è€…å°±åˆ†äº«ä¸‹è§£å†³è¿™ç§é—®é¢˜çš„æ€è·¯ã€å…·ä½“çš„è§£å†³æ–¹æ¡ˆä»¥åŠä¼˜é›…çš„è§£å†³æ€è·¯ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä¸€-è§£å†³æ–¹æ¡ˆä»‹ç»&#34;&gt;ä¸€ã€è§£å†³æ–¹æ¡ˆä»‹ç»&lt;/h2&gt;
&lt;h3 id=&#34;ç›®å‰ä¸šç•Œæ•°æ®éš”ç¦»æ–¹æ¡ˆ&#34;&gt;ç›®å‰ä¸šç•Œæ•°æ®éš”ç¦»æ–¹æ¡ˆ&lt;/h3&gt;
&lt;p&gt;1ã€ç‹¬ç«‹æ•°æ®åº“ï¼Œé€šè¿‡åŠ¨æ€åˆ‡æ¢æ•°æ®æºæ¥å®ç°å¤šç§Ÿæˆ·&lt;br&gt;
2ã€å…±äº«æ•°æ®åº“ï¼Œéš”ç¦»æ•°æ®æ¶æ„&lt;br&gt;
3ã€å…±äº«æ•°æ®åº“ï¼Œå…±äº«æ•°æ®è¡¨ï¼Œä½¿ç”¨å­—æ®µæ¥åŒºåˆ†ä¸åŒç§Ÿæˆ·ï¼Œæ­¤æ–¹æ¡ˆæˆæœ¬æœ€ä½&lt;/p&gt;
&lt;p&gt;ä»¥ä¸Šæ–¹æ¡ˆä»ä¸Šåˆ°ä¸‹ï¼Œå®‰å…¨æ€§é€æ¸é™ä½ã€‚ç”±äºè€ƒè™‘åˆ°å®‰å…¨é—®é¢˜ï¼Œæ•…é‡‡ç”¨ç¬¬ä¸€ç§æ–¹æ¡ˆè§£å†³æ•°æ®éš”ç¦»&lt;br&gt;
ä¼˜ç‚¹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;éå¸¸å®‰å…¨&lt;/li&gt;
&lt;li&gt;æ•°æ®äº’ä¸å½±å“ï¼Œæ€§èƒ½äº’ä¸å½±å“&lt;/li&gt;
&lt;li&gt;æ•°æ®è¿ç§»ï¼Œæ•°æ®æ‰©å±•æ–¹ä¾¿&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ç¼ºç‚¹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;éœ€è¦ç»´æŠ¤å¤§é‡çš„æ•°æ®åº“&lt;/li&gt;
&lt;li&gt;éœ€è¦è‡ªè¡Œåˆ‡æ¢æ•°æ®åº“ï¼Œå¼€å‘é‡å¤šä¸”å®ç°å¤æ‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;å…·ä½“æŠ€æœ¯å®ç°&#34;&gt;å…·ä½“æŠ€æœ¯å®ç°&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;ç®€å•çš„æ¶æ„å›¾&lt;/strong&gt;&lt;br&gt;
&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1603179800053.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
å¦‚å›¾æ‰€ç¤ºï¼ŒSaaSé¡¹ç›®å¤§æ¦‚æ¶æ„å›¾ï¼Œå…³é”®ç‚¹æ˜¯åº”ç”¨å±‚ä¼ å‚ï¼Œä»¥åŠè·¯ç”±å±‚çš„å®ç°ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å®ç°&lt;/strong&gt;&lt;br&gt;
1ã€åº”ç”¨å±‚ï¼šé¡¹ç›®ä¸­åº”ç”¨serviceå±‚æ˜¯dubboæœåŠ¡ï¼Œè€Œä¸”é¡¹ç›®åˆ†å¤šå±‚ï¼Œè¿™é‡Œéœ€è¦è€ƒè™‘åˆ°å¤šå±‚æœåŠ¡åœºæ™¯ä¸‹ï¼Œå¦‚ä½•ä¼˜é›…ä¼ å‚é—®é¢˜ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º&lt;br&gt;
&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1603181882775.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
æˆ‘ä»¬è€ƒè™‘åˆ°ç§Ÿæˆ·IDæ˜¯å”¯ä¸€æ ‡è¯†ï¼Œå’Œä¸šåŠ¡å‚æ•°ç»‘å®šåœ¨ä¸€èµ·ä¸ä¼˜é›…ï¼Œæ‰€ä»¥ä¸¤ç§å‚æ•°åˆ†å¼€å¤„ç†ï¼Œä¸šåŠ¡å‚æ•°ç›´æ¥å‚æ•°é€ä¼ ï¼Œç§Ÿæˆ·IDå”¯ä¸€æ ‡è¯†é€šè¿‡éšå¼ä¼ å‚æ¥å¤„ç†ï¼ˆå‚è€ƒdubbo http://dubbo.apache.org/zh-cn/docs/user/demos/attachment.htmlï¼‰ï¼Œå¹¶ä¸”å‚æ•°è®°å½•åˆ°æœåŠ¡æœ¬åœ°çš„threadlocalä¸­ï¼Œä»¥ä¾¿åç»­å…¶ä»–ä¸šåŠ¡éœ€è¦ã€‚å…·ä½“å®ç°å¦‚ä¸‹ï¼š&lt;br&gt;
&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1603183675071.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;2ã€è·¯ç”±å±‚ï¼šè·¯ç”±å±‚å®ç°ä¸»è¦æ˜¯è‡ªè¡Œå®ç°springæ¡†æ¶ä¸­DataSourceæ¥å£ï¼Œè‡ªå®šä¹‰dynamicDataSourceç±»ï¼Œç„¶åimplement DataSourceæ¥å£ï¼Œå®ç°getConnectionæ–¹æ³•ã€‚ç„¶åé‡æ–°å®šä¹‰SqlSessionFactoryçš„beanï¼Œå°†è‡ªå®šä¹‰DataSourceç±»å±æ€§æ³¨å…¥ã€‚&lt;br&gt;
&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1603183148592.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1603183156251.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ç„¶åæˆ‘ä»¬åªéœ€è¦å…³æ³¨getConnectionæ–¹æ³•æ ¹æ®ç§Ÿæˆ·IDï¼Œé€‰æ‹©ç›¸å¯¹åº”çš„ç§Ÿæˆ·è¿æ¥æ± å°±å¯ä»¥äº†ã€‚&lt;br&gt;
å¦‚å›¾ä¸­ï¼Œæˆ‘ä»¬åªéœ€è¦å®ç°è¿™ä¸ªselectTenantCodeDataSource()è¿™ä¸ªæ–¹æ³•å°±å¯ä»¥äº†ï¼Œè¿™ä¸ªæ–¹æ³•å®ç°å¾ˆç®€å•ï¼Œè¿™é‡Œå°±ä¸è´´å›¾äº†ã€‚selectTenantCodeDataSource()æ–¹æ³•ä¸»è¦å°±æ˜¯ä»threadlocalä¸­æ‹¿ç§Ÿæˆ·IDï¼Œç„¶åå»ç¼“å­˜æ± mapä¸­æ‹¿å‡ºè¿æ¥æ± ä¿¡æ¯ã€‚&lt;br&gt;
&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1603183509071.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
å…¶ä¸­ï¼ŒdataSourceCachePoolæ˜¯åœ¨åˆå§‹åŒ–é…ç½®æ—¶å€™ï¼Œå°†æ‰€æœ‰çš„ç§Ÿæˆ·è¿æ¥æ± ç›´æ¥åˆ›å»ºï¼Œç„¶åæ‰”åˆ°dataSourceCachePoolã€‚keyæ˜¯ç§Ÿæˆ·çš„IDï¼Œvalueæ˜¯è¿æ¥æ± ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;p&gt;å…·ä½“çš„åˆå§‹åŒ–é…ç½®ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
 * åˆå§‹åŒ–æ•°æ®æº
 */
@Configuration
public class DataSourceInit {
    
    @PostConstruct
    public void InitDataSource()  {
        log.info(&amp;quot;=====åˆå§‹åŒ–æ•°æ®æº=====&amp;quot;);
        TenantRoutingDataSource tenantRoutingDataSource = (TenantRoutingDataSource)ApplicationContextProvider.getBean(&amp;quot;tenantRoutingDataSource&amp;quot;);
        Map&amp;lt;String, DataSourceCache&amp;gt; dataSourceCachePool = new HashMap&amp;lt;&amp;gt;();

        List&amp;lt;TenantInfo&amp;gt; tenantList = tenantInfoService.InitTenantInfo();
        for (TenantInfo tenantInfo : tenantList) {
            log.info(tenantInfo.toString());
            HikariDataSource dataSource = new HikariDataSource();
            dataSource.setDriverClassName(tenantInfo.getDatasourceDriver());
            dataSource.setJdbcUrl(tenantInfo.getDatasourceUrl());
            dataSource.setUsername(tenantInfo.getDatasourceUsername());
            dataSource.setPassword(tenantInfo.getDatasourcePassword());
            dataSource.setDataSourceProperties(master.getDataSourceProperties());
            dataSourceCachePool.put(tenantInfo.getTenantId(), dataSource);
        }
        //è®¾ç½®æ•°æ®æº
        tenantRoutingDataSource.setDataSources(dataSourceCachePool);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;äºŒ-æ–¹æ¡ˆçš„éšè—ç¼ºç‚¹ä»¥åŠè§£å†³&#34;&gt;äºŒã€æ–¹æ¡ˆçš„éšè—ç¼ºç‚¹ä»¥åŠè§£å†³&lt;/h2&gt;
&lt;h3 id=&#34;éšè—çš„ç¼ºé™·&#34;&gt;éšè—çš„ç¼ºé™·&lt;/h3&gt;
&lt;p&gt;ç›¸ä¿¡æœ‰ä¸€å®šå¼€å‘ç»éªŒçš„è¯»è€…åº”è¯¥èƒ½æƒ³åˆ°ï¼Œä¸Šè¿°æ–¹æ¡ˆæœ€å¤§çš„ç¼ºç‚¹å°±æ˜¯æ€§èƒ½é—®é¢˜ï¼Œå¯¹MySQLæœ‰éå¸¸å¤§çš„å½±å“ã€‚å› ä¸ºä¸€å¼€å§‹åˆå§‹åŒ–éå¸¸å¤šçš„è¿æ¥æ± ï¼Œå°±ä¼šå ç”¨è¿æ¥èµ„æºï¼Œæ¯”å¦‚ç§Ÿæˆ·ä»100ä¸ªæ‰©å±•åˆ°äº†1000ä¸ªä»¥åŠæ›´å¤šï¼Œé‚£ä¹ˆè¿æ¥æ± æ•°é‡å°±çº¿æ€§å¢é•¿ï¼Œå¦‚æœä¸€ä¸ªè¿æ¥æ± ä¿æŒ15ä¸ªæ´»è·ƒè¿æ¥çš„è¯ï¼Œé‚£ä¹ˆè¿æ¥æ•°å°±æ˜¯15*1000ï¼Œæ­¤æ—¶å¦‚æœMySQLçš„maxconntionçš„æ•°é‡éå¸¸å°ï¼Œé‚£ä¹ˆMySQLä¾§å°±ä¼šæŠ›å‡ºâ€too many connctionsâ€œé”™è¯¯ï¼Œåœ¨åº”ç”¨å±‚æ–¹é¢å°±æ˜¯MySQLä¸å¯ç”¨äº†ã€‚&lt;br&gt;
æ²¡ä¼˜åŒ–ä¹‹å‰çš„æ¶æ„ï¼š&lt;br&gt;
&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1603190851131.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;è§£å†³&#34;&gt;è§£å†³&lt;/h3&gt;
&lt;p&gt;æƒ³ä¿æŒæ•°æ®åº“åˆ†ç¦»ï¼Œåˆè¦è€ƒè™‘åˆ°MySQLæ€§èƒ½é—®é¢˜ï¼Œåªèƒ½å‘è¿æ¥æ± ä¼˜åŒ–çš„æ–¹å‘å»è€ƒè™‘ï¼Œå…¶å®å¯ä»¥å‡å°‘æ•°é‡å°±å¯ä»¥äº†ï¼Œè¿™é‡Œå®ç°æ–¹æ¡ˆå°±æ˜¯ä¸€ä¸ªæ•°æ®åº“å®ä¾‹ä¸€ä¸ªè¿æ¥æ± ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;br&gt;
&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1603190889253.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
å…·ä½“å®ç°å°±æ˜¯å°†ä¸Šè¿°æ–¹æ¡ˆä¸­çš„dataSourceCachePoolçš„keyæ”¹ä¸º â€œIP+ç«¯å£â€ï¼Œä½œä¸ºkeyã€‚ç„¶åå†æ•°æ®æºè·¯ç”±å±‚ï¼Œå¤šä¸€å±‚æ˜ å°„ï¼ˆç§Ÿæˆ·IDâ€”â€”&amp;gt;æ•°æ®åº“å®ä¾‹ï¼‰å°±å¯ä»¥äº†ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä¸‰-æ›´ä¼˜é›…æ–¹æ¡ˆè§£å†³ä¼ä¸šå†…éƒ¨å¼€å‘ç—›ç‚¹&#34;&gt;ä¸‰ã€æ›´ä¼˜é›…æ–¹æ¡ˆè§£å†³ä¼ä¸šå†…éƒ¨å¼€å‘ç—›ç‚¹&lt;/h2&gt;
&lt;h3 id=&#34;ç°çŠ¶&#34;&gt;ç°çŠ¶&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;ç°çŠ¶&lt;/strong&gt;ï¼šä¼ä¸šå†…éƒ¨é¡¹ç›®ç»„å¼€å‘æ•°æ®æºè·¯ç”±ï¼Œå„ä¸ªäººå‘˜å¼€å‘æ°´å¹³ä¸ä¸€ï¼Œå„ç§è·¯ç”±æ–¹æ¡ˆå®ç°ä¸åŒï¼Œè‡ªå·±ç»„å†…çš„å¼€å‘çš„æ–¹æ¡ˆåªèƒ½è‡ªå·±ç»„å†…ä½¿ç”¨ï¼Œå¹¶ä¸”å®ç°å¤æ‚ï¼Œè€—äººåŠ›ç‰©åŠ›ã€‚&lt;br&gt;
&lt;strong&gt;ç›®æ ‡&lt;/strong&gt;ï¼šé¡¹ç›®ç»„ä½¿ç”¨ç›´æ¥å¼•å…¥mavenåŒ…ï¼Œä»»ä½•é…ç½®éƒ½ä¸è¦é…ç½®ï¼ˆè‡ªå®šä¹‰çš„è¯éœ€è¦è‡ªè¡Œåœ¨è‡ªå·±é¡¹ç›®ä¸­é…ç½®å±æ€§ï¼‰ï¼Œå¼€ç®±å³ç”¨ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å…·ä½“å®ç°&#34;&gt;å…·ä½“å®ç°&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;ï¼šç›´æ¥é‡‡ç”¨springboot starterå¼€å‘ï¼Œå°†ä¸Šè¿°æ–¹æ¡ˆæ‰€æœ‰çš„é€»è¾‘å’ŒæŠ€æœ¯å®ç°å•ç‹¬æ”¾å…¥springboot starterå·¥ç¨‹ä¸­ï¼Œé‡‡ç”¨å¤–éƒ¨é…ç½®çš„æ–¹å¼å®ç°è‡ªå®šä¹‰é…ç½®ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å¼€å‘è€…å®ç°&lt;/strong&gt;ï¼šç½‘ä¸Šæœ‰è®¸å¤šspringboot starterå¼€å‘çš„æµç¨‹å’Œå¼€å‘æ¡ˆä¾‹ï¼Œç¬”è€…è¿™é‡Œå°±åªè´´å‡ºå…³é”®çš„ä»£ç &lt;br&gt;
1ã€è‡ªåŠ¨è£…é…ç±»ï¼šspring.factoriesä¸­å†™å…¥è¿™ä¸ªç±»DataSourceAutoConfigureï¼Œå®ç°beançš„è‡ªåŠ¨è£…å…¥ï¼Œç±»é‡Œé¢ä¸»è¦æ˜¯å®ç°SqlSessionFactoryå’ŒPlatformTransactionManagerï¼Œç„¶ååœ¨TenantRoutingDataSourceçš„getconnectionæ–¹æ³•ä¸­è‡ªå®šä¹‰å®ç°è·¯ç”±é€»è¾‘ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Configuration
public class DataSourceAutoConfigure {

    @Resource
    private TenantRoutingDataSource tenantRoutingDataSource;

    @Bean
    @ConditionalOnMissingBean(SqlSessionFactory.class)
    @ConditionalOnBean(TenantRoutingDataSource.class)
    public SqlSessionFactory sqlSessionFactory() throws Exception{
        SqlSessionFactoryBean sqlSessionFactoryBean = new SqlSessionFactoryBean();
        sqlSessionFactoryBean.setDataSource(tenantRoutingDataSource);
        Objects.requireNonNull(sqlSessionFactoryBean.getObject()).getConfiguration().setMapUnderscoreToCamelCase(true);
        return sqlSessionFactoryBean.getObject();
    }

    @Bean
    @ConditionalOnMissingBean(PlatformTransactionManager.class)
    @ConditionalOnBean(TenantRoutingDataSource.class)
    public PlatformTransactionManager platformTransactionManager() {
        return new DataSourceTransactionManager(tenantRoutingDataSource);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;2ã€Java SPIæœºåˆ¶ï¼šåˆ©ç”¨Javaspi æ¥è·å–ç”¨æˆ·è‡ªå®šä¹‰çš„mybatis pluginã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œä¸ç”¨æ¯æ¬¡å¢åŠ ä¸€ä¸ªpluginï¼Œå°±æ”¹åŠ¨æ•°æ®è·¯ç”±ç»„ä»¶çš„ä»£ç ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public SqlSessionFactory sqlSessionFactory(@Qualifier(&amp;quot;tenantRoutingDataSource&amp;quot;) TenantRoutingDataSource tenantRoutingDataSource) throws Exception{
        SqlSessionFactoryBean sqlSessionFactoryBean = new SqlSessionFactoryBean();
        sqlSessionFactoryBean.setDataSource(tenantRoutingDataSource);
        Interceptor[] plugins = loadMybatisPlugin();
        if(plugins.length &amp;gt; 0){
            sqlSessionFactoryBean.setPlugins(plugins);
        }
        Objects.requireNonNull(sqlSessionFactoryBean.getObject()).getConfiguration().setMapUnderscoreToCamelCase(true);
        return sqlSessionFactoryBean.getObject();
    }

    // SPIæœºåˆ¶è·å–æ’ä»¶
    private Interceptor[] loadMybatisPlugin(){
        List&amp;lt;Interceptor&amp;gt; interceptors = new ArrayList&amp;lt;&amp;gt;();
        ServiceLoader&amp;lt;Interceptor&amp;gt; load = ServiceLoader.load(Interceptor.class);
        load.forEach(interceptors::add);
        return interceptors.toArray(new Interceptor[0]);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;3ã€dubbo filteræ‰©å±•æ¥å£ï¼šè·å–ç§Ÿæˆ·IDï¼Œå¹¶ä¸”éœ€è¦åŠ @Activateæ³¨è§£ï¼Œè¿™æ ·dubboåœ¨åˆå§‹åŒ–filteré“¾çš„æ—¶å€™ï¼Œè‡ªåŠ¨å°†è¿™ä¸ªfilteræ³¨å†Œåˆ°filteré“¾ä¸­ï¼Œè¿™æ ·åšçš„å¥½å¤„å°±æ˜¯ï¼Œç”¨æˆ·åœ¨è‡ªå·±å·¥ç¨‹ä¸­ä¸éœ€è¦é…ç½®filterè¿™ä¸ªå‚æ•°ï¼Œæ— éœ€å¢åŠ ä»»ä½•çš„é…ç½®ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Activate(group = {&amp;quot;provider&amp;quot;})
public class TenantCodeContextFilter implements Filter {
    @Override
    public Result invoke(Invoker&amp;lt;?&amp;gt; invoker, Invocation invocation) throws RpcException {
        String tenantCode = RpcContext.getContext().getAttachment(&amp;quot;tenantCode&amp;quot;);
        TenantCodeContextHolder.setTenantCode(tenantCode);
        return invoker.invoke(invocation);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;4ã€æ£€æŸ¥ç”¨æˆ·ä¾§è‡ªå®šä¹‰é…ç½®æ˜¯å¦æ­£ç¡®ï¼šæ£€æŸ¥ç”¨æˆ·çš„é…ç½®æ˜¯å¦åˆç†ï¼Œä¸åˆç†çš„è¯å†å®¹å™¨å°±ç»ªé˜¶æ®µå°±ä¼šæŠ›å‡ºå¼‚å¸¸&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Component
public class CheckConfigListener implements ApplicationListener&amp;lt;ApplicationReadyEvent&amp;gt; {

    @Override
    public void onApplicationEvent(ApplicationReadyEvent applicationReadyEvent) {
        ConfigurableApplicationContext applicationContext = applicationReadyEvent.getApplicationContext();
        ConfigurableEnvironment environment = applicationContext.getEnvironment();
        // æ£€æŸ¥ç”¨æˆ·è‡ªå®šä¹‰é…ç½®æ˜¯å¦æ­£ç¡®ï¼Œè‡ªè¡Œå®ç°
        checkDatasourceConfig(environment);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;5ã€åˆ©ç”¨ç¼“å­˜æ± ä¿å­˜å¤šä¸ªdataSourceå¯¹è±¡ï¼Œä¸€ä¸ªMySQLå®ä¾‹å¯¹åº”ä¸€ä¸ªdataSourceå¯¹è±¡ï¼Œä¸€ä¸ªdataSourceå¯¹åº”å¤šä¸ªç§Ÿæˆ·ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªdataSourceå¯¹åº”ä¸€ä¸ªç§Ÿæˆ·ï¼Œè¿™æ ·çš„å¥½å¤„å°±æ˜¯ï¼Œå¦‚æœä¸€ä¸ªMySQLå®ä¾‹é‡Œé¢çš„ç§Ÿæˆ·æ•°æ®åº“è¿‡å¤šï¼Œä¸ä¼šå¯¼è‡´ä¸€ä¸ªMySQLå®ä¾‹è¿æ¥æ•°è†¨èƒ€é—®é¢˜ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;    /**
     * æ•°æ®æºç¼“å­˜æ± 
     * Key ä¸€ä¸ªMySQLæ•°æ®åº“è¿æ¥ä¿¡æ¯key
     * Value ç¼“å­˜æ—¶RDSè¿æ¥ä¿¡æ¯ä¸DataSource
     */
    private final Map&amp;lt;String, DataSourceCache&amp;gt; dataSourceCachePool = new ConcurrentHashMap&amp;lt;&amp;gt;();
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;ç”¨æˆ·ä½¿ç”¨&lt;/strong&gt;ï¼šç›´æ¥å¼•å…¥ç›¸åº”çš„mavenï¼Œæ–¹ä¾¿å¿«æ·&lt;/p&gt;
&lt;h2 id=&#34;å››-todoåç»­ä¼˜åŒ–&#34;&gt;å››ã€TODOåç»­ä¼˜åŒ–&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;ç›®å‰å¤šç§Ÿæˆ·æ•°æ®æºé€šç”¨å·¥ç¨‹åªæ”¯æŒDubboçš„è°ƒç”¨ï¼Œæœªæ¥å¯æ‰©å±•æ”¯æŒå¤šç§åè®®å¦‚HTTPã€gRPC&lt;/li&gt;
&lt;li&gt;ç›®å‰åªæ”¯æŒHikariæ•°æ®æºï¼Œåç»­æ”¯æŒå¤šç§æ•°æ®æºç±»å‹ï¼Œæ¯”å¦‚Durid&lt;/li&gt;
&lt;li&gt;å¦‚æœç§Ÿæˆ·æ•°æ®éå¸¸å¤§ï¼Œå¯ä»¥è€ƒè™‘ç©ºé—´æ¢æ—¶é—´æ€æƒ³ï¼Œä½¿ç”¨ç¼“å­˜å­˜æ”¾ç§Ÿæˆ·çš„æ•°æ®æºé…ç½®ï¼Œæå‡æŸ¥è¯¢æ•ˆç‡ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;å‚è€ƒ&#34;&gt;å‚è€ƒ&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;SaaSç³»ç»Ÿæ•°æ®éš”ç¦»æ–¹æ¡ˆâ€”â€”https://blog.arkency.com/comparison-of-approaches-to-multitenancy-in-rails-apps/&lt;/li&gt;
&lt;/ul&gt;
">SaaSç³»ç»Ÿå¤šæ•°æ®æºè·¯ç”±ä¼˜é›…è§£å†³æ–¹æ¡ˆ</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://zhangyaoo.github.io/post/mysql-lian-he-suo-yin-zai-bshu-de-cun-chu-he-cha-zhao/"" data-c="
          &lt;h2 id=&#34;å‰è¨€&#34;&gt;å‰è¨€&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;åœ¨å¯¹MySQLå¼€å‘ä¸­ï¼Œè”åˆç´¢å¼•æ˜¯å¾ˆå¸¸è§çš„ä¸€ç§MySQLä¼˜åŒ–æ–¹å¼ï¼Œæœ¬æ–‡è§£é‡Šäº†è”åˆç´¢å¼•çš„å­˜å‚¨ä»¥åŠæŸ¥æ‰¾è¿‡ç¨‹ï¼Œå¯ä»¥äº†è§£ä¸€ä¸‹åº•å±‚çš„åŸç†ä»¥åŠåŠ æ·±å¯¹MySQLè”åˆç´¢å¼•çš„ç†è§£ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;innodb-bæ ‘&#34;&gt;Innodb B+æ ‘&lt;/h2&gt;
&lt;p&gt;å…ˆçœ‹ä¸€ä¸‹Innodb B+æ ‘çš„ä¸»é”®ç´¢å¼•å’Œè¾…åŠ©ç´¢å¼•ã€‚è¿™é‡Œç›´æ¥æ‹¿å¼ æ´‹å¤§ç¥çš„å›¾ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;èšç°‡ç´¢å¼•:&lt;br&gt;
&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1593425796639.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/li&gt;
&lt;li&gt;è¾…åŠ©éèšç°‡ç´¢å¼•:&lt;br&gt;
&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1593425801180.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;strong&gt;ç»“æ„&lt;/strong&gt;ï¼šå½“ä¸€ä¸ªè¡¨Tï¼ˆid,name,age,sex,highï¼‰å»ºä¸€ä¸ªæ™®é€šç´¢å¼•  KEY(name)ï¼Œnameçš„ç´¢å¼•ç»“æœå°±å’Œä¸Šé¢è¾…åŠ©éèšç°‡ç´¢å¼•ç»“æ„ä¸€æ ·ã€‚&lt;br&gt;
&lt;strong&gt;æŸ¥è¯¢&lt;/strong&gt;ï¼šå½“æœ‰ä¸€ä¸ªselect id,name,age from T where name = &amp;quot;&amp;quot; è¾…åŠ©ç´¢å¼•ä¼šæ ¹æ®nameåœ¨B+æ ‘ä¸Šè¿›è¡ŒäºŒå‰æ ‘æŸ¥æ‰¾ï¼Œæ‰¾å‡ºå¶å­èŠ‚ç‚¹æ•°æ®åå‘ç°æ²¡æœ‰ageè¿™ä¸ªæ•°æ®ï¼Œå°±ä¼šè¿›è¡Œ&lt;strong&gt;å›è¡¨&lt;/strong&gt;æ“ä½œåˆ°ä¸»é”®èšç°‡ç´¢å¼•å»æŸ¥æ‰¾ï¼Œæ‹¿åˆ°èšç°‡ç´¢å¼•å¶å­èŠ‚ç‚¹çš„ageæ•°æ®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;è”åˆç´¢å¼•å­˜å‚¨ä»¥åŠå¯»å€&#34;&gt;è”åˆç´¢å¼•å­˜å‚¨ä»¥åŠå¯»å€&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç´¢å¼•ç»“æ„&lt;/strong&gt;ï¼šæˆ‘ä»¬çŸ¥é“ä¸Šè¿°å›è¡¨è¿‡ç¨‹ä¹Ÿä¼šæ¶ˆè€—æ€§èƒ½ï¼Œç›¸å½“äºå¤šæŸ¥ä¸€æ¬¡ï¼Œæ‰€ä»¥ç³»ç»Ÿå¯ä»¥æ ¹æ®ä¸šåŠ¡æƒ…å†µåŠ ä¸Šä¸€ä¸ªç»„åˆç´¢å¼•ï¼Œå½“ç„¶å¹¶ä¸æ˜¯ä¸€ç›´åŠ ç»„åˆç´¢å¼•å°±å¯ä»¥äº†ï¼Œå› ä¸ºè¦è€ƒè™‘åˆ°ç´¢å¼•å­˜å‚¨ç©ºé—´çš„é—®é¢˜ã€‚ä¾‹å¦‚ç»™ä¸Šè¿°åŠ ä¸Šä¸€ä¸ªç»„åˆç´¢å¼•  KEYï¼ˆname,age,sexï¼‰ã€ KEYï¼ˆcol1,col2,col3ï¼‰ã€‘ã€‚é‚£ä¹ˆè¿™ä¸ªç»„åˆç´¢å¼•çš„B+æ ‘éå¶å­èŠ‚ç‚¹æ•°æ®ç»“æ„å’Œä¸Šè¿°è¾…åŠ©éèšç°‡ç´¢å¼•å›¾ä¸€æ ·ï¼Œä½†æ˜¯å¶å­èŠ‚ç‚¹æ˜¯è¿™æ ·çš„ï¼š&lt;br&gt;
&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1593425790647.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
å¶å­èŠ‚ç‚¹å­˜å‚¨col1,col2,col3è¿™ä¸‰åˆ—æ•°æ®ä»¥åŠåŠ ä¸ŠIDè¿™ä¸€åˆ—æ•°æ®ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¯»å€è¿‡ç¨‹ï¼š&lt;/strong&gt;&lt;br&gt;
ä¾‹å¦‚è¯­å¥ï¼šselect * from T where name = &amp;quot;å¼ ä¸‰&amp;quot; and age=25ï¼Œå…ˆæ ¹æ®nameå­—æ®µä»è¾…åŠ©èšç°‡ç´¢å¼•å®šä½åˆ°å“ªä¸€ä¸ªå¶å­èŠ‚ç‚¹æ•°æ®ä¸­ï¼Œç„¶åæ ¹æ®ageèŠ‚ç‚¹åœ¨ä¸Šè¿°è¡¨æ ¼çš„å‰6è¡Œä¸­ï¼Œå¯»æ‰¾age= 25çš„æ•°æ®ï¼Œç„¶åæ‰¾å‡ºæ‰€æœ‰ç¬¦åˆçš„æ•°æ®ä»¥åŠå…¶å¯¹åº”çš„IDï¼Œç„¶åæ ¹æ®IDæ¥è¿›è¡Œå›è¡¨æ“ä½œæŸ¥è¯¢ã€‚è¿™é‡Œè¿”å›äº†ä¸‰æ¡æ•°æ®ï¼Œå°±å›äº†ä¸‰æ¬¡è¡¨ã€‚&lt;br&gt;
ä¸Šè¿°å›è¡¨è¿‡ç¨‹ä¸­ï¼Œç¬”è€…å¼•å…¥ä¸€ä¸ª&lt;strong&gt;ç´¢å¼•ä¸‹æ¨&lt;/strong&gt;çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œç´¢å¼•ä¸‹æ¨æ˜¯MySQLåœ¨5.6ç‰ˆæœ¬åå¼•å…¥çš„ä¸€ä¸ªæŸ¥è¯¢ä¼˜åŒ–ã€‚å°±æ‹¿ä¸Šè¿°çš„ä¾‹å­ï¼Œåœ¨æ²¡æœ‰ä¼˜åŒ–ä¹‹å‰ï¼Œæ®nameå­—æ®µæŸ¥è¯¢â€œå¼ ä¸‰â€åï¼Œä¼šæ‹¿åˆ°6æ¡ç»“æœï¼Œå›è¡¨6æ¬¡ï¼Œç„¶åä»ä¸»é”®ç´¢å¼•æ‹¿åˆ°6æ¡æ•°æ®åï¼Œæ ¹æ®ageå­—æ®µç­›é€‰æ•°æ®ï¼›ä¼˜åŒ–ä¹‹åï¼Œå…ˆå†è¾…åŠ©ç´¢å¼•ä¸Šé¢æ ¹æ®nameå­—æ®µå’Œageå­—æ®µç­›é€‰ç¬¦åˆæ•°æ®ï¼Œä¹Ÿå°±æ˜¯IDï¼Œç„¶åå†å›è¡¨ï¼Œè¿™é‡Œå›è¡¨äº†ä¸‰æ¬¡ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç»„åˆç´¢å¼•æ³¨æ„äº‹é¡¹&lt;/strong&gt;&lt;br&gt;
å½“ç„¶ï¼Œè”åˆç´¢å¼•çš„æœ€é‡è¦çš„æ˜¯æ³¨æ„è”åˆç´¢å¼•çš„ä½¿ç”¨é—®é¢˜ï¼Œè¦éµå¾ªæœ€å·¦åŒ¹é…åŸåˆ™ï¼Œæ‰å¯ä»¥ä¼˜åŒ–åˆ°æ•´ä¸ªSQLäº†ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h3&gt;
&lt;p&gt;ä»¥ä¸Šï¼Œæ€»ç»“äº†MySQLçš„ç´¢å¼•çš„åŸºæœ¬åŸç†ï¼Œä»¥åŠè”åˆç´¢å¼•çš„å­˜å‚¨å’Œå¯»å€è¿‡ç¨‹ï¼Œå¹¶ä¸”å¼•å…¥ç´¢å¼•ä¸‹æ¨æ¦‚å¿µï¼Œè¿˜æœ‰ä½¿ç”¨è”åˆç´¢å¼•çš„æ³¨æ„äº‹é¡¹ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å‚è€ƒ&#34;&gt;å‚è€ƒ&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;MySQLç´¢å¼•èƒŒåçš„æ•°æ®ç»“æ„åŠç®—æ³•åŸç†â€”â€”http://blog.codinglabs.org/articles/theory-of-mysql-index.htmlã€‚&lt;/li&gt;
&lt;/ul&gt;
">MySQLè”åˆç´¢å¼•åœ¨B+æ ‘çš„å­˜å‚¨å’ŒæŸ¥æ‰¾</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://zhangyaoo.github.io/post/guan-yu-zookeeper-qi-shu-jie-dian-yi-ji-nao-lie-wen-ti/"" data-c="
          &lt;h3 id=&#34;å‰è¨€&#34;&gt;å‰è¨€&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;Zookeeperä½œä¸ºå¾®æœåŠ¡åˆ†å¸ƒå¼åè°ƒä¸­é—´ä»¶ï¼Œäº†è§£å®ƒçš„åŸç†ä»¥åŠæ—¥å¸¸å¼€å‘ä¸­çš„æ³¨æ„äº‹é¡¹å’Œå¯èƒ½ä¼šå‡ºç°çš„é—®é¢˜æ˜¯æœ‰å¿…è¦çš„ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;å‰ç½®çŸ¥è¯†zabåè®®&#34;&gt;å‰ç½®çŸ¥è¯†ï¼šZABåè®®&lt;/h3&gt;
&lt;p&gt;ZABï¼šZookeeper Atomic Broadcastï¼ˆZABï¼‰å´©åæ¢å¤å’ŒåŸå­å¹¿æ’­åè®®&lt;br&gt;
1ï¼‰å´©åæ¢å¤ï¼šåœ¨masterèŠ‚ç‚¹å®•æœºæƒ…å†µä¸‹ï¼Œå…¶ä»–é›†ç¾¤èŠ‚ç‚¹ä¼šé‡æ–°é€‰ä¸¾masterèŠ‚ç‚¹ï¼Œå¿«é€Ÿé¢†å¯¼è€…é€‰ä¸¾æœºåˆ¶ï¼šé€‰ä¸¾è§„åˆ™ä¼šå‚ç…§æœ€å¤§çš„åˆ†ä»£å¹´é¾„epoch&amp;gt;æœ€å¤§çš„äº‹åŠ¡zxid&amp;gt;server idæ¥è¿›è¡Œé€‰ä¸¾ï¼Œé€‰ä¸¾è¿‡ç¨‹å°±æ˜¯å°†è‡ªå·±èŠ‚ç‚¹æŠ•ç¥¨ä¿¡æ¯å‘ç»™å…¶ä»–é›†ç¾¤èŠ‚ç‚¹ï¼ŒæŠ•ç¥¨ä¿¡æ¯é™„å¸¦zxidå’Œserveridï¼Œ&lt;strong&gt;åˆ¤æ–­æ˜¯å¦è¶…è¿‡ä¸€åŠçš„æŠ•ç¥¨é€‰åŒä¸€ä¸ªèŠ‚ç‚¹&lt;/strong&gt;ï¼Œé‚£ä¹ˆè¿™ä¸ªèŠ‚ç‚¹å°±ä¼šé€‰ä¸¾ä¸ºmasterã€‚&lt;br&gt;
2ï¼‰é€‰ä¸¾å®Œåï¼Œå°±ä¼šè¿›è¡Œæ•°æ®åŒæ­¥ï¼Œå°†masterèŠ‚ç‚¹æ•°æ®åŒæ­¥åˆ°slaveä¸­ï¼Œæ­¤æ—¶å¯¹å¤–æœåŠ¡ä¸å¯ç”¨ã€‚&lt;br&gt;
3ï¼‰åŸå­å¹¿æ’­ï¼šZABåè®®ä¿è¯æ¶ˆæ¯çš„ä¸€è‡´æ€§å’Œæœ‰åºæ€§&lt;br&gt;
â€ƒä¸€è‡´æ€§ï¼šleaderå‘é€propasaläº‹åŠ¡è¯·æ±‚ï¼ˆåŒ…å«zxidï¼‰ï¼Œmasteråˆ¤æ–­è¿‡åŠæœºåˆ¶ackï¼Œå°±è®¤ä¸ºäº‹åŠ¡å¯ä»¥æäº¤äº†ï¼Œmasterä¼šæäº¤äº‹åŠ¡ï¼Œç„¶åå¹¿æ’­æäº¤äº‹åŠ¡æ¶ˆæ¯ï¼Œä»èŠ‚ç‚¹å¼€å§‹æäº¤æœ¬äº‹åŠ¡ã€‚ä¸€åŠackæœºåˆ¶ï¼Œå¯ä»¥çœ‹zookeeperæ˜¯CPï¼Œä½†æ˜¯ä¸æ˜¯å¼ºä¸€è‡´æ€§ï¼›ä»èŠ‚ç‚¹æ¥æ”¶propasalåï¼Œä¼šå°†äº‹åŠ¡å†™å…¥ç£ç›˜ã€‚&lt;br&gt;
â€ƒæœ‰åºæ€§ï¼šzxidäº‹åŠ¡idä¿è¯å…¨å±€æœ‰åºæ€§ï¼Œæ¯ä¸€ä¸ªslaveæœåŠ¡å™¨ç»´æŒä¸€ä¸ªFIFOé˜Ÿåˆ—ï¼Œç»´æŒå±€éƒ¨æœ‰åºæ€§ã€‚&lt;/p&gt;
&lt;h3 id=&#34;zookeeperè„‘è£‚&#34;&gt;Zookeeperè„‘è£‚&lt;/h3&gt;
&lt;p&gt;â€ƒZookeeperè„‘è£‚éƒ½æ˜¯å‡ºç°åœ¨é›†ç¾¤ç¯å¢ƒä¸­çš„ã€‚æŒ‡çš„æ˜¯ä¸€ä¸ªé›†ç¾¤ç¯å¢ƒä¸­å‡ºç°äº†å¤šä¸ªmasterèŠ‚ç‚¹ï¼Œå¯¼è‡´ä¸¥é‡æ•°æ®åŒæ­¥å’Œå†™å…¥é—®é¢˜ï¼Œæ•°æ®ä¸ä¸€è‡´ç­‰ç­‰ï¼Œå¦‚æœè¿™ç§æƒ…å†µå‡ºç°åœ¨çº¿ä¸Šåˆ†å¸ƒå¼ç¯å¢ƒä¸‹ï¼Œä¼šå¯¼è‡´æœåŠ¡ä¸å¯ç”¨ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å‡ºç°åŸå› &#34;&gt;å‡ºç°åŸå› &lt;/h3&gt;
&lt;p&gt;â€ƒå¯èƒ½å°±æ˜¯ç½‘ç»œç¯å¢ƒæœ‰é—®é¢˜å¯¼è‡´èŠ‚ç‚¹ä¹‹é—´æ–­å¼€ï¼Œæˆ–è€…èŠ‚ç‚¹å‡æ­»ç­‰ç­‰ï¼Œå¯¼è‡´ä¸€éƒ¨åˆ†slaveèŠ‚ç‚¹ä¼šé‡æ–°è¿›å…¥å´©åæ¢å¤æ¨¡å¼ï¼Œé‡æ–°é€‰ä¸¾æ–°çš„masterèŠ‚ç‚¹ï¼Œç„¶åå¯¹å¤–æä¾›äº‹åŠ¡æœåŠ¡ã€‚ç”±äºå¿ƒè·³è¶…æ—¶ï¼ˆç½‘ç»œåŸå› å¯¼è‡´çš„ï¼‰è®¤ä¸ºæ—§çš„masteræ­»äº†ï¼Œä½†å…¶å®æ—§çš„masterè¿˜å­˜æ´»ç€ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å¦‚ä½•è§£å†³è„‘è£‚&#34;&gt;å¦‚ä½•è§£å†³è„‘è£‚&lt;/h3&gt;
&lt;p&gt;è¿‡åŠæœºåˆ¶ï¼Œå¦‚æœé›†ç¾¤ä¸­æŸä¸ªèŠ‚ç‚¹çš„æŠ•ç¥¨æ•°é‡å¤§äºé›†ç¾¤æœ‰æ•ˆèŠ‚ç‚¹çš„ä¸€åŠï¼Œå°±ä¼šé€‰å‡ºmasterã€‚è¿™é‡Œæ‹¿å‡ºå…³é”®ä»£ç ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;// éªŒè¯æ˜¯å¦ç¬¦åˆè¿‡åŠæœºåˆ¶ï¼Œå¦‚æœç¬¦åˆå°±ä¼šé€‰ä¸¾æ–°çš„masterèŠ‚ç‚¹
public boolean containsQuorum(Set&amp;lt;Long&amp;gt; set){
    // halfæ˜¯åœ¨æ„é€ æ–¹æ³•é‡Œèµ‹å€¼çš„
    // nè¡¨ç¤ºé›†ç¾¤ä¸­zkServerçš„ä¸ªæ•°ï¼ˆå‡†ç¡®çš„è¯´æ˜¯å‚ä¸è€…çš„ä¸ªæ•°ï¼Œå‚ä¸è€…ä¸åŒ…æ‹¬è§‚å¯Ÿè€…èŠ‚ç‚¹ï¼‰
    half = n/2;
    // set.size()è¡¨ç¤ºæŸå°zkServerè·å¾—çš„ç¥¨æ•°
    return (set.size() &amp;gt; half);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç¬”è€…ä»‹ç»å‡ ç§æƒ…å†µï¼Œæ¥è¯´æ˜ä¸€ä¸‹å‡ ç§è„‘è£‚çš„åœºæ™¯&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;æ¯”å¦‚é›†ç¾¤ä¸­æœ‰6ä¸ªèŠ‚ç‚¹ï¼Œä¸€ä¸ªmasterå’Œ5ä¸ªslaveï¼Œåˆ†ä¸¤ä¸ªæœºæˆ¿ï¼Œæ¯ä¸ªæœºæˆ¿åˆ†åˆ«ä¸‰å°ï¼Œå‘ç”Ÿäº†æœºæˆ¿ä¸å¯é€šä¿¡çš„æƒ…å†µï¼Œå¦‚ä¸‹å›¾ï¼š&lt;br&gt;
&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1593419532309.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ç„¶åæœºæˆ¿Bå°±ä¼šäº§ç”Ÿæ–°çš„masterï¼Œå¦‚å›¾&lt;br&gt;
&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1593419550068.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
è¿™ä¸ªæ—¶å€™Zookeeperä¸ºäº†é˜²æ­¢è¿™æ ·çš„æƒ…å†µå‘ç”Ÿï¼Œåˆ©ç”¨äº†&lt;strong&gt;è¿‡åŠæœºåˆ¶&lt;/strong&gt;çš„è¿™ä¸ªç‰¹æ€§ã€‚&lt;br&gt;
ä¸Šå›¾ä¸­ï¼Œæœºæˆ¿BèŠ‚ç‚¹ä¸º3 å°äºé›†ç¾¤æ•°é‡çš„ä¸€åŠï¼Œæ‰€ä»¥ï¼Œæœ€ç»ˆä¸Šé¢å›¾ä¸­æœºæˆ¿Bæ˜¯ä¸ä¼šé€‰ä¸¾å‡ºæ–°çš„masterèŠ‚ç‚¹çš„ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æˆ‘ä»¬å†æ¥çœ‹ä¸€ç§æƒ…å†µï¼šæ¯”å¦‚é›†ç¾¤ä¸­æœ‰5ä¸ªèŠ‚ç‚¹ï¼Œä¸€ä¸ªmasterå’Œ4ä¸ªslaveï¼Œåˆ†ä¸¤ä¸ªæœºæˆ¿ï¼Œå¦‚ä¸‹å›¾ï¼š&lt;br&gt;
&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1593419973725.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
å¦‚æœå‘ç”Ÿäº†æœºæˆ¿ä¸èƒ½é€šä¿¡çš„æƒ…å†µï¼Œé‚£ä¹ˆæœºæˆ¿Bå› ä¸ºèŠ‚ç‚¹æ˜¯2ä¸ªï¼Œæ²¡æœ‰è¶…è¿‡ä¸€åŠï¼Œå°±ä¸ä¼šäº§ç”Ÿå‡ºæ–°çš„masterèŠ‚ç‚¹äº†ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å†æ¥çœ‹æœ€åä¸€ç§æƒ…å†µï¼Œæ¯”å¦‚é›†ç¾¤ä¸­æœ‰5ä¸ªèŠ‚ç‚¹ï¼Œä¸€ä¸ªmasterå’Œ4ä¸ªslaveï¼Œåˆ†ä¸¤ä¸ªæœºæˆ¿ï¼Œä¸åŒçš„æ˜¯masterèŠ‚ç‚¹åœ¨æœºæˆ¿Bï¼Œå¦‚ä¸‹å›¾ï¼š&lt;br&gt;
&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1593420189914.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
å¦‚æœå‘ç”Ÿäº†æœºæˆ¿ä¸èƒ½é€šä¿¡çš„æƒ…å†µï¼Œé‚£ä¹ˆæœºæˆ¿AèŠ‚ç‚¹æ˜¯3ä¸ªï¼Œè¶…è¿‡äº†ä¸€åŠï¼Œå°±ä¼šè¿›å…¥å´©åæ¢å¤æ¨¡å¼äº§ç”Ÿæ–°çš„masterèŠ‚ç‚¹ï¼Œé‚£ä¹ˆæ­¤æ—¶é›†ç¾¤ä¸­å°±ä¼šå‡ºç°ä¸¤ä¸ªmasterèŠ‚ç‚¹äº†ã€‚å¦‚ä¸‹å›¾æ‰€ç¤º&lt;br&gt;
&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1593420219104.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
é‚£ä¹ˆé‡åˆ°è¿™ç§æƒ…å†µZookeeperæ˜¯å¦‚ä½•å¤„ç†çš„ï¼Ÿç­”ï¼šæ—§çš„leaderæ‰€æœ‰çš„å†™è¯·æ±‚åŒæ­¥åˆ°å…¶ä»–followersèŠ‚ç‚¹æ˜¯ä¼šè¢«æ‹’ç»çš„ã€‚å› ä¸ºæ¯å½“æ–°leaderäº§ç”Ÿæ—¶ï¼Œä¼šç”Ÿæˆä¸€ä¸ªepochï¼Œè¿™ä¸ªepochæ˜¯é€’å¢çš„ï¼Œfollowerså¦‚æœç¡®è®¤äº†æ–°çš„leaderå­˜åœ¨ï¼ŒçŸ¥é“å…¶epochï¼Œå°±ä¼šæ‹’ç»epochå°äºç°ä»»leader epochçš„æ‰€æœ‰è¯·æ±‚ã€‚è¿™ä¸ªæ—¶å€™æ—§çš„masterè¿›å…¥æ¢å¤æ¨¡å¼è¿›è¡Œæ•°æ®åŒæ­¥ã€‚&lt;br&gt;
æ‰€ä»¥æŒ‰ç…§ä¸Šé¢çš„æƒ…å†µï¼Œæœºæˆ¿Açš„æ‰€æœ‰followersèŠ‚ç‚¹æ­£å¸¸é€šä¿¡ï¼Œæœºæˆ¿Bçš„æ‰€æœ‰èŠ‚ç‚¹é‡æ–°è¿›å…¥æ¢å¤æ¨¡å¼è¿›è¡Œæ•°æ®åŒæ­¥ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ€»ç»“ï¼šé€šè¿‡Quorumsæœºåˆ¶æ¥é˜²æ­¢è„‘è£‚ï¼Œå½“leaderæŒ‚æ‰ä¹‹åï¼Œå¯ä»¥é‡æ–°é€‰ä¸¾å‡ºæ–°çš„leaderèŠ‚ç‚¹ä½¿æ•´ä¸ªé›†ç¾¤è¾¾æˆä¸€è‡´ï¼›å½“å‡ºç°å‡æ­»ç°è±¡æ—¶ï¼Œé€šè¿‡epochå¤§å°æ¥æ‹’ç»æ—§çš„leaderå‘èµ·çš„è¯·æ±‚ï¼Œå½“å‡ºç°è¿™ç§æƒ…å†µï¼Œæ—§çš„leader è¿›å…¥æ¢å¤æ¨¡å¼è¿›è¡Œæ•°æ®åŒæ­¥ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å¼•å‡ºå¥‡æ•°èŠ‚ç‚¹&#34;&gt;å¼•å‡ºå¥‡æ•°èŠ‚ç‚¹&lt;/h3&gt;
&lt;p&gt;â€ƒçŸ¥æ™“ä»¥ä¸Šåœºæ™¯åï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œ2å°æœºå™¨ä¹Ÿèƒ½é€‰ä¸¾å‡ºmasterï¼Œåªä¸è¿‡åªè¦æœ‰1ä¸ªæ­»äº†zookeeperå°±ä¸èƒ½ç”¨äº†ï¼Œå› ä¸º1æ²¡æœ‰è¿‡åŠã€‚æ‰€ä»¥2ä¸ªzookeeperçš„æ­»äº¡å®¹å¿åº¦ä¸º0ã€‚åŒç†ï¼Œè¦æ˜¯æœ‰3ä¸ªzookeeperï¼Œä¸€ä¸ªæ­»äº†ï¼Œè¿˜å‰©ä¸‹2ä¸ªæ­£å¸¸çš„ï¼Œè¿‡åŠäº†ï¼Œæ‰€ä»¥3ä¸ªzookeeperçš„å®¹å¿åº¦ä¸º1ã€‚å¦‚æœæŒ‰ç…§è¿™æ ·çš„æœºåˆ¶æ¨ç†ï¼Œé‚£ä¹ˆå¾—å‡º2-&amp;gt;0;3-&amp;gt;1;4-&amp;gt;1;5-&amp;gt;2;6-&amp;gt;2  å·¦è¾¹æ˜¯æ•°é‡ï¼Œå³è¾¹æ˜¯å®¹å¿åº¦ï¼Œæ‰€ä»¥2nå’Œ2n-1çš„å®¹å¿åº¦æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥å¯ä»¥å¾—å‡ºï¼Œé›†ç¾¤æ˜¯&lt;strong&gt;å¥‡æ•°ä¸ªèƒ½å¤ŸèŠ‚çœèµ„æº&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;!--ä¸‹é¢çš„å¥‡æ•°èŠ‚ç‚¹çš„ä½œç”¨éœ€è¦ç¡®è®¤ TODO--&gt;
&lt;h3 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h3&gt;
&lt;p&gt;ä»¥ä¸Šï¼Œç¬”è€…æ€»ç»“äº†ZABåè®®ï¼Œåˆ°Zookeeperé˜²æ­¢è„‘è£‚çš„åœºæ™¯ä»¥åŠå¦‚ä½•å¤„ç†ï¼Œä»¥åŠç»“åˆä¾‹å­ï¼ŒZookeeperé›†ç¾¤åœ¨å¥‡æ•°èŠ‚ç‚¹ä¸‹çš„ä½œç”¨ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å‚è€ƒ&#34;&gt;å‚è€ƒ&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ZooKeeperé›†ç¾¤çš„è„‘è£‚é—®é¢˜â€”â€”https://www.cnblogs.com/shoufeng/p/10591526.html&lt;/li&gt;
&lt;/ul&gt;
">å…³äºZookeeperå¥‡æ•°èŠ‚ç‚¹ä»¥åŠè„‘è£‚é—®é¢˜</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://zhangyaoo.github.io/post/jin-rong-ji-ye-wu-xia-fen-bu-shi-shi-wu-bao-zheng-shu-ju-yi-zhi-xing/"" data-c="
          &lt;h2 id=&#34;å‰è¨€&#34;&gt;å‰è¨€&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;éšç€åˆ†å¸ƒå¼æœåŠ¡æ¶æ„çš„æµè¡Œä¸æ™®åŠï¼ŒåŸæ¥åœ¨å•ä½“åº”ç”¨ä¸­æ‰§è¡Œçš„å¤šä¸ªé€»è¾‘æ“ä½œï¼Œç°åœ¨è¢«æ‹†åˆ†æˆäº†å¤šä¸ªæœåŠ¡ä¹‹é—´çš„è¿œç¨‹è°ƒç”¨ã€‚å¾®æœåŠ¡åŒ–åï¼Œéšç€å¸¦æ¥çš„æœåŠ¡ä¹‹é—´çš„åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜ï¼Œå°¤å…¶æ˜¯åœ¨é‡‘èä¸šåŠ¡ä¸‹ï¼Œåˆ†å¸ƒå¼äº‹åŠ¡æ˜¯ä¿è¯æ•°æ®ä¸€è‡´æ€§çš„é‡è¦ä¿è¯ã€‚æœ¬æ–‡ç€é‡ä¼šè®²åˆ†å¸ƒå¼äº‹åŠ¡åœºæ™¯å’Œä¸šç•Œä¸»æµçš„è§£å†³æ–¹æ¡ˆã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;ä¸€-å¼•å…¥&#34;&gt;ä¸€ã€å¼•å…¥&lt;/h2&gt;
&lt;p&gt;â€ƒèµ„é‡‘è½¬è´¦åœ¨é‡‘èä¸šåŠ¡ä¸‹æ˜¯ä¸€ä¸ªéå¸¸é‡è¦è€Œä¸”å¸¸è§çš„åœºæ™¯ï¼Œå¦‚æœå› ä¸ºæŠ€æœ¯é—®é¢˜å¯¼è‡´èµ„é‡‘è½¬è´¦é”™è¯¯ï¼Œå¯¼è‡´æ•°æ®ä¸ä¸€è‡´é—®é¢˜ï¼Œé‚£ä¹ˆå°±ä¼šé€ æˆæ— æ³•é¢„æµ‹çš„åæœã€‚&lt;br&gt;
â€ƒç¬”è€…è¿™é‡Œæ‹¿é“¶è¡Œè½¬è´¦çš„ä¾‹å­æ¥è¯´ï¼ˆè¿™é‡Œçš„è½¬è´¦æœ‰å¾ˆå¤šåœºæ™¯æ¯”å¦‚é“¶è¡Œå¡ä¹‹é—´å……å€¼æç°ã€é“¶è¡Œè´¦æˆ·ä¹‹é—´çš„è½¬è´¦ç­‰ç­‰ï¼‰ï¼Œæ¯”å¦‚ç”²é“¶è¡Œè´¦æˆ·Aå‘ä¹™é“¶è¡Œè´¦æˆ·Bè½¬è´¦1Wï¼š&lt;/p&gt;
&lt;p&gt;åŒæ­¥è°ƒç”¨ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Aé“¶è¡Œå¯¹è½¬å‡ºè´¦æˆ·æ‰§è¡Œæ£€æŸ¥æ ¡éªŒï¼Œè¿›è¡Œè´¦æˆ·é‡‘é¢æ‰£å‡ã€‚&lt;/li&gt;
&lt;li&gt;Aé“¶è¡ŒåŒæ­¥è°ƒç”¨Bé“¶è¡Œè½¬è´¦æ¥å£ã€‚&lt;/li&gt;
&lt;li&gt;Bé“¶è¡Œå¯¹è½¬å…¥è´¦æˆ·è¿›è¡Œæ£€æŸ¥æ ¡éªŒï¼Œè¿›è¡Œè´¦æˆ·é‡‘é¢å¢åŠ ã€‚&lt;/li&gt;
&lt;li&gt;Bé“¶è¡Œè¿”å›å¤„ç†ç»“æœç»™Aé“¶è¡Œã€‚&lt;br&gt;
&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1593745125729.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
åŒæ­¥è°ƒç”¨é—®é¢˜ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚æœBé“¶è¡Œå› ä¸ºç½‘ç»œåŸå› å¯¼è‡´æ¥å£ä¸é€šï¼Œé‚£ä¹ˆAè°ƒç”¨çº¿ç¨‹ä¼šé•¿æ—¶é—´é˜»å¡ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœAæ‰£å‡åï¼Œå‘é€è¯·æ±‚åï¼Œåœ¨ç½‘ç»œä¸­ä¸¢å¤±äº†ï¼ŒBé“¶è¡Œæ²¡æœ‰æ”¶åˆ°è¯·æ±‚ï¼Œå¯¼è‡´è´¦æˆ·Aæ‰£å‡äº†ï¼Œè´¦æˆ·Bæ²¡æœ‰åŠ &lt;/li&gt;
&lt;li&gt;å¦‚æœè´¦æˆ·Bæ‰£å‡æˆåŠŸäº†ï¼Œç”±äºæŸç§åŸå› æ¯”å¦‚ç½‘ç»œå¼‚å¸¸æ²¡æœ‰åŠæ—¶å›è°ƒç»™ç”²é“¶è¡Œï¼Œé‚£ä¹ˆè´¦æˆ·Aå°±è®¤ä¸ºæ˜¯å¼‚å¸¸è¯·æ±‚ï¼Œåˆ™ä¼šå›æ»šäº‹åŠ¡ï¼Œå¯¼è‡´æ•°æ®ä¸ä¸€è‡´ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å†æ¥çœ‹ä¸€ä¸‹å¼‚æ­¥è°ƒç”¨ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Aé“¶è¡Œå¯¹è½¬å‡ºè´¦æˆ·æ‰§è¡Œæ£€æŸ¥æ ¡éªŒï¼Œè¿›è¡Œè´¦æˆ·é‡‘é¢æ‰£å‡ã€‚&lt;/li&gt;
&lt;li&gt;ä¸»çº¿ç¨‹å°†è¯·æ±‚æ•°æ®å¼‚æ­¥å†™å…¥é˜Ÿåˆ—MQ&lt;/li&gt;
&lt;li&gt;çœŸæ­£æ¶ˆè´¹è€…ç¨‹åºå¯¹Bé“¶è¡Œè¿›è¡Œè¿œç¨‹è°ƒç”¨&lt;/li&gt;
&lt;li&gt;Bé“¶è¡Œå¯¹è½¬å…¥è´¦æˆ·è¿›è¡Œæ£€æŸ¥æ ¡éªŒï¼Œè¿›è¡Œè´¦æˆ·é‡‘é¢å¢åŠ ã€‚&lt;/li&gt;
&lt;li&gt;Bé“¶è¡Œè¿”å›å¤„ç†ç»“æœç»™Aé“¶è¡Œã€‚&lt;br&gt;
&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1593743096206.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
å¼‚æ­¥è°ƒç”¨é—®é¢˜ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚æœè´¦æˆ·Aæ‰£å‡æœ¬åœ°äº‹åŠ¡æˆåŠŸäº†ï¼Œä½†æ˜¯æ¶ˆæ¯å‘å‡ºåï¼Œå› ä¸ºç½‘ç»œåŸå› æˆ–è€…å…¶ä»–å®•æœºåŸå› ï¼Œå¯¼è‡´æ¶ˆæ¯æœªå‘é€æˆåŠŸï¼Œæ²¡æœ‰è¿›è¡ŒBè´¦æˆ·è¿œç¨‹è°ƒç”¨ï¼Œå¯¼è‡´æœ¬åœ°äº‹åŠ¡å’Œæ¶ˆæ¯ä¸ä¸€è‡´æ€§ã€‚&lt;/li&gt;
&lt;li&gt;MQæ¶ˆè´¹ç«¯ç¨‹åºå¦‚æœæ¶ˆè´¹æ¶ˆæ¯æˆåŠŸï¼Œè¯·æ±‚é“¶è¡ŒæˆåŠŸäº†ï¼Œä½†æ˜¯å›ä¼ ACKç»™MQå¤±è´¥äº†ï¼Œé‚£ä¹ˆå›å¯¼è‡´æ¶ˆè´¹ç«¯ç¨‹åºé‡å¤æ¶ˆè´¹é—®é¢˜ï¼Œé‚£ä¹ˆå°±ä¼šå‡ºç°é‡å¤è½¬è´¦çš„é—®é¢˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¼‚æ­¥è°ƒç”¨è§£å†³äº†åŒæ­¥è°ƒç”¨çš„ä¸»çº¿ç¨‹é˜»å¡é—®é¢˜ï¼Œä½†è¿˜æ˜¯æ²¡æœ‰è§£å†³æ•°æ®ä¸€è‡´æ€§é—®é¢˜ã€‚è€Œä¸”å¼•å…¥MQä¸­é—´åï¼Œè¿˜è¦è€ƒè™‘åˆ°æœ¬åœ°äº‹åŠ¡å’ŒMQæ¶ˆæ¯ä¸€è‡´æ€§é—®é¢˜ï¼Œè¿˜æœ‰å…¶ä»–çš„å¼•å…¥åçš„ç»´æŠ¤å·¥ä½œï¼Œæ¯”å¦‚æ¶ˆæ¯ä¸¢å¤±ï¼Œæ¶ˆæ¯é‡å‘ç­‰ç­‰é—®é¢˜ã€‚&lt;/p&gt;
&lt;h2 id=&#34;äºŒ-åˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆ&#34;&gt;äºŒã€åˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆ&lt;/h2&gt;
&lt;p&gt;â€ƒè®²åˆ°äº†åˆ†å¸ƒå¼äº‹åŠ¡ï¼Œè‡ªç„¶ç¦»ä¸å¼€åˆ†å¸ƒå¼ç³»ç»Ÿçš„ä¸€äº›åŸºæœ¬åŸåˆ™å’Œå®šç†ï¼šCAPåŸåˆ™å’ŒBASEç†è®ºï¼Œç›¸ä¿¡è¯»è€…åº”è¯¥éƒ½çŸ¥é“ï¼Œè¿™é‡Œä¸åšè¿‡å¤šé˜è¿°ã€‚ä¸šç•Œæ ¹æ®è¿™äº›è§„åˆ™å’Œç†è®ºï¼Œè¡ç”Ÿå‡ºäº†å„ç§åˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆï¼šXAè§„èŒƒï¼Œ2PCï¼Œ3PCï¼Œæœ¬åœ°æ¶ˆæ¯è¡¨æ–¹æ¡ˆï¼ŒåŸºäºæ¶ˆæ¯ä¸­é—´ä»¶çš„æœ€ç»ˆä¸€è‡´æ€§æ–¹æ¡ˆï¼ŒTCCæ–¹æ¡ˆï¼Œé˜¿é‡Œçš„SEATAï¼ŒSAGAæ–¹æ¡ˆå’Œæœ€å¤§åŠªåŠ›é€šçŸ¥ç­‰ç­‰ã€‚&lt;br&gt;
â€ƒä»¥ä¸Šæ¯ä¸ªæ–¹æ¡ˆéƒ½æœ‰è‡ªå·±çš„åº”ç”¨åœºæ™¯ï¼Œå°±æ‹¿2PCæ¥è¯´ï¼ŒMySQLçš„äº‹åŠ¡å‹æ—¥å¿—redologäºŒæ®µæäº¤ï¼ˆredolog(prepare)--ã€‹binlog--ã€‹redolog(commit)ï¼‰ä¿è¯binlogå’Œredologæ•°æ®ä¸€è‡´æ€§ï¼ŒZookeeperçš„proposaläº‹åŠ¡äºŒæ®µæäº¤ï¼ˆåŠæ•°ä»¥ä¸Šackè¿”å›æˆåŠŸè¡¨ç¤ºå†™å…¥æ•°æ®æˆåŠŸï¼‰ä¿è¯leaderå’Œfollerçš„æ•°æ®ä¸€è‡´æ€§ï¼Œè¿™äº›éƒ½æ˜¯2PCçš„åº”ç”¨ã€‚&lt;br&gt;
â€ƒé‡‘èåœºæ™¯ä¸‹ç±»ä¼¼èµ„é‡‘ä¸šåŠ¡éœ€è¦ä¿è¯æœ€ç»ˆä¸€è‡´æ€§è§£å†³åˆ†å¸ƒå¼äº‹åŠ¡ï¼Œä¸éœ€è¦ä¿è¯è½¬è´¦å®æ—¶æ€§ã€‚æ‰€ä»¥æœ¬åœ°æ¶ˆæ¯è¡¨ã€åŸºäºMQä¸­é—´ä»¶çš„æœ€ç»ˆä¸€è‡´æ€§ç­‰æŸ”æ€§æ–¹æ¡ˆæ˜¯é¦–é€‰çš„æ–¹æ¡ˆã€‚è¿™äº›åŸºäºæ¶ˆæ¯çš„åˆ†å¸ƒå¼äº‹åŠ¡ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯ï¼Œæœ¬åœ°äº‹åŠ¡+ä»äº‹åŠ¡ï¼Œä»äº‹åŠ¡ä»æ¶ˆæ¯ä¸­è·å–ä¿¡æ¯è¿›è¡Œæœ¬åœ°æäº¤ï¼Œè¿™é‡Œä¿æŒ&lt;strong&gt;å¼‚æ­¥äº‹åŠ¡æœºåˆ¶ã€åªèƒ½ä¿è¯æœ€ç»ˆä¸€è‡´æ€§&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;21-åˆ©ç”¨æœ¬åœ°æ¶ˆæ¯è¡¨æ€æƒ³è§£å†³ä¸€è‡´æ€§é—®é¢˜&#34;&gt;2.1 åˆ©ç”¨æœ¬åœ°æ¶ˆæ¯è¡¨æ€æƒ³è§£å†³ä¸€è‡´æ€§é—®é¢˜&lt;/h3&gt;
&lt;p&gt;â€ƒä¸€èˆ¬æ¥è¯´ï¼Œè·¨è¡Œè½¬è´¦çš„åŸç†ï¼Œä¼šå­˜åœ¨ä¸€ä¸ªä¸­å›½äººæ°‘é“¶è¡Œçš„ä¸­é—´äººè§’è‰²æ¥æ“ä½œè½¬è´¦ï¼Œä½†ä¸åœ¨æœ¬æ¬¡è®¨è®ºçš„èŒƒå›´å†…ã€‚&lt;br&gt;
â€ƒä¸šç•Œé“¶è¡Œè½¬è´¦å¤§éƒ¨åˆ†éƒ½æ˜¯åŒæ­¥è½¬è´¦ï¼Œå¼‚æ­¥è·å–è½¬è´¦ç»“æœï¼ŒåŒ…æ‹¬ç¬¬ä¸‰æ–¹æ”¯ä»˜å¹³å°å¯¹æ¥é“¶è¡Œéƒ½æ˜¯è¿™æ ·ç©çš„ã€‚è¿™é‡Œç¬”è€…å°±åˆ©ç”¨æœ¬åœ°æ¶ˆæ¯è¡¨æ€æƒ³æ¥å…·ä½“å™è¿°æ•°æ®ä¸€è‡´æ€§æ˜¯å¦‚ä½•ä¿è¯çš„ï¼Œè€è§„çŸ©å…ˆæ”¾å›¾ï¼š&lt;br&gt;
&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1603274563955.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
å…¶ä¸­äº¤æ˜“è®°å½•è¡¨å¤§æ¦‚é•¿è¿™ä¸ªæ ·å­ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center&#34;&gt;å­—æ®µ&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;æè¿°&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;id&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;è‡ªå¢IDï¼Œæ²¡æœ‰ä¸šåŠ¡æ„ä¹‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;trade_order_num&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;äº¤æ˜“è®¢å•å·ï¼Œä½œä¸ºè½¬è´¦è®°å½•å”¯ä¸€æ ‡è¯†&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;source_account_num&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;äº¤æ˜“è½¬å‡ºæ–¹è´¦æˆ·ID&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;target_account_num&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;äº¤æ˜“æ”¶æ¬¾æ–¹è´¦æˆ·ID&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;status&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;çŠ¶æ€æœºï¼Œ0=é¢„åˆ›å»ºï¼Œ1=è½¬è´¦ä¸­ï¼Œ2=è½¬è´¦æˆåŠŸï¼Œ3=è½¬è´¦å¤±è´¥&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;pay_success_time&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;è®°å½•è½¬è´¦æˆåŠŸæ—¶é—´&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;create_time&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;è®°å½•åˆ›å»ºæ—¶é—´ï¼Œå¯ä½œä¸ºçª—å£æ—¶é—´å†…åˆ¤æ–­æ ‡å‡†&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;update_time&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;è®°å½• æ›´æ–°æ—¶é—´&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;è´¦æˆ·è¡¨å¤§æ¦‚é•¿è¿™ä¸ªæ ·å­ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center&#34;&gt;å­—æ®µ&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;æè¿°&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;id&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;è‡ªå¢IDï¼Œæ²¡æœ‰ä¸šåŠ¡æ„ä¹‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;account_num&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;è´¦æˆ·ID&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;current_amt&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;å½“å‰è´¦æˆ·ä½™é¢&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;lock_amt&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;å†»ç»“é‡‘é¢ï¼Œç”¨æ¥è®°å½•ä¸´æ—¶çŠ¶æ€çš„æ ¸å¿ƒè½¬è´¦æ•°æ® ã€‚çœŸå®ä½™é¢=current_amt-lock_amt&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;å›¾ä¸­çš„æ­¥éª¤å¤§è‡´åˆ†ä¸º8æ­¥ï¼Œè¿™é‡Œç»†è‡´è®²ä¸€ä¸‹æ¯ä¸€æ­¥çš„è¯¦ç»†æ­¥éª¤ï¼Œåˆ†åˆ«æ˜¯ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ’å…¥åˆå§‹çŠ¶æ€çš„äº¤æ˜“æ•°æ®ã€‚ è¿™ä¸€æ­¥éª¤çš„ç›®çš„æ˜¯ä¿è¯å‘èµ·åŒæ­¥è½¬è´¦è¯·æ±‚å’Œæœ¬åœ°åˆå§‹äº‹åŠ¡ä¸€è‡´æ€§ï¼Œè¿˜æœ‰ä¸€ä¸ªç›®çš„å°±æ˜¯ç”Ÿæˆè½¬è´¦è®°å½•å”¯ä¸€æ ‡è¯†ï¼Œç”¨æ¥æ ‡è¯†æœ¬æ¬¡è½¬è´¦&lt;/li&gt;
&lt;li&gt;åŒæ­¥å‘èµ·è½¬è´¦è¯·æ±‚ï¼Œå¸¦ä¸Šå”¯ä¸€æ ‡è¯†ä»¥åŠå…¶ä»–çš„ä¸šåŠ¡å‚æ•°&lt;/li&gt;
&lt;li&gt;é“¶è¡Œä¹™ä¼šæ ¡éªŒå‚æ•°ä¿¡æ¯ï¼Œå¹¶ä¸”åŒæ­¥è¿”å›è½¬è´¦é€šçŸ¥ï¼Œç±»ä¼¼â€œæˆ‘æ¥æ”¶åˆ°äº†ä½ çš„è¯·æ±‚äº†ï¼Œæˆ‘è¿˜æœ‰å…¶ä»–äº‹æƒ…ï¼Œæˆ‘ç­‰ä¼šè¿”å›ç»“æœç»™ä½ â€&lt;/li&gt;
&lt;li&gt;ä¼šæ ¹æ®åŒæ­¥çš„è½¬è´¦é€šçŸ¥æ¥åˆ¤æ–­è¿™æ¬¡äº¤æ˜“æ˜¯å¦åˆæ³•ï¼Œç„¶åä¼šè®°å½•ç»“æœåˆ°äº¤æ˜“è¡¨ä¸­ã€‚è¿™é‡Œå¹¶ä¸”éœ€è¦å†»ç»“è´¦æˆ·çš„ä¸€éƒ¨åˆ†é‡‘é¢ï¼Œä½œä¸ºä¸´æ—¶ä¸­é—´æ€æ•°æ®ã€‚å¹¶ä¸”éœ€è¦æ›´æ–°æœ¬åœ°äº¤æ˜“è¡¨çŠ¶æ€ä¸ºè½¬è´¦ä¸­&lt;/li&gt;
&lt;li&gt;é“¶è¡Œä¹™éœ€è¦è®°å½•æœ¬æ¬¡äº¤æ˜“è®°å½•ï¼Œæ’å…¥ä¸€æ¡äº¤æ˜“ä¸­çš„æ•°æ®ï¼Œç›´è‡³å›è°ƒè½¬è´¦ç»“æœç»™é“¶è¡Œç”²ï¼Œå°†è¿™æ¡è®°å½•ç½®ä¸ºè½¬è´¦æˆåŠŸã€‚å¹¶ä¸”é“¶è¡Œä¹™è‡ªå·±ç”Ÿæˆçš„æ”¶æ¬¾äº¤æ˜“æµå·ï¼Œç„¶åæ”¾å…¥åˆ°å›è°ƒç»“æœä¸­ï¼Œä¼ ç»™é“¶è¡Œç”²&lt;/li&gt;
&lt;li&gt;å¼‚æ­¥å›è°ƒç»“æœç»™é“¶è¡Œç”²ï¼Œå…¶ä¸­å›è°ƒå‚æ•°é‡è¦çš„æœ‰é“¶è¡Œç”²çš„å”¯ä¸€çš„è½¬è´¦æ ‡è¯†ï¼Œè¿˜æœ‰é“¶è¡Œä¹™è‡ªå·±ç”Ÿæˆçš„æ”¶æ¬¾äº¤æ˜“æµå·&lt;/li&gt;
&lt;li&gt;æ ¹æ®å¼‚æ­¥å›è°ƒçš„çŠ¶æ€ï¼Œæ›´æ–°äº¤æ˜“çŠ¶æ€æ•°æ®ï¼Œå¦‚æœæˆåŠŸï¼Œé‚£ä¹ˆä¼šæ‰£å‡è´¦ä½™é¢ï¼Œå¹¶ä¸”é‡Šæ”¾å†»ç»“é‡‘é¢ï¼Œå¦‚æœå¤±è´¥ï¼Œç›´æ¥é‡Šæ”¾å†»ç»“é‡‘é¢ã€‚æ­¤æ—¶ç®—æ˜¯æ­£å¸¸çš„ä¸€æ¡&lt;strong&gt;æµç¨‹é—­ç¯&lt;/strong&gt;èµ°å®Œ&lt;/li&gt;
&lt;li&gt;å½“ç„¶ä¸æ˜¯æ‰€æœ‰çš„ä¸šåŠ¡èƒ½å¤Ÿæ­£å¸¸èµ°å®Œæµç¨‹é—­ç¯ï¼Œä¹Ÿä¼šå‡ºç°å„ç§åŸå› å¯¼è‡´ä¸èƒ½èµ°å®Œã€‚ä¸ºäº†ä¿è¯æ•°æ®ä¸€è‡´æ€§ï¼Œä¼šå¢åŠ ä¸€ä¸ªè¡¥å¿ç¨‹åºï¼Œå®šæ—¶å»æ‹‰å–å¼‚å¸¸æ•°æ®ï¼Œå¼‚å¸¸æ•°æ®æŒ‡çš„æ˜¯äº¤æ˜“çŠ¶æ€ä¸º0å’Œ1å¹¶ä¸”&lt;strong&gt;ä¸åœ¨æ­£å¸¸çª—å£ä¸šåŠ¡&lt;/strong&gt;æ—¶é—´å†…çš„æ•°æ®ï¼ˆ0å’Œ1å±äºä¸­é—´æ€ï¼Œè€Œ2æˆ–è€…3æ•°æ®ç»ˆæ€ï¼‰ï¼Œçª—å£æ—¶é—´æŒ‡çš„æ˜¯æ­£å¸¸ä¸šåŠ¡ä»å¼€å§‹åˆ°ç»“æŸçš„æ—¶é—´ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚æœå¼‚å¸¸æ•°æ®çŠ¶æ€æ˜¯0ï¼Œé‚£ä¹ˆè¡¨ç¤ºæœ‰å¯èƒ½æ˜¯æœ¬åœ°æ›´æ–°äº‹åŠ¡å¤±è´¥äº†ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯è¯·æ±‚æˆ–è€…è¿”å›åœ¨ç½‘ç»œä¸­ä¸¢å¤±äº†ï¼Œè¡¥å¿ç¨‹åºé‡Œé¢ä¼šæ ¹æ®æœ¬åœ°çš„è¡¨æ•°æ®åˆ¤æ–­æ˜¯å“ªä¸ªæ­¥éª¤é™¤é—®é¢˜äº†ï¼Œå°±æ¯”å¦‚è¯´æœ¬åœ°æ•°æ®æ²¡æœ‰é“¶è¡Œä¹™çš„äº¤æ˜“æµæ°´å·ï¼Œé‚£ä¹ˆå°±æ˜¯ç½‘ç»œå‡ºé—®é¢˜äº†ï¼Œåé¢å°±å¯ä»¥è¿›è¡Œè¡¥å¿æ“ä½œ&lt;/li&gt;
&lt;li&gt;å¦‚æœå¼‚å¸¸æ•°æ®çŠ¶æ€æ˜¯1ï¼Œé‚£ä¹ˆè¡¨ç¤ºå¯èƒ½æ˜¯é“¶è¡Œä¹™æ¥å£æœ‰é—®é¢˜æˆ–è€…ç½‘ç»œæœ‰é—®é¢˜åŸå› å¯¼è‡´æ²¡æœ‰åŠæ—¶å›è°ƒï¼Œè¿™ä¸ªæ—¶å€™è¡¥å¿ç¨‹åºå°±ç”¨é“¶è¡Œä¹™çš„äº¤æ˜“æµæ°´å·æ˜¯å»æŸ¥è¯¢äº¤æ˜“æ˜¯å¦å®Œæˆï¼Œç„¶åæ›´æ–°è‡ªå·±æœ¬åœ°çš„æ•°æ®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä»¥ä¸Šæµç¨‹æ˜¯ä¸€æ¬¡æ­£å¸¸çš„äº¤æ˜“è¿‡ç¨‹ï¼Œå½“ç„¶ä¸æ˜¯æ‰€æœ‰çš„äº¤æ˜“æµç¨‹éƒ½æ˜¯è¿™æ ·èµ°çš„ï¼Œä¸è¿‡å¤§éƒ¨åˆ†è½¬è´¦æµç¨‹å’Œä¸Šè¿°æ­¥éª¤ç›¸ç±»ä¼¼ï¼Œå…¶ä¸­çš„ç»†è‡´æ­¥éª¤åœ¨æ¯ä¸ªäº¤æ˜“ç³»ç»Ÿä¸­ç•¥æœ‰ä¸åŒã€‚&lt;/p&gt;
&lt;p&gt;æ€»ç»“èµ·æ¥ï¼Œåˆ©ç”¨æœ¬åœ°æ¶ˆæ¯è¡¨æ€æƒ³èƒ½å¤Ÿè§£å†³ä¸Šé¢ç¬¬ä¸€éƒ¨åˆ†æ–‡ç« çš„åŒæ­¥è°ƒç”¨çš„ç¼ºç‚¹ï¼Œèƒ½å¤Ÿè§£å†³ç¬¬äºŒä¸ªç¬¬ä¸‰ ä¸ªé—®é¢˜ï¼Œä½†æ˜¯ç¬¬ä¸€ä¸ªé—®é¢˜å°±æ— æ³•è§£å†³äº†ï¼Œåªè¦æ˜¯åŒæ­¥è°ƒç”¨éƒ½ä¼šå‡ºç°è¿™ä¸ªé—®é¢˜ï¼Œä¸è¿‡æœ‰å…¶ä»–æ–¹å¼å»è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ä»¥ç¬”è€…è®¤çŸ¥æ¥è¯´ï¼Œé“¶è¡Œè½¬è´¦çš„ä¸šåŠ¡éƒ½æ˜¯åŒæ­¥è°ƒç”¨çš„ã€‚å‡ºç°æ¥å£é˜»å¡è¿™ä¸ªé—®é¢˜ï¼Œéœ€è¦è®¾ç½®è¶…æ—¶æ—¶é—´ï¼Œå¦‚æœè¶…è¿‡è¶…æ—¶æ—¶é—´ï¼Œå°±è®°å½•ä¸‹è¿™æ¡äº¤æ˜“ï¼Œå¼‚æ­¥æ”¾å…¥&lt;strong&gt;é‡è¯•é˜Ÿåˆ—&lt;/strong&gt;ï¼Œä¸€æ®µæ—¶é—´åè¿›è¡Œ&lt;strong&gt;é‡è¯•&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;22-äº‹åŠ¡æ¶ˆæ¯è§£å†³æœ¬åœ°äº‹åŠ¡å’Œmqæ¶ˆæ¯ä¸€è‡´æ€§é—®é¢˜&#34;&gt;2.2 äº‹åŠ¡æ¶ˆæ¯è§£å†³æœ¬åœ°äº‹åŠ¡å’ŒMQæ¶ˆæ¯ä¸€è‡´æ€§é—®é¢˜&lt;/h3&gt;
&lt;p&gt;â€ƒè½¬è´¦ä¸šåŠ¡ï¼Œå¦‚æœç”¨å¼‚æ­¥çš„è¯ï¼Œå½“å‡ºç°MQé—®é¢˜æˆ–è€…æ¶ˆè´¹ä¹Ÿè€…ç¨‹åºå‡ºç°æ¶ˆæ¯æŒ¤å‹æˆ–è€…æ¶ˆè´¹è€…ç«¯å‡ºç°é—®é¢˜ çš„è¯ï¼Œé‚£ä¹ˆæ•´ä¸ªä¸šåŠ¡æ—¶é—´çº¿ä¼šæ‹‰çš„éå¸¸é•¿ã€‚æ‰€ä»¥ç¬”è€…è®¤ä¸ºå¼‚æ­¥ä¸é€‚åˆè¿™ç§ä¸šåŠ¡ï¼Œå¼‚æ­¥&lt;strong&gt;æœ¬è´¨ä¸Š&lt;/strong&gt;æ˜¯å¯¹ä¸‹æ¸¸æœåŠ¡çš„ä¸€ä¸ªç¼“å†²ï¼Œé€‚åˆåœ¨è‡ªå·±ç³»ç»Ÿä¸­ä½¿ç”¨ï¼Œä¸é€‚åˆè·¨ç³»ç»Ÿæˆ–è€…ä¸‰æ–¹è°ƒç”¨ã€‚å½“ç„¶ä¸æ˜¯æ‰€æœ‰çš„åœºæ™¯éƒ½ä¸åˆé€‚ï¼Œå¦‚æœæµé‡éå¸¸å¤§è¯ï¼Œå¯¹æ–¹ç³»ç»Ÿæœ‰é™æµæœºåˆ¶ï¼Œä½¿ç”¨MQä¹Ÿç®—æ˜¯ä¸€ç§è§£å†³æ–¹æ¡ˆï¼Œè¿™è¿˜æ˜¯çœ‹å…·ä½“ä¸šåŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒä»€ä¹ˆæ ·çš„åœºæ™¯é€‚åˆä½¿ç”¨MQï¼Ÿä¸€èˆ¬æ¥è¯´åœ¨éœ€è¦é™æµå‰Šå³°ã€å¼‚æ­¥è§£è€¦ç­‰åœºæ™¯ä½¿ç”¨ï¼Œæ‰€ä»¥è¿˜æ˜¯æ‹¿ä¸Šé¢çš„å›¾ï¼Œå›¾ä¸­æ ‡æ¡†çš„éƒ¨åˆ†ä¸šåŠ¡é€‚åˆç”¨MQæ¥è§£å†³&lt;br&gt;
&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1603790962781.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;â€ƒå¦‚æœç”¨MQæ¥åšçš„è¯ï¼Œé‚£ä¹ˆä¼šæœ‰å¦‚ä¸‹å›¾æ­¥éª¤ï¼š&lt;br&gt;
&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1603792233049.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
å›¾ä¸­çš„æ­¥éª¤å¤§è‡´åˆ†ä¸º6æ­¥ï¼Œè¿™é‡Œç»†è‡´è®²ä¸€ä¸‹æ¯ä¸€æ­¥çš„è¯¦ç»†æ­¥éª¤ï¼Œåˆ†åˆ«æ˜¯ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ¶ˆæ¯ç”Ÿæˆè€…å‘é€æ¶ˆæ¯ï¼Œbrokeræ¥å—æ¶ˆæ¯&lt;/li&gt;
&lt;li&gt;MQ brokeræ”¶åˆ°æ¶ˆæ¯ï¼Œéšå³å°†æ¶ˆæ¯è¿›è¡ŒæŒä¹…åŒ–ï¼Œå¹¶ä¸”å­˜å…¥åº“ã€‚è¿™ä¸€æ­¥æ˜¯é˜²æ­¢MQå› ä¸ºç‰©ç†åŸå› å®•æœºå¯¼è‡´çš„æ¶ˆæ¯ä¸¢å¤±ï¼Œå¹¶ä¸”å…¥åº“çš„æ—¶å€™è¦åˆ¤æ–­å¹‚ç­‰ï¼Œé˜²æ­¢æ²¡æœ‰åŠæ—¶è¿”å›ackï¼Œå¯¼è‡´ç”Ÿäº§è€…é‡å‘æ¶ˆæ¯ã€‚&lt;/li&gt;
&lt;li&gt;è¿”å›ACKç»™ç”Ÿäº§è€…ã€‚å¦‚æœä¸åŠæ—¶è¿”å›æˆ–è€…é•¿æ—¶é—´æ²¡æœ‰è¿”å›ï¼Œç”Ÿäº§è€…ä¼šè®¤ä¸ºè¿™æ¡æ¶ˆæ¯å‘é€å¤±è´¥ï¼Œä¼šé‡æ–°å‘é€ã€‚&lt;/li&gt;
&lt;li&gt;MQ pushæ¶ˆæ¯ç»™å¯¹åº”çš„æ¶ˆè´¹è€…æˆ–è€…æ¶ˆè´¹è€…ä¸»åŠ¨æ¥pullæ¶ˆæ¯ï¼Œç„¶åç­‰å¾…æ¶ˆè´¹è€…è¿”å›ACK&lt;/li&gt;
&lt;li&gt;å¦‚æœæ¶ˆæ¯æ¶ˆè´¹è€…åœ¨æŒ‡å®šæ—¶é—´å†…æˆåŠŸè¿”å›ackï¼Œé‚£ä¹ˆMQè®¤ä¸ºæ¶ˆæ¯æ¶ˆè´¹æˆåŠŸï¼Œåœ¨å­˜å‚¨ä¸­åˆ é™¤æ¶ˆæ¯ï¼Œå³æ‰§è¡Œç¬¬6æ­¥ï¼›å¦‚æœMQåœ¨æŒ‡å®šæ—¶é—´å†…æ²¡æœ‰æ”¶åˆ°ACKï¼Œåˆ™è®¤ä¸ºæ¶ˆæ¯æ¶ˆè´¹å¤±è´¥ï¼Œä¼šå°è¯•é‡æ–°pushæˆ–è€…pullæ¶ˆæ¯,é‡å¤æ‰§è¡Œ4ã€5ã€6æ­¥éª¤&lt;/li&gt;
&lt;li&gt;MQåˆ é™¤æ¶ˆæ¯&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;â€ƒä»¥ä¸Šä¸ºä¸€æ¡æ­£å¸¸çš„æ¶ˆæ¯ä»ç”Ÿäº§åˆ°æ¶ˆè´¹çš„è¿‡ç¨‹ï¼Œæ¯ä¸€æ­¥éƒ½æ˜¯ä¸å¯æˆ–ç¼ºçš„ã€‚è€Œä¸”æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå½“å¼•å…¥ä¸­é—´ä»¶MQåï¼Œæ¶ˆè´¹ç«¯ä¸šåŠ¡éœ€è¦ä¿æŒå¹‚ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒå›åˆ°ä¸Šé¢æ–‡ç« æœ€å¼€å§‹çš„éƒ¨åˆ†ï¼Œå¹¶æ²¡æœ‰è§£å†³å¼‚æ­¥è°ƒç”¨é—®é¢˜ä¸€ã€‚æ²¡æœ‰å½»åº•è§£å†³æœ¬åœ°äº‹åŠ¡å’Œæ¶ˆæ¯ä¸ä¸€è‡´æ€§ã€‚æ‰€ä»¥è¿™ä¸ªæ—¶å€™ï¼Œå°±éœ€è¦äº‹åŠ¡æ¶ˆæ¯è§£å†³æœ¬åœ°äº‹åŠ¡å’ŒMQæ¶ˆæ¯ä¸€è‡´æ€§é—®é¢˜äº†ï¼Œç¬”è€…é‡æ–°ç”»äº†ä¸€å¼ å›¾æ¥è¯´æ˜ä¸€ä¸‹äº‹åŠ¡æ¶ˆæ¯æ˜¯å¦‚ä½•åšçš„ï¼š&lt;br&gt;
&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1603873494446.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
å›¾ä¸­çš„æ­¥éª¤å¤§è‡´åˆ†ä¸ºå‡ æ­¥ï¼Œåˆ†åˆ«æ˜¯ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ç”Ÿäº§è€…å‘é€ä¸€æ¡prepareæ¶ˆæ¯&lt;/li&gt;
&lt;li&gt;MQæ¥å—åˆ°æ¶ˆæ¯åï¼Œå…ˆè¿›è¡ŒæŒä¹…åŒ–,çŠ¶æ€ä¸ºå¾…ç¡®è®¤çš„æ¶ˆæ¯&lt;/li&gt;
&lt;li&gt;è¿”å›ACKç»™æ¶ˆæ¯ç”Ÿäº§è€…&lt;/li&gt;
&lt;li&gt;æ‰§è¡Œæœ¬åœ°äº‹åŠ¡ï¼šæ‰£å‡è´¦æˆ·ä½™é¢ï¼Œæ’å…¥äº¤æ˜“æµæ°´ã€‚å¦‚æœè¿™ä¸ªäº‹åŠ¡æ‰§è¡Œå¤±è´¥ï¼Œé‚£ä¹ˆç›¸å½“äºä¸šåŠ¡æ‰§è¡Œå¤±è´¥ï¼ŒæŠ›ç»™ç”¨æˆ·äº¤æ˜“å¤±è´¥&lt;/li&gt;
&lt;li&gt;æ‰§è¡Œå®Œæˆåï¼Œå°†ç»“æœå‘é€æ‰§è¡Œç»“æœç»™MQ&lt;/li&gt;
&lt;li&gt;æ ¹æ®ç»“æœå°†æ¶ˆæ¯commitæˆ–è€…rollback  commitï¼šå°†æ¶ˆæ¯çŠ¶æ€ç½®ä¸ºå·²ç¡®è®¤  rollbackï¼šå°†æ¶ˆæ¯åˆ é™¤&lt;/li&gt;
&lt;li&gt;é‡‡ç”¨pullæˆ–è€…pushæ¶ˆè´¹å·²ç¡®è®¤çš„æ¶ˆæ¯ ï¼Œåé¢æµç¨‹å¤§è‡´å’Œæ™®é€šçš„æµç¨‹éƒ½ä¸€æ ·&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;â€ƒè¿™é‡Œè¿˜æ²¡æœ‰ä½“ç°å¦å¤–ä¸€ä¸ªæµç¨‹ï¼Œå°±æ˜¯å¦‚æœæ¶ˆæ¯å¾…ç¡®è®¤çŠ¶æ€åœ¨ä¸€å®šæ—¶é—´å†…æ²¡æœ‰è½¬æ¢ä¸ºå·²ç¡®è®¤ï¼Œé‚£ä¹ˆMQä¼šå›æŸ¥æœ¬åœ°äº‹åŠ¡æ‰§è¡ŒçŠ¶æ€æ˜¯å¦æˆåŠŸã€‚è¿™ä¸ªæ˜¯ä¸ºäº†ä¿è¯åœ¨ç¬¬äº”æ­¥å‘é€çš„æ¶ˆæ¯åœ¨ç½‘ç»œä¸­ä¸¢å¤±æˆ–è€…æ¶ˆè´¹è€…å®•æœºç­‰æƒ…å†µä¸‹ï¼Œèƒ½å¤Ÿå›æ»šã€‚&lt;br&gt;
â€ƒä»¥ä¸Šæ˜¯äº‹åŠ¡æ¶ˆæ¯å¤§è‡´çš„æµç¨‹ï¼Œèƒ½å¤Ÿè§£å†³æœ¬åœ°äº‹åŠ¡å’ŒMQæ¶ˆæ¯ä¸€è‡´æ€§é—®é¢˜ï¼Œè¿™é‡Œå¼ºè°ƒçš„æ˜¯ï¼Œä¸ç®¡æ˜¯æ˜¯äº‹åŠ¡æ¶ˆæ¯è¿˜æ˜¯æ™®é€šçš„æ¶ˆæ¯ï¼Œæ¶ˆè´¹ç«¯éƒ½éœ€è¦åšå¹‚ç­‰å¤„ç†ã€‚&lt;br&gt;
â€ƒæ€»ç»“æ¥è¯´ï¼Œ&lt;strong&gt;ack+è¡¥å¿+é‡è¯•+å¹‚ç­‰&lt;/strong&gt;æ˜¯ä¿è¯ä¸€è‡´æ€§çš„å…³é”®ã€‚&lt;/p&gt;
&lt;h4 id=&#34;221-äº‹åŠ¡æ¶ˆæ¯å¸¸è§é—®é¢˜&#34;&gt;2.2.1 äº‹åŠ¡æ¶ˆæ¯å¸¸è§é—®é¢˜&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;å¦‚æœconsumeræ¶ˆè´¹å¤±è´¥ï¼Œæ˜¯å¦éœ€è¦produceråšå›æ»šå‘¢ï¼Ÿ&lt;br&gt;
ä¸éœ€è¦ï¼ŒMQä½œç”¨è¦ä¿è¯çš„å°±æ˜¯&lt;strong&gt;æœ€ç»ˆä¸€è‡´æ€§&lt;/strong&gt;ï¼Œå¦‚æœconsumeræ¶ˆè´¹å¤±è´¥ï¼Œå°±è®©å®ƒè¿›è¡Œé‡è¯•ç›´è‡³æˆåŠŸã€‚å¦‚æœé‡è¯•è¶…è¿‡ä¸€å®šæ¬¡æ•°çš„è¯ï¼Œé‚£ä¹ˆå°±äººå·¥ä»‹å…¥ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;ä¸‰-å…¶ä»–æ–¹å¼ä¿è¯æ•°æ®ä¸€è‡´æ€§&#34;&gt;ä¸‰ã€ å…¶ä»–æ–¹å¼ä¿è¯æ•°æ®ä¸€è‡´æ€§&lt;/h2&gt;
&lt;p&gt;â€ƒå½“ç„¶ï¼Œä¿æŒæ•°æ®ä¸€è‡´æ€§ä¸å…‰æ˜¯åˆ†å¸ƒå¼äº‹åŠ¡æ¥ä¿è¯ï¼Œä¸šåŠ¡ä¸Šè¿˜è¦é…åˆå…¶ä»–çš„è¾…åŠ©æ¥ä¿è¯ï¼Œè¿™é‡Œç¬”è€…å°±åˆ—ä¸¾å‡ ç§&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å…¨é“¾è·¯å¹‚ç­‰&lt;br&gt;
å…¨é“¾è·¯å¹‚ç­‰ä¿è¯ä¸äº§ç”Ÿè„æ•°æ®ï¼Œä¿æŠ¤æ ¸å¿ƒæµç¨‹æ­£å¸¸æ‰§è¡Œã€‚&lt;/li&gt;
&lt;li&gt;é‡è¯•æœºåˆ¶&lt;br&gt;
å¯¹å¼‚å¸¸ä¸šåŠ¡è¿›è¡Œé‡è¯•ï¼Œè¶…è¿‡æŒ‡å®šé‡è¯•æ¬¡æ•°ä»å¤±è´¥çš„è¿›è¡Œäººå·¥ä»‹å…¥ã€‚&lt;/li&gt;
&lt;li&gt;ä¸šåŠ¡å¯¹è´¦&lt;br&gt;
ä¸šåŠ¡å†…éƒ¨å‡†å®æ—¶å¯¹è´¦ï¼Œæ¯”å¦‚ä¸šåŠ¡å‘ç”Ÿåå……å€¼æç°ï¼Œå¯¹æ¯”ç”¨æˆ·ä½™é¢æ˜¯å¦æ­£ç¡®ï¼Œç”¨æˆ·ä¸šåŠ¡æµæ°´æ˜¯å¦æ­£ç¡®ã€‚&lt;br&gt;
T+1æ—¥å¯¹è´¦ï¼Œç¨‹åºæˆ–è€…äººå·¥å®šæ—¶æ‰«ææ ¸å¿ƒä¸šåŠ¡æ•°æ®ï¼Œä¿è¯å½“æ—¥æ•°æ®å‡†ç¡®ã€‚å¯¹è´¦åè‡ªåŠ¨æ£€æµ‹å¹¶ä¸”ä¿®å¤é‡è¯•ä¸šåŠ¡&lt;/li&gt;
&lt;li&gt;ä¸šåŠ¡æŒ‡æ ‡ç›‘æ§&lt;br&gt;
ç›‘æ§æ•°æ®åº“ä¸­çš„è®¢å•é¢„å èµ„é‡‘æ²¡æœ‰é‡Šæ”¾ï¼ŒçŠ¶æ€æœºæ˜¯ä¸æ˜¯æœ€ç»ˆæ€ç›‘æ§ï¼Œå•ä½çª—å£æ—¶é—´å†…ä¸šåŠ¡çŠ¶æ€æ˜¯å¦å¼‚å¸¸ï¼Œè´¦æˆ·ä¸­çš„é¢„æ‰£å‡é‡‘é¢æ˜¯å¦é‡Šæ”¾ï¼Œä¸šåŠ¡é‡è¯•æ¬¡æ•°æ˜¯å¦è¶…è¿‡é˜ˆå€¼ç­‰ç­‰ä¸šåŠ¡ç›‘æ§ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;å››-æ€»ç»“&#34;&gt;å››ã€æ€»ç»“&lt;/h2&gt;
&lt;p&gt;â€ƒåˆ†å¸ƒå¼åœºæ™¯ï¼Œè¦ç”¨åˆ†å¸ƒå¼çš„æ€ç»´å»æ€è€ƒé—®é¢˜ã€‚è¦è€ƒè™‘ä»»ä½•çš„è¶…æ—¶ï¼Œæ–­ç”µï¼Œç»´æŠ¤ä¸åŒç‰©ç†å­˜å‚¨çš„æ•°æ®çš„å¯èƒ½å­˜åœ¨çš„çŠ¶æ€ä¸ä¸€è‡´çš„åœºæ™¯ï¼Œè¯´ç™½äº†è¦é¢å‘å¤±è´¥ç¼–ç¨‹ã€‚&lt;/p&gt;
&lt;h2 id=&#34;äº”-å‚è€ƒ&#34;&gt;äº”ã€å‚è€ƒ&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;æœ‰èµå‡ºé‡‘ç³»ç»Ÿâ€”â€”https://tech.youzan.com/build-a-withdraw-sys/&lt;/li&gt;
&lt;li&gt;åˆ†å¸ƒå¼äº‹åŠ¡çš„æ€è€ƒâ€”â€”https://www.cnblogs.com/sujing/p/11006424.html&lt;/li&gt;
&lt;li&gt;é˜¿é‡Œäº‘RocketMQæ–‡æ¡£â€”â€”https://help.aliyun.com/document_detail/43348.html&lt;/li&gt;
&lt;/ul&gt;
">é‡‘èçº§ä¸šåŠ¡ä¸‹åˆ†å¸ƒå¼äº‹åŠ¡ä¿è¯æ•°æ®ä¸€è‡´æ€§</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://zhangyaoo.github.io/post/er-jin-zhi-fan-zhuan/"" data-c="
          &lt;h4 id=&#34;é¢˜ç›®æè¿°&#34;&gt;é¢˜ç›®æè¿°&lt;/h4&gt;
&lt;p&gt;ç»™å®šä¸€ä¸ª32ä½æ•´æ•° . è¾“å‡ºäºŒè¿›åˆ¶è¡¨ç¤ºåè½¬åçš„å€¼.&lt;br&gt;
ä¾‹å¦‚ input 43261596ï¼ˆäºŒè¿›åˆ¶ 00000010100101000001111010011100ï¼‰&lt;br&gt;
è¿”å› output 964176192ï¼ˆäºŒè¿›åˆ¶ 00111001011110000010100101000000ï¼‰&lt;/p&gt;
&lt;p&gt;ç›®å‰ç¬”è€…å°±æƒ³åˆ°äº†æ—¶é—´å¤æ‚åº¦åœ¨O(N)çš„è§£å†³æ€è·¯ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å¾ªç¯åˆ¤æ–­è¾“å…¥æ•°æ®çš„ä½ä½æ˜¯0è¿˜æ˜¯1ï¼Œå…·ä½“åˆ¤æ–­æ–¹æ³•æ˜¯å’Œ1è¿›è¡Œä¸æ“ä½œ&lt;/li&gt;
&lt;li&gt;å¦‚æœåˆ¤æ–­æ˜¯ï¼Œè¿”å›çš„ç»“æœ+1ï¼Œä¸æ˜¯1é‚£ä¹ˆä¸åšä»»ä½•å¤„ç†&lt;/li&gt;
&lt;li&gt;æ¯æ¬¡å¾ªç¯ï¼Œinputçš„æ•°æ®å‘å·¦ç§»ä¸€ä½ï¼Œoutputæ•°æ®å‘å³ç§»åŠ¨ä¸€ä½&lt;/li&gt;
&lt;li&gt;å¾ªç¯32æ¬¡ï¼Œè¿”å›ç»“æœ&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
    *  äºŒè¿›åˆ¶æ•°æ®åè½¬
    */
public class BitReverse {

    public static int reverse(int n) {
        int result = 0;
        for (int i = 0; i &amp;lt; 32; i++) {
            result = result &amp;lt;&amp;lt; 1;
            if ((n &amp;amp; 1) == 1) {
                result++;
            }
            n = n &amp;gt;&amp;gt; 1;
        }
        return result;
    }

    public static void main(String[] args){
        System.out.println(reverse(1&amp;lt;&amp;lt;30));
        System.out.println(1&amp;lt;&amp;lt;30);
    }
}
&lt;/code&gt;&lt;/pre&gt;
">O(N)æ—¶é—´å¤æ‚åº¦ä¸‹ï¼ŒäºŒè¿›åˆ¶åè½¬</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://zhangyaoo.github.io/post/guan-yu-xi-tong-xing-neng-ping-jing-yu-ce-he-xi-tong-xing-neng-you-hua/"" data-c="
          &lt;h3 id=&#34;å‰è¨€&#34;&gt;å‰è¨€&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;å¯¹äºä»»ä½•ç³»ç»Ÿï¼Œéƒ½ä¼šå­˜åœ¨ç³»ç»Ÿæ€§èƒ½ç“¶é¢ˆï¼Œè¿™é‡Œç¬”è€…ä½œä¸ºä¸€åJavaå·¥ç¨‹å¸ˆåˆ—å‡ºäº†è‡ªå·±åœ¨å·¥ä½œä¸­çš„ä¼˜åŒ–æ€è·¯ï¼Œä»…ä¾›å‚è€ƒã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;ä¸€-ç³»ç»Ÿæ€§èƒ½é¢„æµ‹&#34;&gt;ä¸€ã€ç³»ç»Ÿæ€§èƒ½é¢„æµ‹&lt;/h2&gt;
&lt;p&gt;â€ƒä»»ä½•ä¸€ä¸ªç³»ç»Ÿéƒ½æ˜¯ä»0åˆ°1æ…¢æ…¢å‘å±•çš„ï¼Œå½“ç³»ç»Ÿä¸šåŠ¡éšç€æ—¶é—´çš„æ¨ç§»ï¼Œä¸šåŠ¡é‡å’Œæµé‡éšä¹‹å¢å¤§ï¼Œç³»ç»Ÿæ€§èƒ½å°±éšç€å‡¸æ˜¾å‡ºæ¥ã€‚è¿™ä¸ªæ—¶å€™ï¼Œå¼€å‘äººå‘˜å’Œæ¶æ„å¸ˆè¦ä»æ¶æ„å±‚é¢ã€ä»£ç å±‚é¢ã€äº§å“ä¸šåŠ¡å±‚é¢ç­‰ä¸€ä¸€å»æ¼”è¿›ä¸šåŠ¡ç³»ç»Ÿæ¥ç»´æŒé«˜æµé‡ä¸‹ç³»ç»Ÿç¨³å®šæ€§ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒç°åœ¨æœåŠ¡éƒ½æ˜¯å¾®æœåŠ¡éƒ¨ç½²å¼€å‘ï¼Œå¦‚æœè¦æ¨¡æ‹ŸæœåŠ¡å‹æµ‹çš„è¯è¦åœ¨æœ¬åœ°å¼€å¯ç›¸åŒçš„æœåŠ¡ï¼Œå‰ææ˜¯æœºå™¨é…ç½®æ˜¯ä¸€æ ·çš„ã€‚è€Œä¸”éœ€è¦å°†çº¿ä¸Šçš„æŒä¹…åŒ–æ•°æ®åŒæ ·copyåˆ°æœ¬åœ°æ•°æ®åº“ä¸­ï¼Œè¿™æ ·æ‰èƒ½çœŸæ­£æ¨¡æ‹Ÿçº¿ä¸Šçš„ç¯å¢ƒã€‚æ‹¿å•å°æœºå™¨è¿›è¡Œå‹æµ‹ï¼Œå‹æµ‹çš„å¯¹è±¡å¯ä»¥æ˜¯æŸä¸ªæ ¸å¿ƒçš„æ¥å£æˆ–è€…ä¸šåŠ¡æ¨¡å—ï¼ˆè¿™ä¸ªæ¥å£å¯ä»¥æ˜¯æ—¥å¿—æœåŠ¡ä¸­ç»Ÿè®¡çš„è®¿é—®é‡æ¯”è¾ƒé«˜çš„å…·ä½“çš„æ¥å£APIï¼‰ï¼Œå‹æµ‹çš„æŒ‡æ ‡å¯ä»¥æ˜¯ååé‡ï¼Œå¹³å‡å“åº”æ—¶é—´ï¼Œæœ€å¤§å“åº”æ—¶é—´ï¼ŒTPSï¼ŒQPSç­‰ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒé€šè¿‡æ€§èƒ½æŒ‡æ ‡å¯ä»¥åº¦é‡ç›®å‰å­˜åœ¨çš„æ€§èƒ½é—®é¢˜ï¼ŒåŒæ—¶ä½œä¸ºæ€§èƒ½ä¼˜åŒ–çš„è¯„ä¼°ä¾æ®ã€‚å…·ä½“çš„æŒ‡æ ‡ä¸»è¦æ˜¯è¦åˆ†æç³»ç»Ÿçš„QPSã€TPSã€å¹³å‡å“åº”æ—¶é—´ä»¥åŠæœ€å¤§å“åº”æ—¶é—´ï¼Œæˆ‘ä»¬é¢„æµ‹ä¸€ä¸ªå•ä½“çš„åº”ç”¨èƒ½å¤Ÿæ‰¿å—å¤šå°‘çš„å¹¶å‘é‡ï¼Œçœ‹è¿™è¿™äº›æŒ‡æ ‡æ˜¯å¦èƒ½å¤Ÿè¾¾åˆ°æˆ‘ä»¬é¢„æœŸçš„å€¼ï¼Œæ¯”å¦‚ä½œä¸ºä¸€ä¸ªå¥åº·çš„ç³»ç»Ÿï¼Œæœ€å¤§å“åº”æ—¶é—´ä¸è¶…è¿‡1sã€‚åé¢è¿›è¡Œå‹æµ‹æ—¶å€™ï¼Œè§‚å¯Ÿæµé‡å·…å³°æ—¶åˆ»è§‚å¯Ÿç³»ç»Ÿçš„è¿è¡Œæƒ…å†µã€‚ä»¥ä¸‹å°±æ€§èƒ½åˆ†æä¼˜åŒ–å±•å¼€æ€»ç»“ã€‚&lt;br&gt;
&lt;br&gt;&lt;/p&gt;
&lt;h2 id=&#34;äºŒ-ç³»ç»Ÿæ€§èƒ½åˆ†æä¼˜åŒ–&#34;&gt;äºŒã€ç³»ç»Ÿæ€§èƒ½åˆ†æä¼˜åŒ–&lt;/h2&gt;
&lt;h3 id=&#34;1-ç¡¬ä»¶æ–¹é¢&#34;&gt;1ã€ç¡¬ä»¶æ–¹é¢ï¼š&lt;/h3&gt;
&lt;h5 id=&#34;cpu&#34;&gt;CPUï¼š&lt;/h5&gt;
&lt;p&gt;â€ƒåœ¨å‹æµ‹çš„æ—¶å€™è§‚å¯ŸCPUçš„å ç”¨æƒ…å†µï¼Œæ˜¯å¦é•¿æœŸå¤„äº100%çŠ¶æ€ï¼Œæ­£å¸¸æ¥è¯´80%ä»¥ä¸‹æ˜¯æ­£å¸¸çš„ã€‚å¦‚æœéå¸¸ä½ï¼Œé‚£ä¹ˆè¯´æ˜ç³»ç»Ÿä¸æ˜¯åœ¨åšIOå¯†é›†å‹è¿ç®—åŠ¨ä½œï¼Œæ€§èƒ½ç“¶é¢ˆæ˜¯åœ¨å…¶ä»–æ–¹é¢ï¼Œä¸æ˜¯åœ¨CPUä¸Šé¢ï¼Œå…·ä½“çš„æ“ä½œæ–¹æ³•å¯ä»¥ç”¨topå‘½ä»¤æŸ¥çœ‹ã€‚&lt;br&gt;
â€ƒä»¥ç¬”è€…ç»éªŒæ¥çœ‹ï¼Œä¸€èˆ¬CPUé£™é«˜çš„åŸå› æ— éä¸‰ç§ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ç¬¬ä¸€ç§å°±æ˜¯ä»£ç ä¸­å­˜åœ¨æ­»å¾ªç¯ï¼Œå¹¶ä¸”å¾ªç¯ä¸­æœ‰å¤§é‡çš„CPUè®¡ç®—æ“ä½œï¼›&lt;/li&gt;
&lt;li&gt;ç¬¬äºŒç§å°±æ˜¯å¤šçº¿ç¨‹å¹¶å‘ä¸‹ï¼Œç«äº‰ç›¸åŒçš„èµ„æºå¯¼è‡´å¤§é‡çº¿ç¨‹è·å–ä¸åˆ°èµ„æºï¼Œå¦‚æœæ­¤æ—¶çº¿ç¨‹è¿›è¡Œè‡ªæ—‹æ“ä½œï¼Œä¸é‡Šæ”¾CPUèµ„æºï¼Œé‚£å°±å¯¼è‡´CPUé£™å‡ï¼›&lt;/li&gt;
&lt;li&gt;ç¬¬ä¸‰ç§å°±æ˜¯ä»£ç ä¸­æœ‰å†…å­˜æ³„æ¼ï¼Œå¯¼è‡´å†…å­˜ä¸€ç›´å¤„äºé˜ˆå€¼çŠ¶æ€ï¼ŒGCçº¿ç¨‹ä¼šæŒç»­GCï¼Œå¯¼è‡´CPUé£™é«˜ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;â€ƒä¸Šé¢ä¸‰ç§æƒ…å†µä¸­ç¬¬äºŒç§å’Œç¬¬ä¸‰ç§æƒ…å†µåœ¨æ—¥å¸¸å¼€å‘å·¥ä½œä¸­ä¼šé‡åˆ°ï¼Œå¯¹äºç¬¬äºŒç§æƒ…å†µå¯¹äºè‡ªæ—‹é”æƒ…å†µï¼Œä¸€èˆ¬ä¼šç”¨CASä¹è§‚é”å»å®ç°ï¼Œå¹¶ä¸”è®¾ç½®ä¸€å®šçš„è¶…æ—¶æ—¶é—´å’Œé‡è¯•æ¬¡æ•°ï¼Œç„¶åè¿”å›å¤±è´¥æˆ–è€…è¿›å…¥é˜»å¡é˜Ÿåˆ—é‡Šæ”¾CPUåˆ†ç‰‡ï¼Œé˜²æ­¢çº¿ç¨‹ä¸€ç›´å ç”¨CPUèµ„æºã€‚&lt;br&gt;
â€ƒå¯¹äºç¬¬ä¸‰ç§æƒ…å†µï¼Œå°±æ˜¯ä»£ç çš„BUGï¼Œå¼€å‘è¿‡ç¨‹ä¸­è¦æ³¨æ„æ³„æ¼çš„é—®é¢˜ï¼Œå°±æ¯”å¦‚å¤šçº¿ç¨‹æ“ä½œé“¾è¡¨ï¼Œå¦‚æœæ²¡æœ‰åšåŒæ­¥çš„é”ï¼Œé‚£ä¹ˆå¾ˆæœ‰å¯èƒ½å¯¼è‡´é“¾è¡¨çš„å¼•ç”¨æŒ‡é’ˆæ··ä¹±ï¼Œå¼•èµ·å†…å­˜æ³„æ¼ã€‚&lt;br&gt;
â€ƒä»¥ä¸Šï¼Œå¦‚æœæˆ‘ä»¬å¼€å‘å·¥ä½œä¸­é¿å…äº†ä¸Šè¿°å‡ ç§æƒ…å†µï¼ŒCPUå°±èƒ½å¤Ÿå‘æŒ¥å®ƒåº”è¯¥æœ‰çš„èƒ½åŠ›ï¼Œæå‡ç³»ç»Ÿæ€§èƒ½ã€‚åŒæ—¶ï¼Œå¼€å‘äººå‘˜åšå¥½ç¡¬ä»¶CPUç›‘æ§æ˜¯éå¸¸æœ‰å¿…è¦çš„ã€‚&lt;/p&gt;
&lt;h5 id=&#34;å†…å­˜&#34;&gt;å†…å­˜ï¼š&lt;/h5&gt;
&lt;p&gt;â€ƒ åœ¨Javaä¸­ï¼Œå†…å­˜JVMæ˜¯ä¸€ä¸ªå¾ˆé‡è¦çš„æŒ‡æ ‡ï¼Œè¿™ä¸ªå…³ä¹åˆ°ç³»ç»Ÿæ˜¯å¦å¯ä»¥ç¨³å®šè¿è¡Œã€‚æˆ‘ä»¬å¯ä»¥å€ŸåŠ©ä¸‰æ–¹å·¥å…·å¯ä»¥æŸ¥çœ‹ç³»ç»Ÿçš„JVMå†…å­˜çš„è¿è¡Œæƒ…å†µï¼Œç¬”è€…æä¾›å‡ ä¸ªé€šç”¨çš„é¢„æµ‹å†…å­˜çš„è¿è¡Œæƒ…å†µçš„æ€è·¯ï¼š&lt;br&gt;
- æ¯ç§’å ç”¨å¤šå°‘å†…å­˜ï¼Ÿ&lt;br&gt;
- å¤šé•¿æ—¶é—´è§¦å‘ä¸€æ¬¡Minor GCï¼Ÿ&lt;br&gt;
- å¤šé•¿æ—¶é—´è§¦å‘ä¸€æ¬¡Major GCï¼Ÿ&lt;br&gt;
- Minor  GCè€—æ—¶å¤šä¹…ï¼ŸMajor  GCè€—æ—¶å¤šä¹…ï¼Ÿ&lt;br&gt;
- ä¼šä¸ä¼šé¢‘ç¹å› ä¸ºSurvivoræ”¾ä¸ä¸‹å¯¼è‡´å¯¹è±¡è¿›å…¥è€å¹´ä»£ï¼Ÿ&lt;/p&gt;
&lt;p&gt;åœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œå¼€å‘äººå‘˜éœ€è¦å…³æ³¨çš„å°±æ˜¯ï¼Œåˆ¤æ–­ç³»ç»ŸJVMæ˜¯å¦æœ‰é¢‘ç¹FULL GCå’Œé¢‘ç¹YOUNG GCï¼Œå¦‚æœæœ‰ï¼Œé‚£ä¹ˆä¼šä¸¥é‡å½±å“ç³»ç»Ÿæ€§èƒ½ã€‚ç¬”è€…å°±è¿™ä¸¤ä¸ªæ–¹é¢å»åˆ†æä¸€ä¸‹&lt;br&gt;
â€ƒâ€ƒ 1ã€&lt;strong&gt;é¢‘ç¹FULL GC&lt;/strong&gt; ï¼šé¦–å…ˆæˆ‘ä»¬åº”è¯¥è¦äº†è§£åˆ°é¢‘ç¹FULL GCå±å®³ï¼Œä¸€èˆ¬çš„ä¸­å¤§å‹ç³»ç»Ÿï¼Œç³»ç»Ÿçš„JVMä¼šè®¾ç½®å¾ˆå¤§ï¼Œæ¯”å¦‚ä¼šç»™å †å†…å­˜åˆ†é…4~8Gçš„ç©ºé—´ï¼Œå› ä¸ºéå†å¯¹è±¡å›¾çš„è¿‡ç¨‹ä¸­å †è¶Šå¤§ï¼Œéå†æ—¶é—´å°±ä¼šé•¿ï¼Œè€Œä¸”å¦‚æœåƒåœ¾è¶Šå¤šï¼Œåƒåœ¾å›æ”¶ä¹Ÿä¼šæ‹‰é•¿æ•´ä¸ªGCçš„æ—¶é—´ï¼Œè¿™å°±å¯¼è‡´æ¯ä¸€æ¬¡FULL GCä¼šæœ‰é•¿æ—¶é—´çš„STWï¼Œå½±å“ç³»ç»Ÿç¨³å®šæ€§ã€‚ç„¶åæˆ‘ä»¬è¦æ¸…æ¥šå¯¼è‡´è§¦å‘Full GCçš„åœºæ™¯ï¼Œè¿™é‡Œåˆ—å‡ºäº†å¯èƒ½ä¼šå¯¼è‡´çš„å‡ ä¸ªåœºæ™¯ï¼š&lt;br&gt;
â€ƒâ€ƒ1ï¼‰å¤§å¯¹è±¡&lt;br&gt;
â€ƒâ€ƒ2ï¼‰æ–¹æ³•åŒºmeta spaceç©ºé—´å æ»¡&lt;br&gt;
â€ƒâ€ƒ3ï¼‰å¹´è½»ä»£çš„å­˜æ´»çš„ç”Ÿå‘½å‘¨æœŸé•¿å¯¹è±¡ä¸€ç›´æ±‡å…¥è€å¹´ä»£ï¼Œå¯¼è‡´GC&lt;br&gt;
â€ƒâ€ƒ4ï¼‰å†…å­˜æ³„æ¼å¯¼è‡´ç©ºé—´ä¸è¶³è¿›è€ŒGC&lt;br&gt;
è¿™é‡Œç¬”è€…å°±æ‹¿å†…å­˜æ³„æ¼ï¼ˆå†…å­˜æ³„æ¼æŒ‡çš„æ˜¯æœ‰å¼•ç”¨æ— æ³•è¢«å›æ”¶ä½†æ˜¯æ²¡æœ‰ç”¨çš„å¯¹è±¡æŒç»­å¢é•¿ï¼‰æ¥è¯´ï¼Œä¸€èˆ¬å¦‚æœæœ‰å†…å­˜æ³„æ¼ã€‚å¤§æ¦‚çš„å†…å­˜ç›‘æ§å›¾é•¿è¿™ä¸ªæ ·å­&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1592463486063.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
è¿™æ ·å¯¼è‡´çš„åæœå°±æ˜¯ï¼Œé¢‘ç¹çš„FULL GCï¼Œæœ€åå†…å­˜ä¸€ç›´æŒç»­å¢é•¿åˆ°çˆ†æ»¡ï¼Œç„¶åFULL GCæ‰§è¡Œé—´éš”ç¼©çŸ­ï¼Œæœ€ç»ˆä¼šå¯¼è‡´GCçº¿ç¨‹æŒç»­GCï¼ŒCPUä½¿ç”¨ç‡ä¼šç›´çº¿é£™å‡ï¼Œå¯¼è‡´ç³»ç»Ÿç˜«ç—ªã€‚&lt;br&gt;
â€ƒâ€ƒ  2ã€ &lt;strong&gt;é¢‘ç¹ YOUNG GC&lt;/strong&gt;  ï¼šYOUNG GCå¦‚æœè¿‡äºé¢‘ç¹çš„è¯ï¼Œä¸€èˆ¬æ˜¯çŸ­å‘¨æœŸå°å¯¹è±¡è¾ƒå¤šï¼Œè¿™æ—¶å€™å¯ä»¥ä» Eden åŒº/æ–°ç”Ÿä»£è®¾ç½®çš„å¤ªå°äº†è¿™ä¸ªæ–¹é¢è€ƒè™‘ï¼Œçœ‹èƒ½å¦é€šè¿‡è°ƒæ•´-Xmnã€-XX:SurvivorRatio ç­‰å‚æ•°è®¾ç½®æ¥è§£å†³é—®é¢˜&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;è¿™é‡Œç¬”è€…ä»¥è‡ªå·±å¼€å‘ç»éªŒï¼Œæä¾›ä¸€äº›â€œç®€å•çš„â€JVMä¼˜åŒ–æ‹™è§&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å°½é‡å°†æ–°ç”Ÿä»£çš„åƒåœ¾å›æ”¶æ‰ï¼Œä¸è®©å­˜æ´»å¯¹è±¡è¿›å…¥è€å¹´ä»£ï¼Œå› ä¸ºè€å¹´ä»£çš„GCä»£ä»·æ¯”å¹´è½»ä»£é«˜ï¼Œè¿™é‡Œå¯ä»¥è®¾ç½®åˆ†ä»£å¹´é¾„-XX:MaxTenuringThreshold=XX&lt;br&gt;
â€ƒ ä¾‹å­1ï¼šæ¯”å¦‚è¯´ä¸šåŠ¡ä¸Šä¸€åˆ†é’Ÿäº§ç”Ÿå‡ ç™¾å…†çš„æ•°æ®ï¼Œè€Œä¸”éœ€è¦å­˜æ´»ä¸€åˆ†é’Ÿï¼Œå¦‚æœä¸€åˆ†é’ŸYGCçš„æ¬¡æ•°å°‘äºé»˜è®¤åˆ†ä»£å¹´é¾„ï¼Œé‚£ä¹ˆå¯¹è±¡ä¼šè¿›å»è€å¹´ä»£å¼•å‘FGCï¼ŒFGCä¼šå¼•èµ·æ›´å¤§çš„åœé¡¿æ—¶é—´&lt;br&gt;
â€ƒ ä¾‹å­2ï¼šå¦‚æœè¯´å¯¹è±¡éƒ½æ˜¯ä¸€äº›çŸ­æœŸå¯¹è±¡ï¼Œé‚£ä¹ˆå¯ä»¥è®¾ç½®åˆ†ä»£å¹´é¾„æ›´å°ï¼Œå› ä¸ºé•¿æœŸå¯¹è±¡è‚¯å®šæ˜¯å¤§å¯¹è±¡æˆ–è€…å•ä¾‹å¯¹è±¡æ°¸é©»å†…å­˜çš„ï¼Œè¿™æ ·å¯ä»¥è…¾å‡ºç©ºé—´ç»™æ–°ç”Ÿä»£GCï¼Œé¿å…æ–°ç”Ÿä»£é¢‘ç¹GC&lt;/li&gt;
&lt;li&gt;å¢åŠ æ–°ç”Ÿä»£å†…å­˜çš„å¤§å°ï¼Œé˜²æ­¢å¯¼è‡´é¢‘ç¹çš„minor GCï¼Œè¿™æ ·è€å¹´ä»£çš„Major GCé¢‘ç‡ä¹Ÿä¼šé™ä½&lt;/li&gt;
&lt;li&gt;å°½é‡å°†å¤§å†…å­˜çš„æœåŠ¡ï¼Œæ‹†åˆ†æˆå‡ ä¸ªç›¸åŒæœåŠ¡ï¼Œä¹Ÿå°±æ˜¯å¤šå®ä¾‹éƒ¨ç½²ï¼Œåˆ†æ•£å †å†…å­˜èµ„æºï¼Œé¿å…å †å¤§å†…å­˜å¯¼è‡´GCæ—¶é—´è¿‡é•¿ï¼ˆè¿™ä¸ªå’ŒG1åˆ†åŒºå›æ”¶æ€æƒ³ç›¸ä¼¼ï¼‰&lt;/li&gt;
&lt;li&gt;æ¯ä¸ªçº¿ç¨‹å ç”¨çš„å†…å­˜ä¸åº”è¿‡å¤§æˆ–è€…è¿‡å°ï¼Œä¸ç„¶ä¼šå¯¼è‡´OOM&lt;br&gt;
â€ƒ å¦‚æœçº¿ç¨‹å†…å­˜è¿‡å°ï¼Œä¼šå¯¼è‡´çº¿ç¨‹é‡Œé¢çš„æ ˆå†…å­˜å°ï¼Œä¸´æ—¶å˜é‡å¦‚æœè¶…å‡ºè¿™ä¸ªé˜ˆå€¼å°±ä¼šæ— æ³•åˆ†é…æ ˆï¼Œå¯¼è‡´æ ˆæº¢å‡ºï¼Œå‡ºç°stackoverflow&lt;br&gt;
â€ƒ å¦‚æœçº¿ç¨‹å†…å­˜è¿‡å¤§ï¼Œåœ¨å¤šçº¿ç¨‹å¹¶å‘ä¸‹ï¼Œå¦‚æœçº¿ç¨‹æ•°é‡è¿‡å¤šï¼Œä¼šå ç”¨éå¸¸å¤šJVMå†…å­˜ï¼Œæœ‰å†…å­˜æº¢å‡ºçš„é£é™©&lt;/li&gt;
&lt;li&gt;åˆç†è®¾ç½®åƒåœ¾å›æ”¶å™¨ï¼Œåœ¨å¤§å†…å­˜æˆ–è€…åœ¨å†…å­˜ç¢ç‰‡åŒ–ç¯å¢ƒä¸‹ï¼ŒG1åƒåœ¾å›æ”¶å™¨ä¼šæœ‰å¾ˆå¥½çš„æ•ˆæœ&lt;br&gt;
â€ƒ G1åƒåœ¾å›æ”¶å™¨æ˜¯Java9é»˜è®¤å›æ”¶å™¨ï¼ŒG1èƒ½å¤Ÿåœ¨æŒ‡å®šçš„åœé¡¿æ—¶é—´å†…ï¼Œæ ¹æ®æ¯ä¸ªregionçš„å›æ”¶ä»·å€¼ï¼Œé€‰æ‹©å¯ä»¥å»å›æ”¶çš„regionï¼Œå¹¶ä¸”å­˜æ´»å¯¹è±¡ç§»åŠ¨å¤åˆ¶æ˜¯å¤šçº¿ç¨‹è¿›è¡Œçš„ã€‚è¿™é‡Œè¦æ³¨æ„å¦‚æœè®¾ç½®åœé¡¿æ—¶é—´çš„è¯ï¼Œä¸èƒ½è®¾ç½®å¤ªå°ï¼Œå› ä¸ºå¤ªå°ä¼šå¯¼è‡´æ¯æ¬¡è¿›è¡Œå›æ”¶çš„regionå¤ªå°‘ï¼Œå¯¼è‡´åƒåœ¾å›æ”¶é€Ÿåº¦æ›´ä¸ä¸Šåƒåœ¾ç”Ÿäº§çš„é€Ÿåº¦ï¼Œè¿™æ ·éšç€æ—¶é—´æ¨ç§»ï¼Œç³»ç»Ÿåƒåœ¾å¯¹è±¡ä¼šè¶Šæ¥è¶Šå¤šï¼Œå æ»¡JVM&lt;/li&gt;
&lt;li&gt;å¯¹è±¡ç”Ÿå‘½å‘¨æœŸçš„åˆ†å¸ƒæƒ…å†µï¼šå¦‚æœåº”ç”¨å­˜åœ¨å¤§é‡çš„çŸ­æœŸå¯¹è±¡ï¼Œåº”è¯¥é€‚å½“å¢å¤§å¹´è½»ä»£ -Xmnï¼›å¦‚æœå­˜åœ¨ç›¸å¯¹è¾ƒå¤šçš„æŒä¹…å¯¹è±¡ï¼Œè€å¹´ä»£åº”è¯¥é€‚å½“å¢å¤§ã€‚-Xms -Xmx&lt;/li&gt;
&lt;li&gt;Xmså’ŒXmxä¹Ÿè®¾ç½®ä¸ºç›¸åŒï¼Œè¿™æ ·å¯ä»¥å‡å°‘å†…å­˜è‡ªåŠ¨æ‰©å®¹å’Œæ”¶ç¼©å¸¦æ¥çš„æ€§èƒ½æŸå¤±&lt;/li&gt;
&lt;li&gt;è®¾ç½®å¤§å¯¹è±¡å¯¹è±¡çš„å¤§å°ï¼Œä¸€èˆ¬ç³»ç»Ÿä¸­å¤§å¯¹è±¡å¤§éƒ¨åˆ†éƒ½æ˜¯ä¸€äº›ç³»ç»Ÿçš„ç¼“å­˜ï¼Œåƒè¿™äº›å¯¹è±¡å°½æ—©è®©å®ƒä»¬çš„è¿›å…¥è€å¹´ä»£ï¼Œé¿å…å ç”¨æ–°ç”Ÿä»£çš„ç©ºé—´ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä»¥ä¸Šï¼Œåˆç†åˆ†é…JVMå†…å­˜èµ„æºä»¥åŠåšå¥½ç³»ç»Ÿå†…å­˜çš„ç›‘æ§æœºåˆ¶æ˜¯æˆ‘ä»¬ç³»ç»Ÿç¨³å®šæ€§è¿è¡Œçš„ä¿éšœã€‚&lt;/p&gt;
&lt;h5 id=&#34;ç½‘ç»œè´Ÿè½½å’Œio&#34;&gt;ç½‘ç»œè´Ÿè½½å’ŒIO&lt;/h5&gt;
&lt;p&gt;æ¥ä¸€å¼ IOå‘ç”Ÿåœºæ™¯å›¾ç‰‡ï¼š&lt;br&gt;
&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1593333928024.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
â€ƒå¯¹äºç£ç›˜IOï¼Œæˆ‘ä»¬å¯ä»¥ç”¨Linuxä¸‹çš„iostatå‘½ä»¤å»æŸ¥çœ‹å½“å‰IOè´Ÿè½½çš„æƒ…å†µï¼Œæ¯”å¦‚r_waitå’Œw_waitæŒ‡æ ‡ï¼Œè¿™äº›æŒ‡æ ‡è¾ƒå¤§åˆ™è¯´æ˜I/Oè´Ÿè½½è¾ƒå¤§ï¼ŒI/Oç­‰å¾…æ¯”è¾ƒä¸¥é‡ï¼Œç£ç›˜è¯»å†™é‡åˆ°ç“¶é¢ˆã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬è¦çœ‹å‹æµ‹çš„æ¥å£æ˜¯å¦æœ‰æ–‡ä»¶è¯»å–å’Œå†™å…¥çš„æ“ä½œï¼Œå¦‚æœæœ‰è¯´æ˜æ¥å£æ€§èƒ½ç“¶é¢ˆåœ¨äºæ–‡ä»¶è¯»å†™ï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥åˆ©ç”¨æ–‡ä»¶bufferç¼“å­˜APIç­‰åŠŸèƒ½è¿›è¡Œä¼˜åŒ–ï¼Œæˆ–è€…å¯ä»¥ç”¨å¼‚æ­¥çš„æ–¹å¼è¿›è¡Œæ–‡ä»¶è¯»å†™ã€‚&lt;br&gt;
â€ƒç¬”è€…åœ¨å¼€å‘ä¸­å°±é‡åˆ°å› ä¸ºIOé—®é¢˜å¸¦æ¥çš„çº¿ç¨‹èµ„æºè€—å°½çš„çº¿ä¸Šé—®é¢˜ï¼šæˆ‘ä»¬ç³»ç»Ÿä¸šåŠ¡åœ¨å€Ÿè´·ä¸šåŠ¡æˆåŠŸåï¼Œè¦ç”Ÿæˆå€Ÿæ¬¾åè®®ï¼Œåè®®æ˜¯ä¸€ä¸ªPDFæ–‡ä»¶ï¼Œå½“æ—¶ä¸»ä¸šåŠ¡é€»è¾‘å®ŒæˆååŒæ­¥è°ƒç”¨ç”ŸæˆPDFçš„é€»è¾‘ï¼Œå› ä¸ºå½“æ—¶å¤§æµé‡å¹¶å‘ï¼Œå¯¼è‡´æ•´ä¸ªå€Ÿè´·ä¸šåŠ¡æ€§èƒ½ç“¶é¢ˆå°±åœ¨ç£ç›˜IOä¸Šï¼ŒCPUå¤„äºç©ºé—²çŠ¶æ€ï¼Œå€Ÿç”¨ç½‘ä¸Šçš„ä¸€ä¸ªå›¾ï¼ŒTOPå‘½ä»¤å¯ä»¥çœ‹å‡ºIOèŠ±è´¹çš„æ—¶é—´åœ¨76.6%ï¼Œåé¢ä¼˜åŒ–åå°±å¤šçº¿ç¨‹å¼‚æ­¥å¤„ç†ã€‚&lt;br&gt;
&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1593334249512.webp&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;â€ƒå¯¹äºç½‘ç»œè´Ÿè½½ï¼Œå› ä¸ºç½‘ç»œè´Ÿè½½æˆ–è€…ç½‘ç»œå µå¡æ˜¯ä¸å—æ§åˆ¶çš„ï¼Œè¿™ä¸ªæ¶‰åŠåˆ°åº•å±‚çš„TCPé€šä¿¡çš„ä¼˜åŒ–ï¼ˆæ¯”å¦‚åˆ©ç”¨æ»‘åŠ¨çª—å£å’Œæ‹¥å¡æ§åˆ¶ï¼‰ï¼Œè¿™ä¸ªå°±ä¸å±•å¼€è®¨è®ºã€‚å·¥ç¨‹å¸ˆå¯æ§èŒƒå›´å¯ä»¥æ˜¯é€‰æ‹©IOè¯»å†™é«˜æ•ˆç‡çš„ä¸­é—´ä»¶ï¼Œæ¯”å¦‚redisã€tomcatã€activeMqã€nginxã€dubboã€nettyç­‰ï¼Œè¿™äº›ä¸­é—´ä»¶çš„åº•å±‚IOæ¨¡å‹çš„æ˜¯å¤šè·¯å¤ç”¨IOï¼Œå¤šè·¯å¤ç”¨IOæŒ‡çš„æ˜¯ä¸€ä¸ªIOçº¿ç¨‹èƒ½å¤ŸæœåŠ¡äºå¤šä¸ªsocketè¿æ¥ï¼Œçº¿ç¨‹ç›‘å¬æ¯ä¸ªè¿æ¥çš„èµ„æºæè¿°ç¬¦ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1593334346151.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;â€ƒåˆ†å¸ƒå¼å¾®æœåŠ¡ç¯å¢ƒä¸‹ï¼ŒæœåŠ¡ä¹‹é—´çš„RPCåŒæ­¥è°ƒç”¨ä¼šéå¸¸é¢‘ç¹ï¼Œéšä¹‹æœåŠ¡ä¹‹é—´çš„ç½‘ç»œè´Ÿè½½ä¼šå½±å“åˆ°æ•´ä¸ªç³»ç»Ÿçš„æœåŠ¡æ€§èƒ½ï¼Œå› æ­¤ï¼Œæ¯ä¸ªæœåŠ¡çš„æœºå™¨æ”¾ç½®åˆ°åŒä¸€ä¸ªå±€åŸŸç½‘ä¸‹æ€§èƒ½æ•ˆæœä¼šå¾ˆå¥½ã€‚è€Œä¸”ï¼Œå¯¹äºæœåŠ¡ä¹‹é—´çš„è°ƒç”¨ï¼Œæœ€å¥½åˆ©ç”¨è‡ªç ”æˆ–è€…ç¬¬ä¸‰æ–¹ä¸­é—´ä»¶å»ç›‘æ§æœåŠ¡é“¾è·¯è°ƒç”¨çš„æ•´ä½“æƒ…å†µï¼ˆæ¯”å¦‚Zipkinæˆ–è€…SkyWalking ï¼‰,å¹¶ä¸”è¦åˆç†è®¾ç½®æœåŠ¡ä¸æœåŠ¡ä¹‹é—´çš„è¶…æ—¶æ—¶é—´ï¼Œé¿å…å› ä¸ºç½‘ç»œåŸå› å¯¼è‡´æœåŠ¡çº¿ç¨‹æ± è€—å°½ï¼Œå¯¼è‡´OOMã€‚&lt;/p&gt;
&lt;h3 id=&#34;2-ä¸­é—´ä»¶å±‚&#34;&gt;2ã€ä¸­é—´ä»¶å±‚&lt;/h3&gt;
&lt;p&gt;â€ƒ è¿™é‡Œä¸­é—´ä»¶ï¼Œæ³›æŒ‡æ•°æ®å­˜å‚¨å±‚ï¼Œä»¥ç¬”è€…ç»éªŒæ¥çœ‹ï¼Œå¤§å¤šæ•°ç³»ç»Ÿæ€§èƒ½é—®é¢˜å’Œç“¶é¢ˆéƒ½æ˜¯ä¸æ•°æ®å­˜å‚¨ç›¸å…³ï¼Œè¿™é‡Œç¬”è€…å°±æ‹¿è¿™æ–¹é¢å±•å¼€è®¨è®ºæ€»ç»“ã€‚&lt;/p&gt;
&lt;h5 id=&#34;mysql&#34;&gt;MySQL&lt;/h5&gt;
&lt;p&gt;ä¸€èˆ¬æ¥è¯´MySQLåœ¨å¾ˆå¤šçº¿ç¨‹æ›´æ–°åŒä¸€è¡Œçš„åœºæ™¯ä¸‹ï¼ŒTPSæ€§èƒ½æ›²çº¿å¦‚å›¾æ‰€ç¤ºï¼Œå‚è€ƒä¸å¥‡çš„ã€Šç§’æ€åœºæ™¯ä¸‹MySQLçš„ä½æ•ˆã€‹&lt;br&gt;
&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1592893242022.png&#34; alt=&#34;ç§’æ€åœºæ™¯ä¸‹MySQLçš„ä½æ•ˆ&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
å›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œçº¿ç¨‹æ•°åœ¨6çš„æ—¶å€™TPSè¾¾åˆ°å·…å³°2Wï¼Œéšç€çº¿ç¨‹æ•°çš„å¢é•¿ï¼ŒTPSä¼šéšä¹‹é™ä½ã€‚åœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œå¯ä»¥æ ¹æ®è¿™ä¸ªç»“è®ºæ¥è¿›è¡Œä¼˜åŒ–ï¼Œæ¯”å¦‚ï¼Œå½“æœ‰ç¬é—´å¤§æµé‡å†²å‡»æ•°æ®åº“æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥è¿›è¡Œæ•°æ®ç¼“å†²ï¼Œæ¯”å¦‚ç”¨é˜Ÿåˆ—å‰Šå³°ï¼Œå¼€å¯6ä¸ªçº¿ç¨‹æ¶ˆè´¹ï¼Œç„¶åè®¿é—®æ•°æ®åº“ã€‚&lt;br&gt;
å½“ç„¶è¿™ä¸ªçœ‹ä¸šåŠ¡åœºæ™¯ï¼Œå¦‚æœæ˜¯å¯¹åŒä¸€ä¸ªèµ„æºè¿›è¡Œç«äº‰çš„è¯ï¼Œè¿™ä¸ªè¯å‰Šå³°æ˜¯å¯è¡Œçš„ã€‚ä½†æ˜¯ï¼Œå¦‚æœåœºæ™¯æ˜¯æ¯ä¸€ä¸ªçº¿ç¨‹å¯¹ä¸åŒèµ„æºè¿›è¡Œè®¿é—®ä¿®æ”¹æ—¶å€™ï¼Œä¸æ¶‰åŠèµ„æºç«äº‰çš„è¯ï¼Œé‚£ä¹ˆå°±ä¸è¦è¿›è¡Œå‰Šå³°å¤„ç†ï¼Œç›´æ¥è®¿é—®æ•°æ®åº“å³å¯ï¼Œå½“ç„¶è¿™ä¸ªä¹Ÿè¦è€ƒè™‘åˆ°MySQLçš„æ€§èƒ½é—®é¢˜ã€‚&lt;br&gt;
ä¸¾ä¸ªä¾‹å­ï¼Œå°±æ‹¿å…‰æ’å…¥æ•°æ®çš„æ€§èƒ½æµ‹è¯•æ¥è¯´ï¼ˆæ²¡æœ‰å»ºå”¯ä¸€ç´¢å¼•ï¼‰ï¼Œ4æ ¸4Gçš„7200è½¬çš„æœºæ¢°ç¡¬ç›˜æœºå™¨é…ç½®ï¼Œæœ€é«˜èƒ½å¤Ÿæ‰¿å—7500çš„å¹¶å‘æ’å…¥æ•°ã€‚[å‚è€ƒMySQLæ€§èƒ½å‹æµ‹]&lt;/p&gt;
&lt;p&gt;ä»¥ä¸Šç®—æ˜¯ä¸€ç§åœ¨ç‰¹å®šåœºæ™¯ä¸‹çš„ä¼˜åŒ–çš„æ€è·¯ï¼Œä¸‹é¢ç¬”è€…è®¨è®ºä¸€ä¸‹æ—¥å¸¸å¼€å‘ä¸­é€šç”¨çš„MySQLä¼˜åŒ–ï¼š&lt;br&gt;
1ã€é¿å…é•¿æœŸçš„äº‹åŠ¡é”å ç”¨ï¼Œé¿å…é”èŒƒå›´è¿‡å¤§ï¼Œé¿å…å•ä¸ªèµ„æºçš„å¹¶å‘ç«äº‰&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é¦–å…ˆæˆ‘ä»¬çŸ¥é“æ•°æ®åº“Innodbå­˜å‚¨å¼•æ“çš„RRå’ŒRCéš”ç¦»çº§åˆ«ä¸‹ï¼Œç±»ä¼¼updateè¯­å¥ï¼Œé”çš„é‡Šæ”¾æ—¶æœºæ˜¯åœ¨äº‹åŠ¡æäº¤ä¹‹åï¼Œè¿™ä¸ªå«åšä¸¤é˜¶æ®µé”åè®®ã€‚æ‰€ä»¥ä¸ºäº†é¿å…äº‹åŠ¡ä¹‹é—´é”åŒä¸€è¡Œæ•°æ®å‡ºç°é•¿æ—¶é—´çš„äº’ç›¸ç­‰å¾…çš„åœºæ™¯ï¼Œ&lt;strong&gt;è¦æŠŠæœ€å¯èƒ½é€ æˆé”å†²çªã€æœ€å¯èƒ½å½±å“å¹¶å‘åº¦çš„é”å°½é‡å¾€åæ”¾&lt;/strong&gt;ã€‚&lt;br&gt;
ä¸¾ä¸ªä¾‹å­ï¼Œä¸ªäººè´¦æˆ·Aè½¬è´¦ç»™å…¬å…±è´¦æˆ·Bï¼Œæµç¨‹æ˜¯ï¼šå¼€å¯äº‹åŠ¡â€”â€”ã€‹ç»™ B çš„è´¦æˆ·ä½™é¢å¢åŠ é’±ï¼›ä»è´¦æˆ· A è´¦æˆ·ä½™é¢ä¸­æ‰£é™¤é’±ï¼›è®°å½•ä¸€æ¡äº¤æ˜“æ—¥å¿—â€”â€”ã€‹ç»“æŸäº‹åŠ¡ã€‚å› ä¸ºå…¬å…±è´¦æˆ·Bå¯èƒ½è¢«å¤šä¸ªçº¿ç¨‹ä¿®æ”¹ï¼Œæ‰€ä»¥å¯ä»¥ä¼˜åŒ–ä¸ºï¼šä»è´¦æˆ· A è´¦æˆ·ä½™é¢ä¸­æ‰£é™¤é’±ï¼›è®°å½•ä¸€æ¡äº¤æ˜“æ—¥å¿—ï¼›ç»™ B çš„è´¦æˆ·ä½™é¢å¢åŠ é’±ã€‚&lt;/li&gt;
&lt;li&gt;ç„¶åï¼Œè¦å°½é‡å°†é”ç»†åŒ–ï¼Œä¸€ä¸ªå¤§é”å¯ä»¥åˆ†å‰²ä¸ºå¤šä¸ªé”ï¼Œç±»ä¼¼&lt;strong&gt;åˆ†æ®µé”æœºåˆ¶&lt;/strong&gt;ã€‚æ‹¿ç¬”è€…å…¬å¸ä¸šåŠ¡æ¥è¯´ï¼Œæ¯”å¦‚APPä¸ŠæŠ•èµ„æŸä¸€ä¸ªäº§å“æ ‡ï¼ˆåŒ…å«äº†æ ‡çš„å¼€å§‹å‹Ÿé›†æ—¶é—´ã€ç»“æŸæ—¶é—´ã€å¯æŠ•é‡‘é¢ã€å¹´åˆ©ç‡ç­‰ç­‰ï¼‰ï¼Œåœ¨åˆ°è¾¾å¼€å§‹å‹Ÿé›†æ—¶é—´ä¼šæœ‰ä¸€æ®µæ—¶é—´çš„é«˜å¹¶å‘æŠ•æ ‡ï¼Œè¿™ä¸ªæ—¶å€™ä¼šå¯¹å…·ä½“æ ‡çš„è¡Œæ•°æ®è¿›è¡Œé¢‘ç¹çš„æ›´æ–°æ“ä½œï¼Œå°±æ˜¯æ‰£å‡å‰©ä½™å¯æŠ•é‡‘é¢ï¼Œå¦‚æœå…¶ä»–è€—æ—¶æ“ä½œä¸­æœ‰å¯¹åŒä¸€èµ„æºè¿›è¡Œç«äº‰çš„è¯ï¼Œé‚£ä¹ˆäº§å“é”æŒæœ‰æ—¶é—´è¿‡é•¿ï¼Œå¯¼è‡´æ€§èƒ½ä½ã€‚å¦‚æœæœ‰é«˜å¹¶å‘ç§’æ€ä¸‹å•ç­‰åŠ¨ä½œï¼Œä¼šé€ æˆè¡Œé”æŠ¢å é—®é¢˜ã€‚&lt;br&gt;
è¿™ä¸ªæ—¶å€™ï¼Œä¼˜åŒ–æ€è·¯æ˜¯ï¼Œå°†è¿™ä¸ªäº§å“æ ‡åœ¨æ•°æ®åº“åˆ†ä¸º10ä»½ï¼Œæ¯ä¸€ä»½çš„å¯æŠ•é‡‘é¢å‡å°‘10å€ï¼Œæ¯ä¸€ä¸ªæŠ•æ ‡è¯·æ±‚è¿›è¡Œéšæœºè·¯ç”±åˆ†é…åˆ°è¿™10ä¸ªå°çš„äº§å“æ ‡ä¸­ã€‚è¿™æ ·å°±å‡å°‘é”çš„å¹¶å‘ç«äº‰é—®é¢˜ï¼Œä¼˜åŒ–æ€§èƒ½ã€‚&lt;br&gt;
ä½†æ˜¯ç¬”è€…å› ä¸ºé‡åˆ°è¿™ç§åˆ†æ®µé”çš„é—®é¢˜å¯¼è‡´çš„&lt;strong&gt;æ­»é”&lt;/strong&gt;é—®é¢˜ï¼Œåœºæ™¯æ˜¯è¿™æ ·çš„ï¼Œå½“ä¸€ä»½æŠ•æ ‡çš„é‡‘é¢å¤§äºå…¶ä¸­ä¸€ä»½äº§å“é‡‘é¢çš„è¯ï¼Œä¼šæŒæœ‰è¿™ä»½äº§å“çš„é”ï¼Œå¹¶ä¸”å¾ªç¯è·å–ä¸‹ä¸€ä»½å°äº§å“ï¼Œè¿™ä¸ªæ—¶å€™å¦‚æœæœ‰ä¸¤ä¸ªçº¿ç¨‹éƒ½å¤§äºå°äº§å“é‡‘é¢çš„è¯ï¼Œæœ‰æ¦‚ç‡ä¼šäº§ç”Ÿæ­»é”é—®é¢˜ï¼Œç¬”è€…æœ€ç»ˆé€šè¿‡é¡ºåºåŠ é”ä»¥åŠåŠ ä¸Šé”çš„è¿‡æœŸæ—¶é—´è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚&lt;/li&gt;
&lt;li&gt;æœ€åï¼Œå¯¹åŒä¸€ä¸ªèµ„æºçš„å¹¶å‘ç«äº‰ï¼Œä¸¾ä¸ªä¾‹å­ï¼Œåƒ12306æŠ¢ç¥¨ã€å•†åŸæ´»åŠ¨ç§’æ€ç­‰éƒ½æ˜¯å¯¹åŒä¸€ä¸ªæœ‰é™èµ„æºè¿›è¡Œç«äº‰çš„åœºæ™¯ï¼Œç¬”è€…è®¤ä¸ºï¼Œè¿™ç§åœºæ™¯æ˜¯éå¸¸éš¾å¤„ç†çš„ï¼Œéœ€è¦è€ƒè™‘åˆ°é”åŒæ­¥æ•°æ®å®‰å…¨ã€å¹¶å‘ç«äº‰æ€§èƒ½ç“¶é¢ˆã€è¶…å–ç­‰é—®é¢˜ï¼Œéƒ½æ˜¯ä¼šå½±å“Cç«¯ç”¨æˆ·å®é™…çš„ä½“éªŒçš„ã€‚&lt;br&gt;
åƒè¿™ç§åœºæ™¯ï¼Œä¼˜åŒ–çš„æ€è·¯å°±æ˜¯â€”â€”&amp;gt;&lt;strong&gt;èƒ½ç”¨åˆ†æ®µé”çš„å°±ä¸è¦ç”¨æ‚²è§‚é”ï¼Œèƒ½ç”¨ä¹è§‚é”çš„å°±ä¸è¦ç”¨æ‚²è§‚é”ï¼Œèƒ½ç”¨æ— é”ç¼–ç¨‹çš„å°±ä¸è¦ç”¨é”ï¼Œèƒ½ç”¨å¼‚æ­¥çš„åœºæ™¯å°±ä¸è¦ç”¨åŒæ­¥çš„åœºæ™¯ï¼Œèƒ½åœ¨å†…å­˜æ“ä½œçš„å°±ä¸è¦å†æ”¾åˆ°æ•°æ®åº“ç£ç›˜å±‚é¢æ“ä½œ&lt;/strong&gt;ã€‚å½“ç„¶ï¼Œæœ‰äº›å¯¹äºæ•°æ®å®‰å…¨æ€§è¦æ±‚å¾ˆé«˜çš„åœºæ™¯ï¼Œæ¯”å¦‚é‡‘èï¼ŒåŠ é”æ˜¯å¿…è¦çš„ã€‚è¿™ä¸ªå°±æ˜¯ä¸šåŠ¡ä¸€è‡´æ€§å’Œå¹¶å‘çš„æŠ˜ä¸­è€ƒè™‘ï¼Œè¿™ä¸ªéœ€è¦è€ƒè™‘å…·ä½“çš„ä¸šåŠ¡åœºæ™¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;2ã€å…³é—­æ­»é”æ£€æµ‹&lt;br&gt;
MySQLé»˜è®¤å¼€å¯æ­»é”æ£€æµ‹ï¼Œæ¦‚å¿µï¼šæ¯å½“ä¸€ä¸ªäº‹åŠ¡è¢«é”çš„æ—¶å€™ï¼Œå°±è¦çœ‹çœ‹å®ƒæ‰€ä¾èµ–çš„çº¿ç¨‹æœ‰æ²¡æœ‰è¢«åˆ«äººé”ä½ï¼Œå¦‚æ­¤å¾ªç¯ï¼Œæœ€ååˆ¤æ–­æ˜¯å¦å‡ºç°äº†å¾ªç¯ç­‰å¾…ï¼Œä¹Ÿå°±æ˜¯æ­»é”ã€‚æ­»é”æ£€æµ‹å¯¹æ•°æ®åº“æœ‰éå¸¸å¤§çš„æ€§èƒ½å½±å“ï¼Œä¼šæ¶ˆè€—CPUèµ„æºï¼Œæœ€åä¼šå‹å®æ•°æ®åº“ã€‚&lt;br&gt;
åœ¨è¿™ç§å¹¶å‘åœºæ™¯ä¸‹å¯ä»¥å…³é—­æ­»é”æ£€æµ‹åŠŸèƒ½ï¼Œä¼šæœ‰æ˜æ˜¾çš„æ€§èƒ½æå‡ã€‚å½“ç„¶å…³é—­æ­»é”æ£€æµ‹ä¹Ÿä¼šå¸¦æ¥é—®é¢˜ï¼Œæ¯”å¦‚å½“æ­»é”å‘ç”Ÿæ—¶ï¼Œä¼šä¸€ç›´æŒæœ‰é”èµ„æºï¼Œç›´è‡³åˆ°è¶…æ—¶æ—¶é—´åï¼Œé‡Šæ”¾ï¼Œè¿™æ®µç­‰å¾…çš„æ—¶å€™å¯èƒ½ä¼šé€ æˆçº¿ç¨‹æŒç»­ç­‰å¾…é€ æˆä¸¥é‡åæœã€‚æ‰€ä»¥ä¸ºäº†é¿å…æ­»é”çš„å‘ç”Ÿï¼Œå¯¹è¡Œèµ„æºè¿›è¡ŒåŠ é”çš„æ—¶å€™å¯ä»¥æ ¹æ®IDä¸»é”®ç­‰è¿›è¡Œ&lt;strong&gt;é¡ºåºåŠ é”&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;3ã€SQLä¼˜åŒ–&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;SQLé¿å…å¤šè¡¨è¿æ¥æŸ¥è¯¢ã€inå’Œexitsåˆç†åº”ç”¨ã€è€ƒè™‘ç´¢å¼•å¤±æ•ˆåœºæ™¯&lt;/li&gt;
&lt;li&gt;åœ¨ç»å¸¸æŸ¥è¯¢å’Œæ’åºçš„åˆ—ä¸ŠåŠ ç´¢å¼•ï¼Œå¯¹ç¦»æ•£åº¦ä¸é«˜çš„ä¸å»ºè®®åŠ é”ï¼Œéµå¾ªç´¢å¼•è§„èŒƒ&lt;/li&gt;
&lt;li&gt;åœ¨å†™åœºæ™¯å¤šä½™è¯»åœºæ™¯çš„ç´¢å¼•é€‰æ‹©ï¼Œå”¯ä¸€ç´¢å¼•å’Œæ™®é€šç´¢å¼•çš„é€‰æ‹©&lt;/li&gt;
&lt;li&gt;å°½é‡è¿›è¡Œè¦†ç›–ç´¢å¼•ï¼Œé¿å…å›è¡¨æŸ¥è¯¢&lt;/li&gt;
&lt;li&gt;å°½é‡å»ºç«‹è”åˆç´¢å¼•ï¼Œæ¥è¿›è¡Œç´¢å¼•å¤ç”¨&lt;/li&gt;
&lt;li&gt;å­—ç¬¦ä¸²çš„å‰ç¼€ç´¢å¼•çš„å»ºç«‹&lt;/li&gt;
&lt;li&gt;ç”¨explainåˆ†ææ•´ä¸ªSQLçš„æ‰§è¡Œæƒ…å†µï¼ŒåŒ…æ‹¬æ‰§è¡Œè®¡åˆ’ã€ç´¢å¼•åˆ†æ&lt;/li&gt;
&lt;li&gt;ä¿®æ”¹æ•°æ®æ¯”è¾ƒå¤šçš„å­—æ®µåœºæ™¯å°½é‡åŠ ç´¢å¼•ï¼Œå°½é‡ä½¿ç”¨è¡Œé”ï¼Œé¿å…è¡¨é”&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;4ã€åœ¨å¤§æ•°æ®é‡çš„æƒ…å†µä¸‹ï¼ˆä¸€èˆ¬å•è¡¨è¶…2000Wï¼‰çš„ä¼˜åŒ–æ€è·¯ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åŠ ç¼“å­˜ï¼Œå¯¹äºé«˜å¹¶å‘è¯»åœºæ™¯ç”¨ç¼“å­˜ï¼Œä¸€çº§ç¼“å­˜Redisæˆ–è€…äºŒçº§ç¼“å­˜Cache&lt;/li&gt;
&lt;li&gt;æ¶æ„å±‚é¢MySQLå°±åšä¸»ä»å¤åˆ¶æˆ–ä¸»ä¸»å¤åˆ¶ï¼Œè¯»å†™åˆ†ç¦»ï¼Œå¯ä»¥åœ¨åº”ç”¨å±‚åšï¼Œæ•ˆç‡é«˜&lt;/li&gt;
&lt;li&gt;å‚ç›´æ‹†åˆ†ï¼Œæ ¹æ®ä½ æ¨¡å—çš„è€¦åˆåº¦ï¼Œå°†ä¸€ä¸ªå¤§çš„ç³»ç»Ÿåˆ†ä¸ºå¤šä¸ªå°çš„ç³»ç»Ÿï¼Œä¹Ÿå°±æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿï¼›&lt;/li&gt;
&lt;li&gt;æ°´å¹³åˆ‡åˆ†ï¼Œå› ä¸ºæ°´å¹³åˆ‡åˆ†ä¼šå¢åŠ ä»£ç å¼€å‘å¤æ‚åº¦ï¼Œæ‰€ä»¥èƒ½å°½é‡é¿å…å°±ä¸è¦åšã€‚é’ˆå¯¹æ•°æ®é‡å¤§çš„è¡¨ï¼Œå¯¹äºæ—¥å¿—æµæ°´ã€é…ç½®å‹ç­‰ç±»å‹æ•°æ®ï¼Œè¿›è¡Œå½’æ¡£æ“ä½œï¼›å¯¹äºçŠ¶æ€ä¸šåŠ¡æ•°æ®è¿›è¡Œåˆ†åº“åˆ†è¡¨ï¼Œè¿™é‡Œå°±ä¸å±•å¼€è®¨è®ºã€‚å…¶æ¬¡ï¼Œè¦é€‰æ‹©ä¸€ä¸ªåˆç†çš„sharding keyï¼Œä¸ºäº†æœ‰å¥½çš„æŸ¥è¯¢æ•ˆç‡ï¼Œè¡¨ç»“æ„ä¹Ÿè¦æ”¹åŠ¨ï¼Œåšä¸€å®šçš„å†—ä½™ï¼›&lt;/li&gt;
&lt;/ul&gt;
&lt;h5 id=&#34;redis&#34;&gt;Redis&lt;/h5&gt;
&lt;p&gt;Redisä½œä¸ºå¼€å‘äººå‘˜æ¥è§¦æœ€é¢‘ç¹çš„ä¸­é—´ä»¶ï¼Œé¦–å…ˆï¼Œç¬”è€…å…ˆæ‹¿å‡ºå®˜ç½‘ç»™å‡ºçš„Redisæ€§èƒ½æµ‹è¯•ç»“æœï¼šä»ä¸‹å›¾å¯ä»¥å¾—å‡ºç»“è®ºï¼šrediså•æœºæµ‹è¯•ç»“æœæ˜¯TPSæ˜¯7W,QPSåªèƒ½æ¯”è¿™ä¸ªæ•°æ®æ›´é«˜ã€‚&lt;br&gt;
&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1592983835284.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
å½“ä½¿ç”¨äº†ç®¡é“piplineåæ€§èƒ½å¤§çº¦æå‡äº†6å€ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º&lt;br&gt;
&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1592986207480.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;æ ¹æ®å®˜ç½‘çš„æ–‡æ¡£ï¼Œå½±å“Redisæ€§èƒ½æœ‰ä»¥ä¸‹å› ç´ ï¼Œç¬”è€…è®¤ä¸ºå¼€å‘äººå‘˜åšä¸€äº›åŸºå‡†æµ‹è¯•å‹æµ‹ä»¥åŠæ—¥å¸¸å¼€å‘ä¸­ä½¿ç”¨Redisçš„æ—¶å€™ï¼Œæ³¨æ„è¿™äº›ä¼˜åŒ–ç‚¹ï¼Œå°±èƒ½é«˜æ•ˆä½¿ç”¨Redisï¼š&lt;br&gt;
1ã€ç½‘ç»œå»¶è¿Ÿå’Œç½‘ç»œå¸¦å®½ï¼Œä½œä¸ºè¿ç»´äººå‘˜ï¼Œæœ€å¥½å°†æœåŠ¡å™¨å’ŒRedisæœåŠ¡éƒ¨ç½²åˆ°åŒä¸€ä¸ªå±€åŸŸç½‘å†…ï¼Œé™ä½ç½‘ç»œå»¶è¿Ÿã€‚ä½œä¸ºå¼€å‘äººå‘˜ï¼Œå°½é‡ä¸è¦ä½¿ç”¨å¤§keyå’Œå¤§valueï¼Œå› ä¸ºéšç€è¿™ç§æ•°æ®è¶Šæ¥è¶Šå¤šï¼Œåœ¨ç½‘ç»œä¼ è¾“çš„æ—¶å€™ä¼šå ç”¨å¤§éƒ¨åˆ†ç½‘ç»œå®½å¸¦ï¼Œä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœä¸€ä¸ªrediså¯¹è±¡å¤§å°è¶…è¿‡1KBï¼Œå½“ä½ çš„QPSè¾¾åˆ°100ä¸‡ï¼Œä¼šæŠŠä½ çš„åƒå…†è·¯ç”±å™¨çš„å¸¦å®½æ‰“æ»¡ï¼Œå› æ­¤ç½‘ç»œå¸¦å®½å¯èƒ½å°±ä¼šæˆä¸ºæ€§èƒ½ç“¶é¢ˆã€‚&lt;br&gt;
2ã€ä½¿ç”¨piplineï¼Œå½“ä½¿ç”¨ä»¥å¤ªç½‘è®¿é—®Redisæ—¶ï¼Œä¿æ®å¤§å°ä¿æŒåœ¨ä»¥å¤ªç½‘æ•°æ®åŒ…å¤§å°ï¼ˆçº¦1500å­—èŠ‚ï¼‰ä»¥ä¸‹æ—¶ï¼Œä½¿ç”¨æµæ°´çº¿è¿›è¡Œèšåˆçš„å‘½ä»¤ç‰¹åˆ«æœ‰æ•ˆã€‚&lt;br&gt;
3ã€å»¶æ—¶åˆ é™¤ï¼Œå½“æŸä¸€ä¸ªredisObjectå¾ˆå¤§çš„æ—¶å€™ï¼Œåšåˆ é™¤æ“ä½œä¼šé•¿æ—¶é—´å æœ‰çº¿ç¨‹æŒæœ‰æ—¶é—´ï¼Œå½±å“æ€§èƒ½ï¼Œredisæ–°ç‰ˆæœ¬æœ‰å»¶è¿Ÿåˆ é™¤çš„åŠŸèƒ½ã€‚&lt;br&gt;
4ã€ä½¿ç”¨scanä»£æ›¿keysï¼Œkeysä¼šé€ æˆä¸¥é‡çš„æ€§èƒ½é—®é¢˜&lt;br&gt;
5ã€è®¾ç½®å†…å­˜çš„å¤§å°é˜ˆå€¼å¹¶ä¸”è®¾ç½®å¥½å†…å­˜ç¼“å­˜æ·˜æ±°çš„ç­–ç•¥ï¼Œçº¿ä¸Šè®¾ç½®LRUç­–ç•¥æ¥æ·˜æ±°ç¼“å­˜è¿™æ ·åšæ˜¯ä¸ºäº†é¿å…ç‰©ç†å†…å­˜ä½¿ç”¨å®Œåï¼Œé€ æˆå¡é¡¿çš„æƒ…å†µã€‚å¹¶ä¸”çº¿ä¸Šè¦é¿å…å¤§é‡keyåŒæ—¶å¤±æ•ˆçš„åœºæ™¯ï¼Œå› ä¸ºredisåˆ é™¤å¤±æ•ˆçš„keyæ˜¯å¾ªç¯åˆ é™¤çš„ï¼Œå¹¶ä¸”é¢‘ç¹çš„åˆ é™¤ä¼šä¿ƒä½¿å†…å­˜ç®¡ç†å™¨å›æ”¶å†…å­˜é¡µï¼Œè¿™æ ·ä¹Ÿä¼šå¯¼è‡´å¡é¡¿çš„ç°è±¡ã€‚&lt;br&gt;
6ã€connectionå®¢æˆ·ç«¯è¿æ¥æ•°é‡ï¼ŒRedisä½œä¸ºä¸€ä¸ªäº‹ä»¶é©±åŠ¨æ¨¡å‹ï¼Œå› ä¸ºbase epollèƒ½å¤Ÿå®ç°O(1)æ—¶é—´å¤æ‚åº¦çš„å“åº”æ“ä½œï¼Œå› æ­¤èƒ½å¤Ÿæä¾›å¾ˆå¥½æ€§èƒ½ã€‚Rediså·²ç»ä»¥è¶…è¿‡60000ä¸ªè¿æ¥ä¸ºåŸºå‡†ï¼Œå¹¶ä¸”åœ¨è¿™äº›æ¡ä»¶ä¸‹ä»èƒ½å¤Ÿç»´æŒ50000 q / sçš„ååé‡ï¼Œè€Œä¸”å…·æœ‰30000ä¸ªè¿æ¥çš„å®ä¾‹åªèƒ½å¤„ç†100ä¸ªè¿æ¥å¯è¾¾åˆ°çš„ååé‡çš„ä¸€åŠï¼Œå¯å‚è€ƒä¸‹å›¾ï¼ˆæ¥æºå®˜ç½‘ï¼‰ï¼š&lt;br&gt;
&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1592991673063.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h5 id=&#34;elasticsearch&#34;&gt;ElasticSearch&lt;/h5&gt;
&lt;p&gt;ElasticSearchå¯ä»¥è§£å†³å¤§æ•°æ®é‡ä¸‹çš„æœç´¢æ…¢é—®é¢˜ï¼Œè¿™é‡Œç¬”è€…å°±æ‹¿ æ­»ç£•ElasticSearchç¤¾åŒºä½œè€…çš„ä¼˜åŒ–å»ºè®®ï¼Œç»™å‡ºå‡ ç‚¹åœ¨æ—¥å¸¸å¼€å‘ElasticSearchçš„ä¼˜åŒ–æ–¹æ¡ˆï¼š&lt;br&gt;
1ã€å°½é‡å°†æ‰€æœ‰æ•°æ®çš„ä¸€åŠéƒ½ç¼“å­˜åœ¨å†…å­˜å½“ä¸­file cache system å½“ä¸­&lt;br&gt;
2ã€å°†å°‘é‡ï¼ˆæŸ¥è¯¢å­—æ®µæ¯”è¾ƒé¢‘ç¹ï¼‰å­—æ®µæ”¾å…¥ESï¼Œå…¶ä»–å…¨é‡å­—æ®µæ”¾å…¥Hbaseä¸­ï¼Œé‡‡ç”¨ES + Hbaseæ–¹å¼æå‡æŸ¥è¯¢æ•ˆç‡ï¼ŒèŠ‚çœESå­˜å‚¨ç©ºé—´ï¼Œfile cache systemçš„æ•°æ®å°±ä¼šå­˜çš„æ›´å¤š&lt;br&gt;
3ã€ç¼“å­˜é¢„çƒ­ï¼Œå¯ä»¥åšä¸€ä¸ªç¼“å­˜é¢„çƒ­ç³»ç»Ÿï¼Œå®šæ—¶æŸ¥è¯¢çƒ­ç‚¹æ•°æ®å°†å…¶ç¼“å­˜åœ¨filesystem cache ä¸­&lt;br&gt;
4ã€å†·çƒ­åˆ†ç¦»ï¼Œå°†è®¿é—®é‡é«˜çš„å’Œå†·æ•°æ®åˆ†åˆ«æ”¾ç½®ç´¢å¼•&lt;br&gt;
5ã€ES ducomentè®¾è®¡ï¼Œå°½é‡é¿å…è¿æ¥ã€çˆ¶å­æ–‡æ¡£ç­‰è¿æ¥æ“ä½œï¼Œå°†æ•°æ®å‡†å¤‡å¥½åå†å­˜å…¥ES&lt;br&gt;
6ã€ä¸å…è®¸æ·±åº¦åˆ†é¡µï¼Œé¡µæ•°è¶Šå¤§ï¼Œæ·±åº¦è¶Šæ·±ï¼Œä»æ¯ä¸€ä¸ªshardè¿”å›çš„æ•°æ®å°±è¶Šå¤šï¼Œè€—æ—¶è¶Šä¹…ã€‚å¯ä»¥é€šè¿‡scroll apiæ¸¸æ ‡è¿›è¡ŒæŸ¥è¯¢ã€‚&lt;br&gt;
7ã€å¿…é¡»é™åˆ¶æ¨¡ç³Šæœç´¢çš„é•¿åº¦ï¼Œä¸ç„¶CPUä¼šé£™é«˜ï¼Œå¯å‚è€ƒ https://elasticsearch.cn/article/171&lt;/p&gt;
&lt;h3 id=&#34;3-ä¸šåŠ¡å±‚æ–¹é¢&#34;&gt;3ã€ä¸šåŠ¡å±‚æ–¹é¢&lt;/h3&gt;
&lt;p&gt;æ¯ä¸ªå…¬å¸ä¸šåŠ¡å±‚é¢ä¼˜åŒ–ä¸ç›¸åŒï¼Œè¦æ ¹æ®å…·ä½“ä¸šåŠ¡åœºæ™¯å»ä¼˜åŒ–ï¼Œåˆ«äººçš„æ–¹æ¡ˆåªèƒ½ä½œä¸ºå‚è€ƒã€‚&lt;br&gt;
è¿™é‡Œç¬”è€…å°±æ‹¿é‡‘èè¡Œä¸šèƒŒæ™¯ä¸‹ï¼Œåˆ—ä¸¾ä¸‰ä¸ªä¼˜åŒ–ä¾‹å­ã€‚&lt;br&gt;
1ã€èƒŒæ™¯ï¼šä¼ä¸šå€Ÿè´·ï¼Œä¼šä»ç”¨æˆ·çš„æŠ•çš„é“¶è¡ŒæŸä¸ªäº§å“çš„èµ„é‡‘æ± ä¸­åŒ¹é…æŸ¥æ‰¾åˆé€‚çš„èµ„é‡‘ï¼Œç„¶åè¿›è¡Œèµ„é‡‘å æœ‰ï¼Œé“¶è¡ŒçœŸå®è½¬è´¦åï¼Œç”Ÿæˆç»ˆæ€çš„å€ºæƒå…³ç³»ã€‚&lt;br&gt;
ä¼˜åŒ–ä¹‹å‰ï¼šä½¿ç”¨åŒæ­¥é”ï¼ŒåŒä¸€æ—¶é—´åªèƒ½åˆä¸€ä¸ªçº¿ç¨‹å»èµ„é‡‘æ± ä¸­åŒ¹é…èµ„é‡‘ï¼Œè¿™ç§æ–¹æ¡ˆæœ‰ä¸¥é‡çš„æ€§èƒ½é—®é¢˜ï¼Œå…¶ä»–çº¿ç¨‹æ²¡æœ‰æ‹¿åˆ°é”ä¹‹å‰åªèƒ½è‡ªæ—‹å°è¯•è·å–é”ï¼ŒæŸè€—CPUèµ„æºã€‚&lt;br&gt;
ä¼˜åŒ–ä¹‹åï¼šå»æ‰åŒæ­¥é”ï¼Œæ”¹æˆä¹è§‚é”ï¼Œæ”¾åˆ°æ•°æ®åº“åšï¼Œèµ„é‡‘è¡¨çš„å­—æ®µå¢åŠ ä¸€ä¸ªæ ‡è¯†è¡¨ç¤ºæ˜¯å¦å ç”¨ï¼Œçº¿ç¨‹è¿›æ¥å°è¯•åŒ¹é…èµ„é‡‘ï¼Œä¹è§‚é”å»é¢„å èµ„é‡‘è¡¨ï¼ŒæˆåŠŸè¡¨ç¤ºåŒ¹é…æˆåŠŸã€‚è¿™é‡Œè¦æ³¨æ„çš„æ˜¯ï¼Œå°½é‡ä¸€ä¸ªå€Ÿè´·åŒ¹é…ä¸€æ¯”èµ„é‡‘ï¼Œè¿™æ ·èµ„é‡‘æ± é‡Œé¢çš„èµ„é‡‘é”è¡ŒèŒƒå›´ä¼šå‡å°‘ï¼ˆå› ä¸ºæœ‰å¤šçº¿ç¨‹æŠ¢å èµ„é‡‘èµ„æºï¼‰ï¼Œèµ„é‡‘åŒ¹é…çš„é€Ÿåº¦ä¼šåŠ å¿«ï¼Œå¹¶ä¸”è¿™æ ·ä¼˜åŒ–è¿™æ ·é“¶è¡Œè½¬è´¦çš„æ¬¡æ•°ä¼šå‡å°‘ï¼ˆå¦‚æœåŒ¹é…ä¸€æ‰¹èµ„é‡‘å°±è¦è¿›è¡Œç›¸åŒæ•°é‡è½¬è´¦æ¬¡æ•°ï¼‰ï¼Œé˜²æ­¢å¤šä¸ªæŠ•èµ„äººè´¦æˆ·è¿›è¡Œé“¶è¡Œè½¬è´¦ï¼Œå‡å°‘æ•´ä¸ªå€Ÿæ¬¾ä¸šåŠ¡çº¿çš„è€—æ—¶ï¼Œé¿å…å…¶ä¸­ä¸€ä¸ªè½¬è´¦å‡ºé”™å¯¼è‡´å…¨éƒ¨è¦å›æ»šè¿™æ ·çš„æƒ…å†µã€‚&lt;br&gt;
è¿™é‡Œå…¶å®è¿˜å¯ä»¥è¿›è¡Œä¼˜åŒ–ï¼Œæ¯”å¦‚ä¸€ç¬”ä¸€ç¬”çš„å æœ‰èµ„é‡‘ï¼Œå æœ‰å¤±è´¥çš„continueç»§ç»­ä¸‹ä¸€ç¬”èµ„é‡‘å«æœ‰ï¼Œä¸ç”¨ä¸€æ¬¡åœ¨ä¸€ä¸ªäº‹åŠ¡é‡Œé¢å æœ‰å¤§é‡èµ„é‡‘ï¼Œé˜²æ­¢å¤§äº‹åŠ¡æ‰§è¡Œå¤±è´¥ä»¥åŠå‡ºç°å…¶ä»–ä¼šæœ‰æ­»é”çš„å¯èƒ½æ€§ã€‚è¿™é‡Œä¼˜åŒ–çš„æ€æƒ³å°±æ˜¯å¤§äº‹åŠ¡æ‹†æˆå°äº‹åŠ¡ï¼Œé˜²æ­¢äº‹åŠ¡æ‰§è¡Œå¤±è´¥çš„æ¦‚ç‡ã€‚&lt;/p&gt;
&lt;p&gt;2ã€èƒŒæ™¯ï¼šä¼ä¸šå€Ÿè´·ï¼ŒåŒæ­¥è¯·æ±‚è½¬å¼‚æ­¥&lt;br&gt;
ä¼˜åŒ–ä¹‹å‰ï¼Œä¸‰æ–¹ä¼ä¸šå€Ÿè´·è¯·æ±‚ï¼Œæ˜¯åŒæ­¥è°ƒç”¨ï¼Œå› ä¸ºä¸€æ¡å®Œæ•´çš„å€Ÿè´·ä¸šåŠ¡çº¿éå¸¸é•¿ï¼Œä¸­é—´ä¼šRPCè°ƒç”¨éå¸¸å¤šçš„åº•å±‚æœåŠ¡ä»¥åŠå…¶ä»–è¿œç¨‹æ¥å£ï¼Œè¿™æ ·çš„è¯è¯·æ±‚åˆ°å“åº”æ—¶é—´ä¼šæ‹‰çš„éå¸¸é•¿ï¼Œå½±å“Cç«¯çš„ç”¨æˆ·ä½“éªŒã€‚&lt;br&gt;
ä¼˜åŒ–ä¹‹åï¼ŒåŒæ­¥æ”¹å¼‚æ­¥ï¼Œå…·ä½“åšæ³•æ˜¯ï¼Œå€Ÿè´·è¯·æ±‚è¿›å…¥ç³»ç»Ÿåï¼Œä¼šå…ˆç”Ÿæˆä¸€ä¸ªè¿›è¡Œä¸­çš„çŠ¶æ€å€Ÿè´·æ•°æ®æ’å…¥æ•°æ®åº“ï¼Œç„¶åå°†å”¯ä¸€æ ‡è¯†ä¸¢å…¥MQä¸­ï¼Œç„¶åå°±è¿”å›æˆåŠŸã€‚è¿™æ ·ååé‡ä¼šå¢åŠ ï¼Œç”¨æˆ·ç«¯ä½“éªŒä¼šéå¸¸å¥½ã€‚&lt;br&gt;
å½“ç„¶å¦‚æœè¯´è¦ä¿è¯é«˜å¯ç”¨ï¼Œå¯ä»¥åˆ©ç”¨MQçš„äº‹åŠ¡æ¶ˆæ¯åšï¼Œåˆ©ç”¨äºŒé˜¶æ®µæäº¤æ–¹å¼ä¿è¯MQèƒ½å¤Ÿæ”¶åˆ°æ¶ˆæ¯ã€‚å…·ä½“æ–¹æ¡ˆå¯ä»¥çœ‹ç¬”è€…çš„è¿™ç¯‡æ–‡ç«  &lt;a href=&#34;https://zhangyaoo.github.io/post/jin-rong-ji-ye-wu-xia-fen-bu-shi-shi-wu-bao-zheng-shu-ju-yi-zhi-xing//&#34;&gt;é‡‘èçº§ä¸šåŠ¡ä¸‹åˆ†å¸ƒå¼äº‹åŠ¡ä¿è¯æ•°æ®ä¸€è‡´æ€§&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;3ã€èƒŒæ™¯ï¼šCç«¯ç”¨æˆ·åœ¨APPä¸Šï¼ŒæŸä¸€ä¸ªæ ‡å¼€å¯å‹Ÿé›†èµ„é‡‘åè¿›è¡ŒæŠ•æ ‡ï¼Œè¿™é‡Œçš„æ ‡ç±»ä¼¼æ”¯ä»˜å®çš„ç†è´¢äº§å“ï¼Œå¼€å§‹å‹Ÿé›†çš„æ—¶å€™ä¼šæœ‰é«˜å¹¶å‘æµé‡æ¶Œå…¥ï¼Œå½“APPç«¯ç”¨æˆ·åŒæ—¶æŠ•æ ‡ï¼Œä¼šæœ‰å¤§é‡è¯·æ±‚ï¼Œè¿™å°±å½¢æˆäº†æŠ¢è´­çš„åŠ¨ä½œï¼Œå› ä¸ºä¸€ä¸ªäº§å“æ ‡çš„å¯æŠ•é‡‘é¢æ˜¯æœ‰é™çš„ï¼Œåªæœ‰å°‘æ•°äººèƒ½æŠ•æ ‡æˆåŠŸ&lt;br&gt;
ä¼˜åŒ–ä¹‹å‰ï¼šç¬”è€…åœ¨ä¸Šæ–‡ä¸­æåˆ°çš„ï¼Œå°½ç®¡è¯´é¢‘ç¹å°†æ›´æ–°è¡Œé”çš„æ•°æ®æ”¾åˆ°äº‹åŠ¡çš„æœ€åï¼Œ ä¼šæœ‰æ€§èƒ½æå‡ï¼Œä½†æ˜¯éšç€å¹¶å‘æ•°å¢é•¿ï¼ŒMySQLä¹Ÿä¼šæˆä¸ºæ€§èƒ½ç“¶é¢ˆã€‚&lt;br&gt;
ä¼˜åŒ–ä¹‹åï¼šåˆ©ç”¨redisçš„çº¯å†…å­˜æ“ä½œé«˜æ€§èƒ½çš„ä¼˜ç‚¹ï¼Œå°†äº§å“çš„å¯æŠ•é‡‘é¢æ”¾å…¥ç¼“å­˜redisï¼ˆè¿™é‡Œredisé‡Œé¢çš„é‡‘é¢æ¯”æ•°æ®åº“ä¸­å°‘ä¿è¯ä¸è¶…å–ï¼‰ï¼Œåˆ©ç”¨redisçš„decrbyå‘½ä»¤æˆ–è€…luaè„šæœ¬ï¼Œä¿è¯äº§å“æ ‡å‰©ä½™å¯æŠ•é‡‘é¢èƒ½å¤Ÿè¿›è¡ŒåŸå­å‡å°‘ï¼Œæ¯ä¸€æ¬¡å‡å°‘æˆåŠŸåï¼Œå°†ç”¨æˆ·è¿™ä¸€æ¬¡æŠ•æ ‡çš„æ•°æ®ä¸¢å…¥MQä¸­å¼‚æ­¥å¤„ç†ï¼Œæ¶ˆè´¹ç«¯åšçš„å°±æ˜¯å°†æ’å…¥é¢„çŠ¶æ€çš„å€Ÿæ¬¾æ•°æ®ã€å†»ç»“ç”¨æˆ·é‡‘é¢å’Œå‡å°‘äº§å“çš„å¯æŠ•é‡‘é¢æ”¾å…¥åŒä¸€ä¸ªäº‹åŠ¡ä¸­å¤„ç†ã€‚&lt;br&gt;
ä¸Šé¢åšçš„ä¼˜åŒ–èƒ½å¤Ÿä¿è¯Cç«¯ç”¨æˆ·çš„è‰¯å¥½ä½“éªŒï¼Œä½†æ˜¯å¼•å…¥å„ç§ä¸­é—´ä»¶çš„è¯ä¼šå‡ºç°å„ç§é—®é¢˜éœ€è¦å»è§£å†³ï¼Œæ¯”å¦‚é‡å¤æŠ•æ ‡æ€ä¹ˆåŠï¼ŒRedisæŒ‚äº†æ€ä¹ˆï¼ŸMQæŒ‚äº†æ€ä¹ˆåŠï¼Ÿæ¶ˆæ¯ä¸¢å¤±æ€ä¹ˆåŠï¼Ÿç­‰ä¸€ç³»åˆ—é—®é¢˜ã€‚&lt;br&gt;
é‡å¤æŠ•æ ‡ï¼Œå¯ä»¥åˆ©ç”¨ç”¨æˆ·æ ‡è¯†çš„å”¯ä¸€tokenåšï¼ŒçŸ­ä¿¡ç”Ÿæˆtokenï¼Œè®¾ç½®tokenå¤±æ•ˆæ—¶é—´ï¼ˆçŸ­ä¿¡å¤±æ•ˆæ—¶é—´60sï¼‰ï¼ŒæŠ•æ ‡æ—¶å€™æ ¡éªŒtokenæ˜¯å¦è¿‡æœŸå’Œä½¿ç”¨è¿‡ã€‚&lt;br&gt;
RedisæŒ‚ï¼Œè¿™æ—¶å€™å°±è¦è€ƒè™‘æŒä¹…åŒ–å’Œé›†ç¾¤å“¨å…µä¿æŒredisé«˜å¯ç”¨ã€‚&lt;br&gt;
MQæŒ‚äº†ï¼Œæ¶ˆæ¯ä¸¢å¤±ï¼Œé‡å¤æ¶ˆè´¹ç­‰ï¼Œè¿™æ—¶å€™å°±è¦è€ƒè™‘brokerçš„æŒä¹…åŒ–ï¼Œç”Ÿäº§ç«¯å’Œæ¶ˆè´¹ç«¯çš„é‡è¯•æœºåˆ¶å’Œackæœºåˆ¶ã€‚&lt;br&gt;
ä»¥ä¸Šéœ€è¦å¼€å‘äººå‘˜å»åº”å¯¹æ¯ä¸€ä¸ªå¯èƒ½å‡ºç°é—®é¢˜çš„åœºæ™¯ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä¸‰-åç»­æµé‡å¢é•¿ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ–æ€è·¯&#34;&gt;ä¸‰ã€åç»­æµé‡å¢é•¿ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ–æ€è·¯&lt;/h2&gt;
&lt;p&gt;å½“æµé‡æ¿€å¢çš„æ—¶å€™ï¼Œé¦–å…ˆè¦è€ƒè™‘åˆ°ç³»ç»Ÿçš„ç¨³å®šæ€§å’Œé«˜å¯ç”¨ï¼Œåç»­é’ˆå¯¹ç‰¹å®šçš„åœºæ™¯ï¼Œåˆ†ææ€§èƒ½ç“¶é¢ˆï¼Œç„¶åå†å»åšå¹¶å‘çš„ä¼˜åŒ–ã€‚è¿™é‡Œç¬”è€…å°±&lt;strong&gt;ç®€å•çš„&lt;/strong&gt;åˆ—ä¸¾ä¸€ä¸‹ä¸šç•Œçš„åšæ³•ï¼Œä¸‹é¢æ¯ä¸€æ¡è¯»è€…éƒ½å¯ä»¥è‡ªè¡Œæ‰©å±•å¤§ç¯‡å¹…æ·±å…¥å»äº†è§£ã€‚&lt;/p&gt;
&lt;h4 id=&#34;é«˜å¯ç”¨&#34;&gt;é«˜å¯ç”¨&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;ä½¿ç”¨åå‘ä»£ç†å’Œ&lt;strong&gt;è´Ÿè½½å‡è¡¡&lt;/strong&gt;å®ç°åˆ†æµï¼Œå¹¶ä¸”å®ç°åŠ¨æ€åˆ‡æ¢ä¸»å¤‡æœºå™¨ï¼Œ ç½‘å…³è´Ÿè½½å‡è¡¡ï¼ŒDNSå¤šæœºæˆ¿è´Ÿè½½å‡è¡¡&lt;/li&gt;
&lt;li&gt;é€šè¿‡&lt;strong&gt;é™æµ&lt;/strong&gt;ä¿æŠ¤åº”ç”¨å…å—é›ªå´©ä¹‹ç¾&lt;/li&gt;
&lt;li&gt;é€šè¿‡&lt;strong&gt;é™çº§&lt;/strong&gt;å®ç°æ ¸å¿ƒæœåŠ¡æœåŠ¡å¯ç”¨ï¼Œç‰ºç‰²éæ ¸å¿ƒæœåŠ¡&lt;/li&gt;
&lt;li&gt;é€šè¿‡&lt;strong&gt;éš”ç¦»&lt;/strong&gt;å®ç°æ•…éšœéš”ç¦»å’Œèµ„æºéš”ç¦»ï¼Œæ¯”å¦‚çº¿ç¨‹éš”ç¦»ï¼Œå¯¹æ–¹æ³•æˆ–è€…ç±»å…·ä½“åˆ†é…çº¿ç¨‹æ•°é‡ï¼Œé˜²æ­¢ç›¸äº’å½±å“&lt;/li&gt;
&lt;li&gt;é€šè¿‡è®¾ç½®åˆç†çš„&lt;strong&gt;è¶…æ—¶&lt;/strong&gt;è°ƒç”¨ä¸é‡è¯•æœºåˆ¶é¿å…è¯·æ±‚å †ç§¯é€ æˆé›ªå´©&lt;/li&gt;
&lt;li&gt;é€šè¿‡&lt;strong&gt;å›æ»š&lt;/strong&gt;æœºåˆ¶å¿«é€Ÿä¿®å¤é”™è¯¯ç‰ˆæœ¬&lt;/li&gt;
&lt;li&gt;Redis&lt;strong&gt;é›†ç¾¤&lt;/strong&gt;ä¿è¯é«˜å¯ç”¨ï¼Œ&lt;strong&gt;å“¨å…µ&lt;/strong&gt;æ¨¡å¼ä¿è¯æ•…éšœè½¬ç§»&lt;/li&gt;
&lt;li&gt;Redis MQæ¶ˆæ¯ä¸­é—´ä»¶å¼€å¯&lt;strong&gt;æŒä¹…åŒ–&lt;/strong&gt;ï¼Œä¿è¯æ•°æ®ä¸ä¸¢ï¼›&lt;strong&gt;ackæœºåˆ¶&lt;/strong&gt;å’Œ&lt;strong&gt;é‡è¯•æœºåˆ¶&lt;/strong&gt;ä¿è¯æ•°æ®çš„å¯é æ€§&lt;/li&gt;
&lt;li&gt;åˆ†å¸ƒå¼æœåŠ¡ç¯å¢ƒ&lt;strong&gt;é“¾è·¯è·Ÿè¸ª&lt;/strong&gt;ï¼Œç›‘æ§æ•´ä¸ªæœåŠ¡çš„æœåŠ¡è´¨é‡&lt;/li&gt;
&lt;li&gt;ç¡¬ä»¶èµ„æº&lt;strong&gt;ç›‘æ§&lt;/strong&gt;ã€CPUã€å†…å­˜ã€è´Ÿè½½ã€IOã€å †å†…å­˜ã€JVM GCã€çº¿ç¨‹æ± ä»¥åŠå„ç§ä¸­é—´ä»¶ç›‘æ§ç­‰ç­‰&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;é«˜å¹¶å‘&#34;&gt;é«˜å¹¶å‘&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;åˆ©ç”¨MQåŒæ­¥è½¬å¼‚æ­¥ï¼Œæµé‡å‰Šå³°ï¼Œå¤šçº¿ç¨‹å¼‚æ­¥æ¶ˆè´¹&lt;/li&gt;
&lt;li&gt;è¯»åœºæ™¯æ¯”è¾ƒå¤šçš„æ¥å£å¯ä»¥åˆ©ç”¨ç¼“å­˜Redisï¼ŒåŒ…æ‹¬çƒ­ç‚¹keyç¼“å­˜é¢„çƒ­ï¼Œå¤šçº§ç¼“å­˜ï¼Œæ¯”å¦‚åˆ†å¸ƒå¼ç¼“å­˜ï¼Œæœ¬åœ°ç¼“å­˜å’ŒCDNç¼“å­˜ã€‚è¿˜å¯ä»¥åšé›†ç¾¤ã€å“¨å…µã€é«˜å¯ç”¨ä¿è¯Redisæ€§èƒ½&lt;/li&gt;
&lt;li&gt;å¯¹äºå¼ºä¸€è‡´çš„åŒæ­¥ä¸‹å•åœºæ™¯ï¼Œå¯ä»¥å°†å¯¹MySQLçš„æ“ä½œæ”¹ä¸ºRedisï¼Œç„¶ååˆ©ç”¨MQåšå¼‚æ­¥&lt;/li&gt;
&lt;li&gt;ä¼˜åŒ–JVMï¼ŒåŒ…æ‹¬æ–°ç”Ÿä»£å’Œè€å¹´ä»£çš„å¤§å°ã€GCç®—æ³•çš„é€‰æ‹©ç­‰ï¼Œå°½å¯èƒ½å‡å°‘GCé¢‘ç‡å’Œè€—æ—¶&lt;/li&gt;
&lt;li&gt;éæ ¸å¿ƒä¸šåŠ¡é€»è¾‘ã€å»¶è¿Ÿä»»åŠ¡é€»è¾‘ã€ä¸‰æ–¹è°ƒç”¨é€»è¾‘ï¼Œå¯ä»¥åšå¼‚æ­¥&lt;/li&gt;
&lt;li&gt;å¯¹äºæ¶æ„æ–¹é¢ï¼Œå¯ä»¥åšè´Ÿè½½å‡è¡¡é›†ç¾¤éƒ¨ç½²ï¼ŒMySQLä¸»ä»ã€åˆ†åº“åˆ†è¡¨æˆ–è€…å½’æ¡£ã€Redisé›†ç¾¤ã€å¤šçº§ç¼“å­˜ã€åˆ†å¸ƒå¼å‚ç›´æ‹†åˆ†éƒ¨ç½²ã€æœç´¢åœºæ™¯å¼•å…¥ESç­‰å¤šä¸ªæ–¹é¢è€ƒè™‘&lt;/li&gt;
&lt;li&gt;å¯¹äºç¨‹åºæ–¹é¢ï¼Œå¯ä»¥ä»Forå¾ªç¯çš„è®¡ç®—é€»è¾‘ä¼˜åŒ–ã€æ‰¹å¤„ç†æœºåˆ¶å‡å°‘IOã€é‡‡ç”¨æ—¶é—´å¤æ‚åº¦æ›´å°çš„æ•°æ®ç»“æ„å’Œç®—æ³•ã€ä¹è§‚é”å’Œåˆ†æ®µé”å’Œæ— é”ç¼–ç¨‹å‡å°‘é”å†²çªç­‰æ–¹é¢è€ƒè™‘&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;å››-æ€»ç»“&#34;&gt;å››ã€æ€»ç»“&lt;/h2&gt;
&lt;p&gt;ä»¥ä¸Šï¼Œç¬”è€…ä»ç¡¬ä»¶å±‚ã€ä»£ç å±‚ã€ä¸­é—´ä»¶å±‚ã€ä¸šåŠ¡å±‚ç­‰ä¸åŒæ–¹å‘ï¼Œç®€å•çš„åˆ†æäº†å½±å“ç³»ç»Ÿæ€§èƒ½å„ä¸ªå› ç´ ï¼Œä»¥åŠæä¾›äº†ç®€å•çš„ä¼˜åŒ–çš„æ€è·¯å’Œä¾‹å­ã€‚å› ç¬”è€…å·¥ä½œç»éªŒèƒ½åŠ›æœ‰é™ï¼Œæ— æ³•åšåˆ°å…¨é¢çš„åˆ†æï¼Œè¿˜æœ›è¯»è€…èƒ½å¤ŸæŒ‡æ­£é”™è¯¯ä»¥åŠæä¾›å»ºè®®ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å‚è€ƒ&#34;&gt;å‚è€ƒ&lt;/h2&gt;
&lt;p&gt;1ã€ç§’æ€åœºæ™¯ä¸‹MySQLçš„ä½æ•ˆâ€”â€”ä¸å¥‡&lt;br&gt;
2ã€æ­»ç£•ElasticSearchç¤¾åŒºâ€”â€”ElasticSearchä¼˜åŒ–&lt;br&gt;
3ã€MySQLæ€§èƒ½å‹æµ‹â€”â€”https://my.oschina.net/u/867417/blog/758690&lt;br&gt;
4ã€é«˜å¯ç”¨ç³»ç»Ÿæ–¹æ¡ˆâ€”â€”https://blog.csdn.net/hustspy1990/article/details/78008324&lt;br&gt;
5ã€Redisæ€§èƒ½æµ‹è¯•â€”â€”https://redis.io/topics/benchmarks&lt;/p&gt;
&lt;!--å‚è€ƒ --&gt;
">ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ–çš„æ€è€ƒå’Œæ€»ç»“</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://zhangyaoo.github.io/post/o1shi-jian-fu-za-du-xia-shuang-xiang-lian-biao-shi-xian-lru/"" data-c="
          &lt;h3 id=&#34;å‰è¨€&#34;&gt;å‰è¨€&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;ç¬”è€…å…ˆä»linkedHashMapæºç ä¸­å€Ÿé‰´æ’å…¥é¡ºåºè®¿é—®çš„ä»£ç ï¼Œç„¶åç„¶åè‡ªå·±å®ç°äº†ä¸€ä¸ªLRU&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;linkedhashmapåº•å±‚çš„æ•°æ®ç»“æ„&#34;&gt;linkedHashMapåº•å±‚çš„æ•°æ®ç»“æ„&lt;/h3&gt;
&lt;p&gt;linkedHashMapåº•å±‚ç»“æ„ï¼ˆé¡ºåºè®¿é—®ï¼‰ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;1ã€linkedHashMapç»´æŠ¤äº†æ¯ä¸ªnodeçš„åŒå‘é“¾è¡¨ï¼Œåˆå§‹åŒ–æ—¶å€™ç»´æŠ¤äº†ç©ºçš„entry headerå¤´ï¼Œæ–°åŠ å…¥çš„èŠ‚ç‚¹æ”¾åˆ°entryçš„å¤´éƒ¨headerçš„next&lt;/li&gt;
&lt;li&gt;2ã€putè¿˜æ˜¯getéƒ½ä¼šè¿›è¡Œé‡æ’åºï¼Œget entry1 è¿˜æ˜¯put entry1éƒ½ä¼šå…ˆæŠŠEntry1ä»åŒå‘é“¾è¡¨ä¸­åˆ é™¤ï¼Œç„¶åå†æŠŠEntry1åŠ å…¥åˆ°åŒå‘é“¾è¡¨çš„è¡¨å°¾ã€‚&lt;/li&gt;
&lt;li&gt;3ã€éå†è®¿é—®çš„æ—¶å€™ï¼Œä¼šè®¿é—®headerçš„ä¸‹ä¸€ä¸ªnextèŠ‚ç‚¹ï¼Œè¿™å°±å½¢æˆäº†é¡ºåºè®¿é—®&lt;/li&gt;
&lt;/ul&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1592968145044.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;é“¾è¡¨å®ç°&#34;&gt;é“¾è¡¨å®ç°&lt;/h3&gt;
&lt;p&gt;å®ç°æ€è·¯ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;1ã€æ•°æ®æ˜¯ç›´æ¥åˆ©ç”¨ HashMap æ¥å­˜æ”¾çš„ã€‚&lt;/li&gt;
&lt;li&gt;2ã€å†…éƒ¨ä½¿ç”¨äº†ä¸€ä¸ªåŒå‘é“¾è¡¨æ¥å­˜æ”¾æ•°æ®ï¼Œæ‰€ä»¥æœ‰ä¸€ä¸ªå¤´ç»“ç‚¹ headerï¼Œä»¥åŠå°¾ç»“ç‚¹ tailerã€‚&lt;/li&gt;
&lt;li&gt;3ã€æ¯æ¬¡å†™å…¥å¤´ç»“ç‚¹ï¼Œåˆ é™¤å°¾ç»“ç‚¹æ—¶éƒ½æ˜¯ä¾èµ–äº header tailer&lt;br&gt;
&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1592220507945.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;import com.google.common.collect.Maps;
import java.util.Map;

/**
 * çº¿ç¨‹ä¸å®‰å…¨ï¼ŒåŒæ­¥æœºåˆ¶è‡ªè¡Œæ§åˆ¶ã€‚
 */
public class LRUCacheV2 {
    /**
     * ç¼“å­˜map
     */
    private final Map&amp;lt;String, Node&amp;gt; cacheMap;

    /**
     * å¤´æŒ‡é’ˆ
     */
    private Node head;

    /**
     * å°¾æŒ‡é’ˆ
     */
    private Node tail;

    /**
     * å®¹é‡
     */
    private final int cacheSize;

    /**
     * å½“å‰å®¹é‡
     */
    private int currentCacheSize;

    LRUCacheV2(int capacity){
        cacheMap = Maps.newHashMapWithExpectedSize(capacity);
        cacheSize = capacity;
        currentCacheSize = 0;
    }

    public Object get(String key){
        Node node = cacheMap.get(key);
        if(node != null){
            // ç§»åŠ¨åˆ°å¤´æŒ‡é’ˆ
            move2head(node);
            return node.getData();
        }
        return null;
    }

    public void remove(String key){
        Node node = cacheMap.get(key);
        if(node != null){
            Node pre = node.getPre();
            Node next = node.getNext();
            if(pre != null){
                pre.setNext(next);
            }
            if(next != null){
                next.setPre(pre);
            }

            // å¦‚æœåˆ é™¤åˆšå¥½æ˜¯å¤´èŠ‚ç‚¹æˆ–è€…å°¾èŠ‚ç‚¹ï¼Œä¹Ÿè¦ç§»åŠ¨æŒ‡é’ˆ
            if(node.getKey().equals(head.getKey())){
                head = pre;
            }
            if(node.getKey().equals(tail.getKey())){
                tail = next;
            }

            cacheMap.remove(key);
        }
    }

    public void put(String key, Object value){
        Node node = cacheMap.get(key);
        if(node != null){
            // å­˜åœ¨èŠ‚ç‚¹çš„è¯ï¼Œå°±è¦†ç›–ï¼Œå¹¶ä¸”æ”¾åˆ°å¤´
            node.setData(value);
            move2head(node);
            cacheMap.put(key, node);
        }else {
            // ä¸å­˜åœ¨èŠ‚ç‚¹ï¼Œæ„é€ å¹¶ä¸”æ”¾åˆ°å¤´
            if(currentCacheSize == cacheSize){
                // åˆ é™¤å°¾node
                String delKey = tail.getKey();
                cacheMap.remove(delKey);

                // å°¾æŒ‡é’ˆç§»åŠ¨
                Node next = tail.getNext();
                if(next != null){
                    next.setPre(null);
                }
                tail.setNext(null);
                tail = next;

            }else{
                currentCacheSize++;
            }
            node = new Node();
            node.setData(value);
            node.setKey(key);
            // å¤´æŒ‡é’ˆç§»åŠ¨
            move2head(node);
        }
        cacheMap.put(key, node);
    }

    /**
     * èŠ‚ç‚¹ç§»åˆ°å¤´
     */
    private void move2head(Node node){
        if(head == null){
            // åˆå§‹åŒ–head å’Œ tail
            head = node;
            head.setNext(null);
            head.setPre(null);
            tail = node;
        }else {
            // å¦‚æœæ˜¯ç›¸åŒçš„Keyï¼Œå•¥éƒ½ä¸ç”¨åŠ¨ï¼Œnodeå°±æ˜¯æœ€æ–°çš„å¤´
            if(node.getKey().equals(head.getKey())){
                return;
            }

            // æˆªå–node
            Node pre = node.getPre();
            Node next = node.getNext();
            if(pre != null){
                pre.setNext(next);
            }
            if(next != null){
                next.setPre(pre);
            }

            // å¦‚æœè¦æˆªå–çš„èŠ‚ç‚¹æ˜¯å°¾èŠ‚ç‚¹ï¼Œé‚£ä¹ˆå°¾èŠ‚ç‚¹æŒ‡é’ˆä¹Ÿè¦å‘å‰ç§»åŠ¨
            if(node.getKey().equals(tail.getKey())){
                tail = next;
            }

            // æ”¾åœ¨å¤´å‰é¢
            head.setNext(node);
            node.setPre(head);
            // nodeä¸‹ä¸ªæŒ‡é’ˆæŒ‡å‘null
            node.setNext(null);
            head = node;
        }
    }

    @Override
    public String toString() {
        StringBuilder sb = new StringBuilder() ;
        Node node = head;
        while (node != null){
            sb.append(node.getKey()).append(&amp;quot;:&amp;quot;)
                    .append(node.getData())
                    .append(&amp;quot;--&amp;gt;&amp;quot;) ;
            node = node.getPre();
        }
        return sb.toString();
    }

    public static void main(String[] args) {
        LRUCacheV2 lruCacheV2 = new LRUCacheV2(4);
        lruCacheV2.put(&amp;quot;1&amp;quot;,&amp;quot;1&amp;quot;);
        lruCacheV2.put(&amp;quot;2&amp;quot;,&amp;quot;2&amp;quot;);
        lruCacheV2.put(&amp;quot;3&amp;quot;,&amp;quot;3&amp;quot;);
        lruCacheV2.put(&amp;quot;4&amp;quot;,&amp;quot;4&amp;quot;);
        lruCacheV2.put(&amp;quot;5&amp;quot;,&amp;quot;5&amp;quot;);
        //lruCacheV2.get(&amp;quot;2&amp;quot;);
        //lruCacheV2.put(&amp;quot;2&amp;quot;,&amp;quot;22&amp;quot;);
        lruCacheV2.remove(&amp;quot;5&amp;quot;);
        System.out.println(lruCacheV2.toString());
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å‚è€ƒï¼š&lt;br&gt;
1ã€https://www.iteye.com/blog/gogole-692103&lt;br&gt;
2ã€https://crossoverjie.top/2018/04/07/algorithm/LRU-cache/&lt;/p&gt;
">O(1)æ—¶é—´å¤æ‚åº¦ä¸‹ï¼ŒåŒå‘é“¾è¡¨å®ç°LRU</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://zhangyaoo.github.io/post/2019-nian-zong-jie/"" data-c="
          &lt;p&gt;å°æç¤ºï¼šé˜…è¯»æ­¤ç¯‡æ–‡ç« å¤§çº¦éœ€è¦ä¸‰åˆ†é’Ÿæ—¶é—´ï¼Œä»¥ä¸‹éƒ½æ˜¯ä¸ªäººä¸€äº›ç”Ÿæ´»å·¥ä½œä¸Šç¢ç¢å¿µå¿µï¼Œå” å¨ç¢è¯­ï¼Œè¯·æ–Ÿé…Œé˜…è¯»~&lt;/p&gt;
&lt;p&gt;ç›®å½•&lt;br&gt;
å¼€å¤´&lt;br&gt;
å­¦ä¹ &lt;br&gt;
å·¥ä½œ&lt;br&gt;
è¿åŠ¨&lt;br&gt;
ç”Ÿæ´»&lt;br&gt;
æ¸¸æˆ&lt;br&gt;
ç¾é£Ÿ&lt;br&gt;
äº²æƒ…&lt;br&gt;
çˆ±æƒ…&lt;br&gt;
2020flag&lt;/p&gt;
&lt;p&gt;â€”â€”â€”â€”â€”â€”â€”â€”æˆ‘æ˜¯åˆ†å‰²çº¿â€”â€”â€”â€”â€”â€”&lt;/p&gt;
&lt;p&gt;å¼€å¤´&lt;br&gt;
åˆè¿‡äº†ä¸€å¹´ï¼Œè®°å¾—ä¸Šä¸€æ¬¡å†™å¹´ç»ˆæ€»ç»“è¿˜æ˜¯åœ¨æˆ‘ç‹—çª(å‡ºç§Ÿæˆ¿)é‡Œé¢å†™çš„ï¼Œè¿™ä¸€æ¬¡æ˜¯åœ¨å—äº¬å—ç«™å¼€å§‹å†™çš„ã€‚&lt;br&gt;
æ·±åœ³çš„å¤©æ°”å°±æ˜¯è¿™ä¹ˆç¥å¥‡ï¼Œä¸€å¹´åˆ°å¤´ç©¿çŸ­è¢–ï¼Œæ›¾å’Œæˆ‘æœ‹å‹ç«‹ä¸‹ä¸€ä¸ªflagï¼Œè¯´åœ¨æ·±åœ³365å¤©300å¤©ç©¿çŸ­è¢–ï¼Œä¸ç„¶å°±æ´—ä¸€ä¸ªæœˆç¢—ï¼Œä¼¼ä¹ä»Šå¹´æ¸©åº¦é™çš„æ—©ï¼Œæ—©æ—©å°±ç©¿ä¸Šäº†çŸ­è¢–ï¼Œ(flagæœç„¶å¯¹äºæˆ‘æ¥è¯´å°±æ˜¯æ‰“è„¸çš„)ï¼Œæ‰€ä»¥æ˜å¹´æ¥å°±ç»™è‡ªå·±è£…é€¼è¡Œä¸ºä»˜å‡ºä»£ä»·ï¼ˆâ•¯&#39; - &#39;)â•¯ï¸µ â”»â”â”»&lt;br&gt;
è¿™é‡Œä¸€ç›´éƒ½æ˜¯å¤å¤©ï¼Œä¸èƒ½åƒå®¶ä¹¡ä¸€æ ·èƒ½æ„Ÿå—åˆ°å››å­£çš„å˜åŒ–ï¼Œæ„Ÿè§‰æ—¶é—´è¿‡çš„ç‰¹åˆ«å¿«ï¼Œæœ‰ä¸€æ¬¡åœ¨å…¬å¸æ•²ä»£ç æ—¶å€™ï¼Œå¬åˆ°äº†é¸Ÿé¸£å£°ï¼Œç¬é—´å°±æƒ³èµ·äº†å®¶ä¹¡ç”°é‡ä¸­çš„é¸Ÿå«è™«é¸£ï¼Œè„‘æµ·é‡Œå°±æµ®ç°äº†é‚£å¹´å¤å¤©ï¼Œåƒç€å†°æ£ï¼Œå¬ç€è‰é¸£çš„æ—§æ—¶å…‰ã€‚&lt;br&gt;
è¿™ä¸€å¹´æœ‰è®¸å¤šå€¼å¾—å†™çš„ä¸œè¥¿ï¼Œç”Ÿæ´»ä¸­çš„å„ä¸ªæ–¹é¢éƒ½æœ‰ã€‚ç”¨æˆ‘è€çˆ¹ä¸€å¥è¯ï¼Œä¸€å¹´æ—¶é—´ä¸ç®¡æ˜¯è¿›æ­¥å¤šå°‘ï¼Œåªè¦ä¸æ˜¯åŸåœ°è¸æ­¥èµ°å°±å¯ä»¥ã€‚è¿™æ¬¡è¿˜æ˜¯åƒ2018å¹´æ€»ç»“ä¸€æ ·ç»™è‡ªå„åšä¸€äº›æ€»ç»“å’Œä¸€äº›ï¼ˆç»™è‡ªå·±æ‰“è„¸çš„ï¼‰flag&lt;/p&gt;
&lt;p&gt;å­¦ä¹ &lt;br&gt;
è¯´èµ·å­¦ä¹ ï¼Œè¿™é‡Œæ”¾åœ¨æœ€å¼€å§‹å†™ï¼Œè‡ªè®¤ä¸ºå­¦ä¹ æ˜¯è‡ªå·±æå‡è‡ªå·±çš„æœ€ç›´æ¥æœ€æœ‰æ•ˆçš„æ–¹å¼ã€‚ä»å°å­¦åˆ°é«˜ä¸­ä»¥è‡³äºå¤§å­¦çš„çŸ¥è¯†ï¼Œéƒ½æ˜¯çš®æ¯›ã€‚é‡è¦æ˜¯åŸ¹å…»äº†å¿«é€Ÿå­¦ä¹ èƒ½åŠ›å’Œè‡ªå­¦çš„ä¹ æƒ¯ï¼Œè¿™ä¸ªå¯ä»¥è¯´æ˜¯è‡ªå„å­¦ä¸šç”Ÿæ¶¯ä¸­è·å¾—æœ€æœ‰ä»·å€¼çš„ä¸œè¥¿äº†ã€‚ä½†æ˜¯è¿™æ˜¯ä¸å¤Ÿçš„ï¼Œå¯¹äºç”Ÿæ´»ä¸­è®¤çŸ¥å’Œå·¥ä½œçš„æ–¹é¢ï¼Œè‡ªæˆ‘ç‹¬ç«‹æ€è€ƒä¹Ÿæ˜¯å¿…ä¸å¯å°‘çš„ã€‚è‡ªå„ä¹Ÿåœ¨ç‰¹æ„å»æ³¨é‡ï¼ŒåŸ¹å…»è‡ªå„çš„ç‹¬ç«‹æ€è€ƒçš„èƒ½åŠ›ã€‚&lt;br&gt;
åœ¨è¿™æ„Ÿè°¢äº‘æ™ºæƒ IPOæ‰€æœ‰åå°åŒå­¦ï¼Œä»¥åŠ@é™ˆç§¦åœ† åŒå­¦ï¼Œè®©è‡ªå·±è®¤è¯†åˆ°ç‹¬ç«‹æ€è€ƒå’Œå›¢é˜Ÿåˆä½œçš„é‡è¦æ€§ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸€å¹´æœ‰å­¦ä¹ åˆ°ä¸œè¥¿æœ‰ï¼š&lt;br&gt;
æå®¢æ—¶é—´çš„æ•°æ®ç»“æ„å’Œç®—æ³•ä¹‹ç¾&lt;br&gt;
è®¾è®¡æ¨¡å¼ä¹‹ç¾(åªçœ‹äº†ä¸€ç« )&lt;br&gt;
ç‰›å®¢ç½‘çš„å‰‘æŒ‡offer(åªåˆ·äº†30é“)&lt;br&gt;
åŠ›æ‰£leetcode(åªåˆ·äº†60é“)&lt;br&gt;
ã€Šnettyå®æˆ˜ã€‹&lt;br&gt;
æ­å»ºå¼€æºé¡¹ç›®fast-imè„šæ‰‹æ¶&lt;br&gt;
é‡‘èä¸šåŠ¡çŸ¥è¯†&lt;br&gt;
æ²ˆå‰‘çš„æ¶æ„å¸ˆä¹‹è·¯ï¼ˆåªçœ‹äº†äºŒåç¯‡ï¼‰&lt;/p&gt;
&lt;p&gt;æ¥å¹´ç›®æ ‡ï¼š&lt;br&gt;
ç»§ç»­å®Œæˆå¼€æºé¡¹ç›®&lt;br&gt;
ç»è¥å¥½ä¸ªäººåšå®¢&lt;br&gt;
æ¶æ„å¸ˆä¹‹è·¯å­¦ä¹ &lt;br&gt;
ã€Šredisè¿›é˜¶ã€‹&lt;br&gt;
ã€Šå‰‘æŒ‡offerã€‹&lt;br&gt;
å¤§æ•°æ®ç›¸å…³çŸ¥è¯†&lt;/p&gt;
&lt;p&gt;çœ‹äº†å…¶ä»–ä¹¦ç±ï¼š&lt;br&gt;
ã€Šäº®å‰‘ã€‹&lt;br&gt;
ã€Šå¯»è·¯ä¸­å›½ã€‹&lt;/p&gt;
&lt;p&gt;ç”»å¤–éŸ³ï¼šä¸€å¹´æ—¶é—´å­¦çš„è¿™ä¹ˆå°‘ï¼Œè¿˜è´´å‡ºæ¥ï¼ˆè„¸çš®æœ‰ç‚¹åšğŸ˜‚ï¼Œæ‰‹åŠ¨ç‹—å¤´ï¼‰&lt;/p&gt;
&lt;p&gt;å·¥ä½œ&lt;br&gt;
åœ¨äº‘æ™ºæƒ çš„ä¸€å¹´åŠæ—¶é—´é‡Œï¼Œè‡ªå„å­¦ä¹ äº†è®¸å¤šå’Œå·¥ä½œç›¸å…³çš„çŸ¥è¯†ï¼Œè®¤è¯†äº†è®¸å¤šä¼˜ç§€çš„åŒå­¦ï¼Œæˆé•¿äº†å¹¶ä¸”æ”¶è·äº†è®¸å¤šï¼Œæ„Ÿè°¢äº‘æ™ºæƒ æä¾›çš„èŒåœºå¹³å°ã€‚è™½ç„¶ç°åœ¨å·²ç»å¿«è¦è§£æ•£äº†ï¼Œä½†æ˜¯è¿˜æ˜¯è¡¨ç¤ºè¡·å¿ƒæ„Ÿè°¢ã€‚æ±Ÿæ¹–å†è§ï¼&lt;/p&gt;
&lt;p&gt;è¿åŠ¨&lt;br&gt;
å”¯ä¸€ä¸€ä¸ªåœ¨2019å¹´ç«‹å¾—æ²¡æœ‰è¢«æ‰“è„¸çš„flagï¼Œå°±æ˜¯è¿åŠ¨ã€‚æ¯å‘¨ä¸€æ¬¡ç¯®çƒæˆ–è€…è·‘æ­¥ã€‚&lt;br&gt;
è·‘æ­¥å‘¢ï¼Œä¸€èˆ¬è·‘ä¸ª4å…¬é‡Œä¸€æ¬¡ã€‚å¤§æ¦‚è·‘äº†äºŒåæ¬¡ï¼Œ100å…¬é‡Œå·¦å³ï¼Œè¿™é‡Œåªè®°å½•äº†ä¸€åŠï¼Œå¦å¤–ä¸€åŠæ²¡æœ‰è®°å½•ï¼ˆè¿™å¥æ˜¯çœŸçš„ï¼‰ã€Œå“­ç¬‘:-Dã€&lt;/p&gt;
&lt;p&gt;ç¯®çƒå‘¢ï¼Œç°åœ¨æŠ•ç¯®ä¸å‡†ï¼Œè¿çƒè¾£çœ¼ç›ï¼Œå·²ç„¶ä¸€å‰¯è€å¹´ç¯®çƒçš„æ ·å­ã€‚ä½†æ˜¯è¿˜æ˜¯é˜»æŒ¡ä¸äº†æˆ‘å–œæ¬¢è¿™ä¸€é¡¹è¿åŠ¨ï¼Œå°±åƒçŒç¯®é«˜æ‰‹åŠ¨æ¼«ä¸­ä¸€å¥è¯â€œæ•™ç»ƒï¼Œæˆ‘æƒ³æ‰“ç¯®çƒâ€è¿™æ ·ï¼Œæºè‡ªäºå†…å¿ƒçš„çƒ­çˆ±ã€‚&lt;/p&gt;
&lt;p&gt;ç”Ÿæ´»&lt;br&gt;
è¿™ä¸€å¹´æˆ‘æƒ³äº†å¾ˆä¹…ï¼Œå¾—åˆ°äº†ä»€ä¹ˆå¤±å»äº†ä»€ä¹ˆã€‚ã€‚æˆ‘æƒ³äº†å¾ˆä¹…ï¼Œçªç„¶æƒ³èµ·æ¥ï¼Œ&lt;br&gt;
å¾—åˆ°çš„å½“ç„¶æ˜¯è‚šå­çš„è‚¥è‚‰èµ˜è‚‰å’¯ï¼Œï¼Œå¤±å»çš„ä½ ä»¬ä¹ŸçŸ¥é“ï¼Œè‚¯å®šæ˜¯æˆ‘ç¨€è–„çš„å¤´å‘ã€‚ã€‚&lt;/p&gt;
&lt;p&gt;å½“è‡ªå„å‘é™…çº¿è¶Šæ¥è¶Šé«˜çš„æ—¶å€™ï¼Œå°±åœ¨æ€è€ƒäººç”Ÿï¼Œä¸ºä»€ä¹ˆé•¿å¾—è¿™ä¹ˆå¸…ï¼Œåˆ°è¦æ‰å¤´å‘&lt;/p&gt;
&lt;p&gt;ä»æ­¤èŠèŠ±èŒ¶â•æ¸æå·²æ˜¯æ ‡é…ï¼Œæ—©ç¡æ—©èµ·å·²æ˜¯äººç”Ÿç®´è¨€ğŸ˜‚ï¼Œç‹—å‘½è¦ç´§&lt;/p&gt;
&lt;p&gt;æ¸¸æˆ&lt;br&gt;
å¹³å¸¸é¸­æ¢¨å¤§æ—¶å€™å¶å°”æ‰“æ‰“æ¸¸æˆæ”¾æ¾æ”¾æ¾ï¼Œ&lt;br&gt;
ä»Šå¹´å‡­å€Ÿè‡ªå·±çš„å¤©èµ‹(è£…ä¸€ä¸‹B)å’Œä¸æ‡ˆåŠªåŠ›ï¼Œæ‰“åˆ°ç™½é‡‘ä¸€ã€‚ç¦»è‡ªå·±çš„å°ç›®æ ‡åˆè¿‘äº†ä¸€æ­¥ï¼Œäº‰å–ä»Šå¹´ä¸Šç –çŸ³ï¼Œè®©æˆ‘å½“ä¸ªç –çŸ³å®ˆé—¨å‘˜ä¹Ÿè¡ŒğŸ¤ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿™å†™ä¸Šæœ€å–œæ¬¢è‹±é›„çš‡å­çš„å°è¯ï¼šâ€œæ‰€åˆ°ä¹‹å¤„ï¼Œæ— äººèƒ½æŒ¡ï¼â€&lt;/p&gt;
&lt;p&gt;ç¾é£Ÿ&lt;/p&gt;
&lt;p&gt;ä»€ä¹ˆæœ€é‡è¦ï¼Œå½“ç„¶æ˜¯åƒã€‚&lt;br&gt;
æƒ³æƒ³è¿™ä¸€å¹´åšçš„ç¾é£Ÿï¼Œå’ŒåŒå­¦ä¸€èµ·åšçš„ï¼Œæ­¤å¤„@è‚‰å’Œæ¨ä¸½ä¸½ï¼Œæ„Ÿè°¢ä¸€èµ·ç›¸å¤„ä¸€å¹´ï¼Œå­¦åˆ°äº†å¾ˆå¤šç¾é£Ÿæ˜¯å¦‚ä½•åšçš„ï¼Œæˆ‘èº«è¾¹çš„éšè—å¤§å¨ğŸ˜‚ã€‚&lt;br&gt;
ä»Šå¹´å­¦åˆ°äº†æœ‰çº¢çƒ§é²«é±¼ï¼Œç³–é†‹æ’éª¨ï¼Œè‘±èŠ±é¥¼ï¼Œå¯ä¹é¸¡ç¿…ï¼Œçº¢çƒ§è‚‰ï¼Œè‡ªåˆ¶å‡‰èœï¼Œæ°´ç…®è‚‰ç‰‡ï¼Œè‡ªåˆ¶çƒ¤é±¼ï¼Œå›é”…è‚‰ç­‰ç­‰ç­‰ç­‰ï¼Œå°±æ”¾ä¸€å¼ å’ŒåŒå­¦ä¸€èµ·åšé¥ºå­çš„å›¾ç‰‡ï¼Œä¸å¤šæ”¾äº†ï¼Œå…å¾—æ™šä¸Šä¸­æ¯’å¤ªæ·±ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;p&gt;ç”»å¤–éŸ³ï¼šä¸Šé¢é¥ºå­ï¼ˆçœ‹èµ·æ¥åƒï¼‰çœŸçš„ä¸æ˜¯æˆ‘åŒ…çš„&lt;/p&gt;
&lt;p&gt;äº²æƒ…&lt;br&gt;
ç‰¹åˆ«å–œæ¬¢ã€Šè¯·å›ç­”1988ã€‹é‡Œé¢å®¶åº­äº²æƒ…ï¼Œæ•´éƒ¨ç‰‡è™½ç„¶ä¸ä¹çˆ±æƒ…å‹æƒ…ç­‰ï¼Œä½†æ˜¯æˆ‘è§‰å¾—æ ¸å¿ƒæ˜¯äº²æƒ…ï¼Œæœ€æœ‰å°è±¡è¿˜æ˜¯å®æ‹‰å¦ˆå¦ˆä¸‹é›¨å¤©æŠ¤ç€å®æ‹‰é‚£æ®µã€‚&amp;quot;äººçœŸæ­£å˜å¼ºå¤§ï¼Œä¸æ˜¯å› ä¸ºå®ˆæŠ¤ç€è‡ªå°Šå¿ƒï¼Œè€Œæ˜¯æŠ›å¼€è‡ªå°Šå¿ƒçš„æ—¶å€™ï¼Œå› ä¸ºæœ‰éœ€è¦å®ˆæŠ¤çš„äºº&amp;quot;&lt;br&gt;
è¿™å¥è¯è¿˜æ˜¯éœ€è¦è‡ªå·±å»ç»å†ä½“ä¼šçš„ã€‚&lt;br&gt;
ä»¥å‰è§‰å¾—ï¼Œå‡ºçœä¸Šå­¦ï¼Œå‡ºçœå·¥ä½œï¼Œå¯ä»¥ç¦»å®¶äººè¿œä¸€ç‚¹ï¼Œå°±åƒæ˜¯æ˜¥å¤©çš„ç‡•å­ï¼Œé•¿å¤§äº†éƒ½æƒ³çœ‹çœ‹å¤–é¢çš„ä¸–ç•Œï¼Œå»é—¯è¡å»ç»å†ï¼Œå»ä¸°å¯Œè‡ªå·±çš„ç”Ÿæ´»å¢é•¿è‡ªå·±è§è¯†ã€‚å¯åˆ°äº†ä¸€å®šçš„å¹´é¾„æˆ–è€…è®¤çŸ¥ï¼Œä¼šæ„è¯†åˆ°ï¼Œæœ‰å®¶äººåœ¨çš„åœ°æ–¹ï¼Œéƒ½è§‰å¾—å¾ˆçŸ¥è¶³ã€‚ç‰¹åˆ«å–œæ¬¢ã€Šå››ä¸ªæ˜¥å¤©ã€‹çºªå½•ç‰‡é‡Œé¢ç‡•å­å½’æ¥ä¹‹æ—¶ï¼Œé‚£ç§æ„Ÿè§‰ï¼Œçºªå½•ç‰‡ä¸­çˆ¶æ¯çœ‹åˆ°ç‡•å­å½’æ¥ï¼Œå¿ƒé‡Œå¿µå¨ç€ï¼Œå’±å®¶å°ç‡•å­ä¹Ÿè¯¥å›å®¶äº†ã€‚&lt;/p&gt;
&lt;p&gt;çˆ±æƒ…&lt;br&gt;
æ„Ÿè°¢å…šæ„Ÿè°¢å›½å®¶ç»™æˆ‘å‘äº†ä¸€ä¸ªå¥³æœ‹å‹ï¼Œå…è´¹æ»´ã€‚&amp;lt;( Ë˜ Â³Ë˜)/ğŸ’¯&lt;br&gt;
ä»Šå¹´æœ€å¤§æ”¶è´§ï¼Œå½“ç„¶æ˜¯é‡åˆ°æ–¹å°çš®åŒå­¦å•¦ï¼Œï¼ˆé»˜é»˜æ’’ä¸€ä¸‹æ–°é²œç‹—ç²®ï¼‰å¸Œæœ›åœ¨ä»¥åçš„æ—¥å­é‡Œï¼Œä½ èƒ½å¤Ÿæ—©ç¡æ—©èµ·ï¼Œåƒå¥½å–å¥½ï¼Œèº«ä½“æ£’æ£’ã€‚&lt;/p&gt;
&lt;p&gt;æœ€åè‚¯å®šæ˜¯å†™ä¸€äº›æ‰“è„¸çš„ä¸œè¥¿ã€‚ã€‚&lt;br&gt;
2020å¹´flag&lt;br&gt;
è‡ªä¿¡&lt;br&gt;
ä¸€å‘¨ä¸€æ¬¡è·‘æ­¥æˆ–è€…ç¯®çƒ&lt;br&gt;
çœ‹å®Œå‰©ä½™ä¹¦ç±&lt;br&gt;
ç»è¥å¥½ä¸ªäººåšå®¢&lt;br&gt;
æ´—è„šåŸæ´—ä¸€æ¬¡è„š(æœ‰ä»€ä¹ˆä¸œè¥¿æ¸—å…¥è¿›æ¥äº†)&lt;br&gt;
ä½“é‡ä¸è¶…130&lt;br&gt;
æ—©ç¡æ—©èµ·ï¼Œ11ç‚¹ä¹‹å‰ç¡ï¼ˆè™½ç„¶æ˜¯ä¸å¯èƒ½çš„ï¼‰&lt;br&gt;
å­¦ä¹ å¤§æ•°æ®ç›¸å…³çŸ¥è¯†&lt;br&gt;
ä¿æŠ¤çœ¼ç›&lt;/p&gt;
&lt;p&gt;ä»¥ä¸Šï¼Œå®Œ&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://zhangyaoo.github.io/post-images/1593268924481.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
æœ€åè´´ä¸Šè‡ªå„æœ€å–œæ¬¢çš„ç…§ç‰‡ï¼Œ2015å¹´äºè¥¿è—æ‹&lt;/p&gt;
">2019å¹´æ€»ç»“</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://zhangyaoo.github.io/post/about/"" data-c="
          &lt;blockquote&gt;
&lt;p&gt;æ¬¢è¿æ¥åˆ°æˆ‘çš„å°ç«™å‘€ï¼Œå¾ˆé«˜å…´é‡è§ä½ ï¼ğŸ¤&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;å…³äºæœ¬ç«™&#34;&gt;ğŸ  å…³äºæœ¬ç«™&lt;/h2&gt;
&lt;p&gt;ä¸€äº›æŠ€æœ¯åšå®¢å’Œä¸€äº›é—²è¨€ç¢è¯­&lt;/p&gt;
&lt;h2 id=&#34;åšä¸»æ˜¯è°&#34;&gt;ğŸ‘¨â€ğŸ’» åšä¸»æ˜¯è°&lt;/h2&gt;
&lt;p&gt;è¿˜åœ¨æ‰“æ€ªå‡çº§çš„èœé¸Ÿ&lt;/p&gt;
&lt;h2 id=&#34;å…´è¶£çˆ±å¥½&#34;&gt;â›¹ å…´è¶£çˆ±å¥½&lt;/h2&gt;
&lt;p&gt;æ’¸ç ã€äºŒæ¬¡å…ƒã€éª‘è¡Œã€ç¯®çƒã€LOL&lt;/p&gt;
&lt;h2 id=&#34;è”ç³»æˆ‘å‘€&#34;&gt;ğŸ“¬ è”ç³»æˆ‘å‘€&lt;/h2&gt;
&lt;p&gt;æ‰‹æœºï¼ˆå¾®ä¿¡åŒï¼‰ï¼š15112342449&lt;/p&gt;
">å…³äº</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://zhangyaoo.github.io/post/2018-nian-zong-jie/"" data-c="
          &lt;h2 id=&#34;å†™ç»™è‡ªå·±çš„2018å¹´æ€»ç»“&#34;&gt;å†™ç»™è‡ªå·±çš„2018å¹´æ€»ç»“&lt;/h2&gt;
&lt;h2 id=&#34;é¢˜è®°&#34;&gt;é¢˜è®°&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://img-blog.csdnimg.cn/20181231115831927.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3p5MTUxMTIzNDI0NDk=,size_16,color_FFFFFF,t_70&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ä¸è§‰ä¸­ï¼Œ2018å¹´å°±å¿«è¿‡äº†ï¼Œåœ¨è¿™ä¹‹å‰ä»æ¥æ²¡æœ‰å†™è¿‡ä¸€äº›æ€»ç»“æ€§çš„æ–‡ç« ï¼Œä»å°å­¦åˆä¸­æ—¥å¿—ä½œä¸šï¼Œåˆ°é«˜ä¸­çš„æ—¥å¤ä¸€å¤œçš„å­¦ä¹ å†åˆ°å¤§å­¦çš„æµ‘æµ‘å™©å™©çš„åƒµç¡¬å¼çš„å­¦ä¹ ï¼Œä¸€ç›´éƒ½åœ¨è¿›è¡Œæµæ°´è´¦å¼çš„å­¦ä¹ è¾“å…¥ï¼Œä»æ²¡æœ‰å†™è¿‡å…³äºä¸€å¹´çš„è®¡åˆ’ç”šè‡³æ˜¯ä¸€ä¸ªæœˆçš„å°ç›®æ ‡ã€‚&lt;/p&gt;
&lt;p&gt;è‡³äºä¸ºä»€ä¹ˆè¦åšè¿™ä¸ªæ€»ç»“ï¼Œæˆ‘æƒ³æ˜¯å› ä¸ºï¼Œå¹´å¤ä¸€å¹´çš„åº¦è¿‡ï¼Œæœ‰æ—¶å€™è‡ªå·±éƒ½ä¸çŸ¥é“åœ¨è¿™ä¸€å¹´å¹²è¿‡ä»€ä¹ˆäº‹æƒ…ã€æ”¶è·äº†ä»€ä¹ˆå’Œå¤±å»äº†ä»€ä¹ˆï¼ŒåŒ…æ‹¬å¯¹å‹æƒ…ã€äº²æƒ…å’Œäº‹ä¸šç­‰ç­‰ã€‚æ˜¯å› ä¸ºæˆ‘è®°æ€§å¤ªå·®ï¼Œè¿˜æ˜¯è¯´åœ¨è¿™ä¸ªå¨±ä¹ä¿¡æ¯çˆ†ç‚¸çš„æ—¶ä»£ï¼Œæˆ‘æ³¨æ„åŠ›éƒ½é›†ä¸­åœ¨å¿«é¤å¼çš„çš„è®¤çŸ¥ä¸Šï¼Œå¾ˆéš¾æœ‰ç²¾åŠ›æˆ–è€…é›†ä¸­æ³¨æ„åŠ›å»æ±²å–è‡ªå·±æƒ³è¦çš„é«˜è´¨é‡çš„ä¿¡æ¯ä¸Šï¼Œä¸å¾—è€ŒçŸ¥ã€‚æ‰€ä»¥ä»Šå¹´æˆ‘è§‰å¾—æœ‰å¿…è¦å»æ€»ç»“è‡ªå·±çš„è¿™ä¸€å¹´ã€‚&lt;/p&gt;
&lt;p&gt;æ€»ç»“ç›®å½•ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å…³äºæŠ€æœ¯&lt;/li&gt;
&lt;li&gt;å…³äºè®¤çŸ¥&lt;/li&gt;
&lt;li&gt;å…³äºä¸ºäººå¤„äº‹&lt;/li&gt;
&lt;li&gt;å…³äºå‹æƒ…çˆ±æƒ…äº²æƒ…&lt;/li&gt;
&lt;li&gt;2019å±•æœ›&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;1-å…³äºæŠ€æœ¯&#34;&gt;1ã€å…³äºæŠ€æœ¯&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://img-blog.csdnimg.cn/20181231120336118.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3p5MTUxMTIzNDI0NDk=,size_16,color_FFFFFF,t_70&#34; alt=&#34;åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
1ã€æŠ€æœ¯ç§¯ç´¯&lt;br&gt;
å¸ˆèŒƒä¸“ä¸šæ¯•ä¸šçš„æˆ‘ä»å¤§ä¸‰å¼€å§‹æ¥è§¦è®¡ç®—æœºï¼Œå¤§ä¸‰é‚£å¹´å­¦çš„ç½‘ç»œå·¥ç¨‹ï¼Œè¿˜è€ƒäº†ä¸ªCCNAï¼Œç›®å‰å‘ç°æ²¡æœ‰ä»€ä¹ˆç”¨ï¼Œå¯¹äºç°åœ¨çš„æˆ‘æ¥è¯´ã€‚ç„¶åè¢«ä½åœ¨ä¸Šé“ºçš„å…„å¼Ÿ67ä»£å…¥å‘é‡Œå­¦ä¹ codeæ¬ç –ï¼Œä»é‚£å¼€å§‹ä¾¿ä¸€å‘ä¸å¯æ”¶æ‹¾ï¼ŒåŸ‹å¤´è‹¦å­¦ï¼Œè¿æ•™å¸ˆèµ„æ ¼è¯éƒ½ä¸è€ƒï¼Œè·‘å‡ºå»å…¬å¸é‡Œé¢å½“å°å¼Ÿå®ä¹ ã€‚è‡³æ­¤å°±å¼€å§‹æŠ€æœ¯ç§¯ç´¯ä¹‹è·¯äº†ã€‚&lt;/p&gt;
&lt;p&gt;å½“å°å¼Ÿé‚£ä¸€æ®µæ—¶é—´ï¼Œå°±åƒåˆšèŒå‘çš„ç§å­ä¸€æ ·ç–¯ç‹‚å¸æ”¶è¥å…»ï¼Œå­¦äº›äº†pythonçˆ¬è™«ã€python webå¼€å‘ã€Javaå…¬ä¼—å·å¼€å‘ï¼ŒSSM Javaå…¨å®¶æ¡¶å¼€å‘ã€‚è¿™äº›éƒ½æ˜¯åœ¨å­¦æ ¡å­¦ä¸åˆ°çš„ä¸œè¥¿ï¼Œå½“æ—¶æ„Ÿè§‰è‡ªå·±å¾ˆç‰›é€¼ï¼Œç›´åˆ°æ¯•ä¸šæ‰¾å·¥ä½œã€‚&lt;/p&gt;
&lt;p&gt;æ¯•ä¸šé‚£ä¸€åˆ»èµ·ï¼Œå› ä¸ºæŠ€æœ¯å‘å±•ç“¶é¢ˆï¼Œæˆ‘åˆèƒŒä¸Šè¡Œå›Šæ¨ªè·¨å¤§åŠä¸ªä¸­å›½ä»å±±ä¸œå»å—æ–¹ä¸€çº¿åŸå¸‚æ¼‚ã€‚æ‹¿è¿™è‡ªä»¥ä¸ºé«˜å¤§ä¸Šçš„ç®€å†å»æŠ•é€’ï¼Œç„¶åé¢è¯•ï¼Œæƒ¨é­é¢è¯•å®˜çš„å•ªå•ªæ‰“è„¸ï¼Œè¿ä¸€ä¸ªhashmapçš„åº•å±‚åŸç†éƒ½ä¸çŸ¥é“ï¼Œæœ€æœ‰å°è±¡çš„æ˜¯Java å¾ªç¯åˆ é™¤listæ€ä¹ˆåˆ é™¤ï¼Œå›ç­”å®Œååˆ«é¢è¯•å®˜ä¸€è„¸å«Œå¼ƒ-ã€‚-&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;åªä¼šæ‹¿ç€ç°æˆçš„æ¡†æ¶å’Œåº”ç”¨å»ç”¨ï¼Œè€Œä¸çŸ¥é“åº•å±‚çš„å®ç°æ–¹å¼å’ŒåŸç†ï¼Œé‚£ä¹ˆå·¥ä½œæ€§è´¨å°±å’Œç½‘ç®¡å·®ä¸å¤š&lt;/strong&gt;ã€‚&lt;br&gt;
ä¸ä¼šä¸¾ä¸€åä¸‰ï¼Œå¦‚æœåˆæœ‰æ–°çš„æ¡†æ¶å‡ºæ¥åˆå¿…é¡»è¦å­¦ä¹ ä¸€éï¼Œå¦‚æœè¯´æŒæ¡äº†åº•å±‚å·¥ä½œåŸç†ï¼Œé‚£ä¹ˆç”¨èµ·æ¥ä¼šèˆ’æœå¾ˆå¤šã€‚&lt;/p&gt;
&lt;p&gt;2ã€æŠ€æœ¯åˆ†äº«&lt;br&gt;
&lt;img src=&#34;https://img-blog.csdnimg.cn/20181231124820725.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3p5MTUxMTIzNDI0NDk=,size_16,color_FFFFFF,t_70&#34; alt=&#34;åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;strong&gt;åˆ†äº«çš„ä¹è¶£ï¼Œä»ä¸€å¼€å§‹å°±åœä¸ä¸‹æ¥ã€‚&lt;/strong&gt;&lt;br&gt;
å…¬å¸ä¼šå‘¨æœŸæ€§çš„é€‰ä¸€äº›å½“ä¸‹çƒ­é—¨çš„æŠ€æœ¯è®©æˆ‘ä»¬å»ç ”ç©¶ï¼Œç„¶åå»æŠŠè‡ªå·±ç ”ç©¶çš„å†…å®¹åˆ†äº«å‡ºæ¥ã€‚æˆ‘è®¤ä¸ºè¿™æ˜¯éå¸¸æ£’çš„ä¸€ç§å­¦ä¹ æ–¹å¼ã€‚ä¸ºä»€ä¹ˆè¿™ä¹ˆè¯´ã€‚å› ä¸ºè¿™ä¸ªæ˜¯éå¸¸å…·ä½“æŒ‘æˆ˜æ€§çš„ï¼Œä½ ç†è§£äº†æ˜¯ä¸€ä¸ªå±‚æ¬¡ï¼Œå¦‚æœè¯´è¦ç»™åˆ«äººå°†æ˜ç™½åˆæ˜¯å¦å¤–ä¸€ä¸ªå±‚æ¬¡ï¼Œè¿™æ˜¯ä¸¤ä¸ªä¸åŒå±‚æ¬¡çš„æ¦‚å¿µã€‚å¦‚æœè¯´ä½ çš„è¯­è¨€è¡¨è¾¾æ€§ä¸è¡Œï¼Œé‚£ä¹ˆè¿™ä¸ªå°±æ˜¯æ›´åŠ éš¾ä¸ŠåŠ éš¾äº†ã€‚&lt;/p&gt;
&lt;p&gt;åˆ†äº«çš„ä¹è¶£ä¸ä»…æ˜¯è¿™ä¸ªï¼Œå½“ä½ ç»™åˆ«äººè®²å®Œåï¼Œä½ è¿˜å¯ä»¥é€šè¿‡åˆ«äººæä¾›çš„é—®é¢˜å’Œå»ºè®®æ–¹æ¡ˆï¼Œå’Œä½ è‡ªå·±çš„ç†è§£è¿›è¡Œç¢°æ’ï¼Œç„¶åäº§ç”Ÿæ–°çš„è®¤çŸ¥å…ƒç´ ï¼Œåˆ°ä¸‹ä¸€æ¬¡åˆ†äº«å°±å¯ä»¥èå…¥ä¸Šæ¬¡åˆ†äº«çš„è®¤çŸ¥è¿›æ¥ã€‚&lt;/p&gt;
&lt;p&gt;åˆ°ç°åœ¨ä¸ºæ­¢ï¼Œæˆ‘è¿˜åœ¨æƒ³ï¼Œæ€ä¹ˆåœ¨ç»™åˆ«äººè®²è§£åˆ†äº«çš„æ—¶å€™èƒ½å¤Ÿæ›´èƒ½è®©åˆ«äººå¬æ‡‚ï¼Œè€Œä¸”æ„¿æ„å»å¬ã€‚æˆ‘æœ€æ€•è¿˜æ˜¯åœ¨åˆ†äº«çš„æ—¶å€™åˆ«äººåœ¨ç©æ‰‹æœºã€‚å› ä¸ºæœ‰äº†è¿™ä¸ªç°è±¡å°±è¡¨æ˜ä½ çš„åˆ†äº«åšçš„ä¸å¤Ÿå¥½ã€‚&lt;/p&gt;
&lt;p&gt;3ã€ä¹¦ç±&lt;br&gt;
&lt;strong&gt;åœ¨è¿™ä¸ªæ‰‹æœºä¸‡èƒ½çš„æ—¶ä»£ï¼Œèƒ½å¤Ÿé™ä¸‹å¿ƒæ¥çœ‹å®Œä¸€æœ¬ä¹¦å¹¶ç†è§£æ˜¯éå¸¸ä¸å®¹æ˜“çš„&lt;/strong&gt;ã€‚&lt;br&gt;
æˆ–è®¸ä½ ä»¬éƒ½è¯´å“ªæœ‰æ—¶é—´çœ‹ä¹¦ï¼Œéƒ½å¿™å·¥ä½œä»»åŠ¡äº†ï¼Œç”šè‡³æœ‰æ—¶å€™æˆ‘è‡ªå·±éƒ½ä¸æ•¢è¯´ä¸€ä¸ªæœˆçœ‹å®Œä¸€æœ¬ä¹¦ï¼Œä¸ç®¡æ˜¯æ–‡å­¦è¿˜æ˜¯ä¸“ä¸šæŠ€æœ¯æ€§ä¹¦ç±ã€‚&lt;/p&gt;
&lt;p&gt;ä»Šå¹´ï¼Œæˆ‘çœ‹äº†ä»¥ä¸‹å‡ æœ¬ä¹¦ï¼Œæœ‰çš„åªçœ‹äº†ä¸€æœ¬ä¹¦ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œå¤§éƒ¨åˆ†éƒ½æ˜¯æ¶‰åŠä¸“ä¸šæŠ€æœ¯çš„ï¼šNettyæƒå¨æŒ‡å—ã€æ·±å…¥ç†è§£Javaå¤šçº¿ç¨‹ã€JavaEEäº’è”ç½‘è½»é‡çº§æŠ€æœ¯æ•´åˆå¼€å‘ã€Javaé«˜å¹¶å‘ç¨‹åºè®¾è®¡ã€‚è¿˜æœ‰å…¶ä»–çš„ä¸€äº›éæŠ€æœ¯ä¹¦å°±ä¸ä¸€ä¸€åˆ—ä¸¾äº†ã€‚ä¸€å¹´æ‰çœ‹è¿™å‡ æœ¬ä¹¦çœŸæ˜¯æœ‰ç‚¹ä¸¢äºº-ã€‚-&lt;/p&gt;
&lt;p&gt;è‡ªè®¤ä¸ºç½‘ç»œæŠ€æœ¯åšå®¢å’Œçº¸è´¨ä¹¦è¿˜æ˜¯æœ‰å„æœ‰å„è‡ªçš„å­˜åœ¨çš„æ„ä¹‰çš„ã€‚å°±æ‹¿çº¸è´¨ä¹¦æ¥è¯´ï¼Œå®ƒèƒ½å¤Ÿé€šè¿‡ä¸€ç³»åˆ—çš„ç›®å½•ï¼Œèƒ½å¤Ÿä»åŸºæœ¬æ¥æºã€åŸºæœ¬åŸç†ã€ä½¿ç”¨åœºæ™¯ã€åº•å±‚åŸç†æŠ€æœ¯ã€å·¥ä½œåº”ç”¨åœºæ™¯æ¥ä¸€ä¸€è¿›è¡Œæœ‰é¡ºåºçš„ç»™äººä»¥çœŸæ­£ç†è§£å’ŒæŒæ¡ã€‚ä¸éœ€è¦è‡ªå·±ä»ç½‘ä¸Šæœåˆ†æ•£çš„çŸ¥è¯†ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä¸æ˜¯çœ‹å®Œä¹¦åå°±å®Œäº†ï¼Œè¿˜éœ€è¦è‡ªå·±é€šè¿‡å®è·µå»è¯æ˜ä½ è‡ªå·±çš„ç†è§£æ˜¯å¦æ­£ç¡®&lt;/strong&gt;ï¼Œè¿™ä¹Ÿæ˜¯ä¸ªä¸å¯æ¬ ç¼ºçš„è¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºä»€ä¹ˆè¿˜éœ€è¦è¯»ä¹¦å‘¢ï¼Œæˆ‘è®¤ä¸ºç½‘ä¸Šä¸€å¥è¯è¿˜æ˜¯ä¸é”™çš„ï¼Œæ˜¯ã€Šç‰©æ¼”é€šè®ºã€‹ä½œè€…ç‹ä¸œå²³è¯´çš„ï¼šâ€œå› ä¸ºé€šè¿‡ç”µè§†æˆ–è€…å…¶ä»–æ–¹å¼æœé›†çš„ä¿¡æ¯ï¼Œå³é‚£ç§é€šè¿‡ç›´è§‚æ–¹å¼æ¥å—çš„çŸ¥è¯†ï¼Œæ˜¯æœ€æµ…æ˜¾ã€æœ€ç²—ç–ä¸”æ²¡æœ‰ç»è¿‡ç²¾å¯†é€»è¾‘è¯æ˜çš„ä¸œè¥¿â€ã€‚&lt;/p&gt;
&lt;p&gt;4ã€æ€è€ƒ&lt;br&gt;
&lt;img src=&#34;https://img-blog.csdnimg.cn/20181231141547586.png&#34; alt=&#34;åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
å…³äºç¨‹åºå‘˜æŠ€æœ¯æ·±åº¦å’Œå¹¿åº¦çš„é€‰æ‹©ï¼Œä¹Ÿæ˜¯ä»ç½‘ä¸Šçœ‹çš„ä¸€å¥è¯ï¼ŒOracleæŠ€æœ¯å¤§ç‰›æ¨æ™“å³°æŒ‡å‡ºï¼šâ€œ&lt;strong&gt;æŠ€æœ¯äººå…ä¸äº†è¦æ„å»ºå¹¿æ³›çš„çŸ¥è¯†ä½“ç³»ï¼Œä½†ç»ˆç©¶è¿˜æ˜¯è¦å…‹åˆ¶ä½è¯±æƒ‘ï¼Œå°†æŸä¸ªé¢†åŸŸåšåˆ°ç²¾æ·±&lt;/strong&gt;ã€‚æ°´æ¡¶çš„æ°´é‡å–å†³äºæœ€çŸ­æ¿ï¼Œä½†æ˜¯å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åœ¨å·¥ä½œä¸­çš„å›æŠ¥ï¼Œæ›´å¤šçš„æºè‡ªäºè‡ªèº«çš„é•¿å¤„ï¼Œç”šè‡³æŸç§ç¨‹åº¦ä¸Šè¿˜å†³å®šäº†æˆ‘ä»¬æ˜¯æ‹¥æœ‰è‡ªå·±é€‰æ‹©çš„è‡ªç”±ï¼Œè¿˜æ˜¯ç–²äºå¥”å‘½ï¼Œå¿…ç»æˆ‘ä»¬æ¯ä¸ªäººçš„ä½“åŠ›ã€ç»å†æœ‰ç°å®çš„ä¸Šé™çš„â€ã€‚&lt;br&gt;
è‡ªè®¤ä¸ºè¿˜æ˜¯å¾ˆæœ‰é“ç†çš„ï¼Œå…ˆå»ºç«‹è‡ªå·±å¹¿åº¦ç½‘ï¼Œç„¶åä¸“é—¨æ‰¾ä¸€é¡¹è‡ªå·±å–œæ¬¢çš„æ–¹å‘ï¼Œç„¶åæ”¾å¼€æ‰‹è„šå»ç ”ç©¶ã€‚è‡³å°‘è¦æœ‰ä¸€ä¸ªéå¸¸æ·±çš„é¢†åŸŸçŸ¥è¯†ï¼Œæ‰€è°“çŸ¥è¯†ä½“ç³»çš„æ­å»ºæ˜¯åŸºäºå¤šä¸ªæ‰å®çš„çŸ¥è¯†ç‚¹æ±‡é›†è€Œæˆï¼Œç‚¹ä¸æ‰å®ä¸æ·±å…¥ã€‚&lt;/p&gt;
&lt;h2 id=&#34;2-å…³äºè®¤çŸ¥&#34;&gt;2ã€å…³äºè®¤çŸ¥&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://img-blog.csdnimg.cn/20181231154812245.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3p5MTUxMTIzNDI0NDk=,size_16,color_FFFFFF,t_70&#34; alt=&#34;åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
1ã€&lt;strong&gt;äººä¸äººæœ€å¤§çš„ä¸åŒï¼šè®¤çŸ¥ä¸åŒ&lt;/strong&gt;&lt;br&gt;
æˆ‘è®¤ä¸ºçš„æˆé•¿å°±æ˜¯è®¤çŸ¥æˆé•¿ï¼Œæ˜¯å¯¹ä¸€é—´äº‹ç‰©çš„ç†è§£å’Œå¤„ç†æ–¹æ³•ã€‚ç”±äºæ¯ä¸ªäººçš„å‡ºç”Ÿå®¶å¢ƒä¸åŒï¼Œç”Ÿæ´»ç¯å¢ƒä¸åŒï¼Œä¹Ÿå°±å½±å“äº†æ¯ä¸ªäººçš„è®¤çŸ¥ï¼Œæ‰€ä»¥äººæ‰ä¼šæœ‰å„è‡ªçš„æƒ³æ³•ï¼Œåšäº‹å‡†åˆ™å’Œå¤„ä¸–æ–¹å¼ã€‚&lt;/p&gt;
&lt;p&gt;2ã€&lt;strong&gt;ä¸æ–­å­¦ä¹ ï¼Œä½¿è‡ªå·±æ›´å€¼é’±ã€‚&lt;/strong&gt;&lt;br&gt;
éƒ½è¯´2018å¹´æ˜¯äº’è”ç½‘å¯’å†¬ï¼Œä½†æ˜¯å¯¹æˆ‘ä»¬æŠ€æœ¯äººæ¥è¯´ï¼Œéš¾ä»¥æ„æˆå½±å“ï¼Œå› ä¸ºåªè¦ä½ æœ‰è¶³å¤Ÿçš„æŠ€æœ¯åº•å­ï¼Œåœ¨å“ªéƒ½å¯ä»¥å…»æ´»è‡ªå·±ã€‚ç”¨æˆ‘ä»¬å®¶ä¹¡è¯æ¥è¯´ï¼Œâ€å­¦å¥½æŠ€æœ¯ï¼Œèµ°åˆ°å¤©ä¸‹éƒ½ä¸æ€•â€œï¼Œè¿™é‡Œæˆ‘ç§è‡ªæŠŠç‰©ç†åŒ–æ”¹æˆæŠ€æœ¯ï¼Œå“ˆå“ˆã€‚&lt;br&gt;
ç»å¸¸éƒ½èƒ½åœ¨ç½‘ä¸Šçœ‹åˆ°ä¸€å¥è¯ï¼Œâ€&lt;strong&gt;äººç”Ÿæœ€é‡è¦çš„æŠ•èµ„æ˜¯è‡ªå·±ã€‚ä½¿è‡ªå·±æ›´å€¼é’±æ‰æ˜¯ç«‹èº«ä¹‹æœ¬ã€‚&lt;/strong&gt;â€œ&lt;/p&gt;
&lt;p&gt;3ã€&lt;strong&gt;é«˜è´¨é‡çš„è¾“å…¥é‡è¦ï¼Œè¾“å‡ºæ¯”è¾“å…¥æ›´é‡è¦&lt;/strong&gt;&lt;br&gt;
å°±æ‹¿çœ‹ä¹¦å†™æ–‡ç« æ¥è¯´ï¼Œå½“æˆ‘ä»¬è¦å†™ç±»ä¼¼é«˜è€ƒé‚£ç§ä½œæ–‡é¢˜ç›®æ—¶å€™ï¼Œå¦‚æœè¿™æ—¶è¯»æ­¦ä¾ å°è¯´ï¼Œé‚£ä¹ˆè‚¯å®šæ˜¯å¯¹äºå†™ä½œæ–‡æ˜¯æ— ç›Šçš„ï¼Œè¿™å°±æ˜¯ä½è´¨é‡çš„è¾“å…¥ï¼Œå¦‚æœçœ‹ä¸€äº›æ–‡å­¦æ–¹é¢çš„ä¹¦çš„è¯ï¼Œé‚£ä¹ˆå¯¹äºå†™ä½œæ˜¯éå¸¸æœ‰å¥½å¤„çš„ã€‚&lt;br&gt;
ä½†æ˜¯ä¸€å‘³çš„è¾“å…¥ï¼Œæå‡çš„æ„ä¹‰ä¸é«˜ï¼Œä¸ªäººè§‚ç‚¹ã€‚æ¯”å¦‚æˆ‘ä»å°å­¦åˆ°å¤§ï¼Œåˆ°ç°åœ¨éƒ½æ²¡å†™è¿‡æ–‡ç« çš„è¯ï¼Œä»¥å‰åœ¨é«˜ä¸­å­¦ä¹ çš„å†™æ–‡ç« çš„èƒ½åŠ›éƒ½æ²¡æœ‰äº†ã€‚æ‰€ä»¥å¦‚æœä¸å»è¾“å‡ºï¼Œé‚£ä¹ˆå­¦ä¹ åˆ°çš„ä¸œè¥¿å°†åœ¨ä»¥åæŸä¸ªæ—¶åˆ»éƒ½ä¼šå¿˜è®°ã€‚&lt;/p&gt;
&lt;h2 id=&#34;3-å…³äºä¸ºäººå¤„äº‹&#34;&gt;3ã€å…³äºä¸ºäººå¤„äº‹&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://img-blog.csdnimg.cn/20181231150512794.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3p5MTUxMTIzNDI0NDk=,size_16,color_FFFFFF,t_70&#34; alt=&#34;åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
æˆ‘è¿™ä¸¾ä¸¤ä¸ªä¾‹å­ï¼š&lt;br&gt;
ä¾‹1ï¼šä¸Šå­¦é‚£ä¼šï¼Œæˆ‘çˆ¸é€æˆ‘å»ç«è½¦ç«™ï¼Œåˆ°äº†é©¬è·¯ä¸Šå‡†å¤‡å«å‡ºç§Ÿè½¦ã€‚è¿™æ—¶å¯¹é¢é©¬è·¯ä¸Šæ¥äº†ä¸€è¾†ç©ºè½¦ï¼Œå¸æœºå¸ˆå‚…çœ‹åˆ°æˆ‘ä»¬æ‹›æ‰‹ï¼Œå°±å‡†å¤‡åˆ°ä¸è¿œå¤„æ‰å¤´ï¼Œç„¶åè¿™æ—¶å€™å¦å¤–ä¸€è¾†å‡ºç§Ÿè½¦å°±åˆšå¥½åœåœ¨æˆ‘ä»¬é¢å‰ï¼Œæˆ‘å‡†å¤‡ä¸Šçœ¼å‰è¿™è¾†è½¦çš„æ—¶å€™ï¼Œæˆ‘çˆ¸å°±æŠŠæˆ‘æ‹‰ä½å«æˆ‘ç­‰ä¹‹å‰é‚£ä¸€è¾†è½¦æ‰å¤´åé‚£è¾†è½¦ï¼Œè€Œä¸”é‚£è¾†è½¦å·²ç»æ‹å¼¯é©¬ä¸Šåˆ°æˆ‘ä»¬è¿™è¾¹æ¥äº†ã€‚ä¹‹åç»“æœå°±æ˜¯ï¼Œæˆ‘å’Œæˆ‘çˆ¸åä¸Šäº†ä¹‹å‰ä¸€è¾†è½¦ï¼Œè€Œä¸”å’Œåœåœ¨æˆ‘ä»¬é¢å‰çš„åä¸€è¾†è½¦å¸ˆå‚…è¯´â€œä¸å¥½æ„æ€æˆ‘ä»¬å·²ç»å«äº†é©¬è·¯å¯¹é¢é‚£ä¸€è¾†è½¦äº†â€œã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä»¶äº‹åˆ°ç°åœ¨æˆ‘è¿˜æœ‰è®°å¿†æ·±åˆ»ï¼Œè¿™é‡Œæˆ‘æƒ³è¯´çš„æ˜¯ï¼Œ&lt;strong&gt;æˆ‘ä»¬åœ¨æ–¹ä¾¿è‡ªå·±çš„åŒæ—¶ï¼Œä¹Ÿè¦æ¢ä½æ€è€ƒè€ƒè™‘åˆ«äººçš„æ„Ÿå—&lt;/strong&gt;ã€‚&lt;br&gt;
æˆ–è®¸å¯¹äºä½ æ¥è¯´æ˜¯ä¸€ä»¶å°äº‹æƒ…ï¼Œç›´æ¥å›¾æ–¹ä¾¿åä¸Šç¦»è‡ªå·±æœ€è¿‘çš„è½¦ã€‚é‚£ä¹Ÿæ— å¯åšéï¼Œæ¢ä½œä»¥å‰çš„æˆ‘ä¹Ÿæ˜¯ï¼Œæ²¡æœ‰æ¢ä½æ€è€ƒè¿‡ã€‚ä½†æ˜¯ç°åœ¨æˆ‘è§‰å¾—æ¢ä½æ€è€ƒä¹Ÿæ˜¯ä¸€ä¸ªæˆå¹´äººåº”å…·å¤‡çš„ç´ è´¨ã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹2ï¼šä¸Šä¸€æ¬¡å…¬å¸æŠ€æœ¯è”è°ƒï¼Œæˆ‘è¿™è¾¹éœ€è¦è¿œç¨‹å’Œå¦ä¸€ä¸ªåˆ†å…¬å¸åŒäº‹è”è°ƒï¼Œæˆ‘è¿™è¾¹å®Œäº‹åéœ€è¦é€šçŸ¥ä»–é‚£è¾¹ï¼Œä»–é‚£è¾¹æ‰èƒ½ç»§ç»­å®Œæˆå·¥ä½œï¼Œç”±äºè‡ªå·±çš„åŸå› ï¼Œè¿™è¾¹åšå®Œï¼Œæ²¡æœ‰åŠæ—¶é€šçŸ¥åˆ°ä»–ä»¬ï¼Œå¯¼è‡´ä»–ä»¬é‚£è¾¹å»¶æœŸã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä»¶äº‹æˆ‘æƒ³è¯´çš„æ˜¯ï¼Œ&lt;strong&gt;æˆ‘ä»¬åœ¨åšäº‹çš„æ—¶å€™ï¼Œæ— è®ºæ˜¯å·¥ä½œè¿˜æ˜¯ç”Ÿæ´»ï¼Œéƒ½ä¸èƒ½å»å› ä¸ºè‡ªå·±è€½æåˆ«äºº&lt;/strong&gt;ï¼Œå› ä¸ºåˆ«äººçš„æ—¶é—´ä¹Ÿæ˜¯æ—¶é—´ï¼Œå’Œæˆ‘ä»¬è‡ªå·±æ˜¯ä¸€æ ·çš„ã€‚&lt;/p&gt;
&lt;h2 id=&#34;4-å…³äºå‹æƒ…çˆ±æƒ…äº²æƒ…&#34;&gt;4ã€å…³äºå‹æƒ…çˆ±æƒ…äº²æƒ…&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://img-blog.csdnimg.cn/20181231151002819.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3p5MTUxMTIzNDI0NDk=,size_16,color_FFFFFF,t_70&#34; alt=&#34;åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
å…³äºå‹æƒ…ï¼šæƒ³å¯¹è¿œæ–¹çš„æœ‹å‹è¯´ &lt;strong&gt;å½“ä½ è¾‰ç…Œæ—¶å€™ï¼Œæˆ‘ç¥è´ºä½ ï¼Œå½“ä½ è½é­„çš„æ—¶å€™ï¼Œæˆ‘éšæ—¶å¸®åŠ©ä½ &lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å…³äºçˆ±æƒ…ï¼šåˆ°ç°åœ¨æˆ‘è¿˜åœ¨æƒ³è‡ªå·±çœŸæ­£æƒ³å»æ‹¥æœ‰çš„æ˜¯ä»€ä¹ˆã€‚&lt;/p&gt;
&lt;p&gt;å…³äºäº²æƒ…ï¼šåªæœ‰åˆ«äººå…³å¿ƒä½ é£çš„é«˜ä¸é«˜ï¼Œæ²¡æœ‰äººä¼šå…³å¿ƒä½ é£çš„ç´¯ä¸ç´¯ï¼Œé™¤äº†å®¶äººã€‚&lt;/p&gt;
&lt;h2 id=&#34;5-2019å¹´å±•æœ›&#34;&gt;5ã€2019å¹´å±•æœ›&lt;/h2&gt;
&lt;p&gt;ç«‹ä¸ªflagï¼Œæ¯•ç«Ÿæ˜¯æœªæ¥çš„äº‹&lt;br&gt;
1ã€ä¸€å‘¨ä¸€æ¬¡è·‘æ­¥+ç¯®çƒ&lt;br&gt;
2ã€ä¸¤ä¸ªæœˆè‡³å°‘çœ‹å®Œä¸€æœ¬ä¹¦&lt;br&gt;
3ã€ä¿æŠ¤å¥½è§†åŠ›&lt;br&gt;
4ã€ç†Ÿæ‚‰é‡‘èæ ¸å¿ƒä¸šåŠ¡&lt;br&gt;
5ã€ä½“é‡ä¸è¶…140&lt;/p&gt;
&lt;h2 id=&#34;æ€»ç»“ä¸€ä¸‹&#34;&gt;æ€»ç»“ä¸€ä¸‹&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://img-blog.csdnimg.cn/20181231162952878.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3p5MTUxMTIzNDI0NDk=,size_16,color_FFFFFF,t_70&#34; alt=&#34;åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
äººçš„æˆé•¿æ˜¯ä¸æ–­è®¤è¯†åˆ°ä»¥å‰çš„è‡ªå·±æ˜¯ä¸€ä¸ªå‚»Xçš„è¿‡ç¨‹ï¼Œå¸Œæœ›æ˜å¹´çš„æˆ‘è®¤ä¸ºä»Šå¹´çš„æˆ‘æ˜¯ä¸€ä¸ªå‚»Xã€‚&lt;/p&gt;
&lt;p&gt;&lt;em&gt;2018-12-31 äºå¼ é¥å‡ºç§Ÿå±‹å†™&lt;/em&gt;&lt;/p&gt;
">2018å¹´æ€»ç»“</a>
      </div>
      
    </div>
    <div class="page">
      <div id="page_ul"></div>
    </div>
  </div>
</div>
<script>
  !function () {
    let searchMask = document.querySelector('#search_mask');
    let result = document.querySelector('#result');
    let items = document.querySelectorAll('.item');
    let searchBox = document.querySelector('#search');
    let statCount = document.querySelector('#stat_count');
    let statTimes = document.querySelector('#stat_times');
    let pageUl = document.querySelector('#page_ul');
    let close = document.querySelector('#close');
    
    close.addEventListener('click', function() {
      searchMask.style = 'display: none;'
    })

    let finds = [];
    let contents = [];
    let pageSize = 10;
    items.forEach(item => {
      let a = item.querySelector('a');
      contents.push({
        title: a.innerText,
        details: a.dataset.c,
        link: a.href
      })
      item.remove();
    })

    function insertStr(soure, start, count) {
      let newStr = soure.substr(start, count);
      return soure.slice(0, start) + '<em>' + newStr + '</em>' + soure.slice(start + count);
    }

    pageUl.addEventListener('click', function(event) {
      let target = event.target;
      if (target.__proto__ === HTMLSpanElement.prototype) {
        appendResults(parseInt(target.dataset.i));
      }
    })

    function appendResults(index) {
      let htmlResult = '';
      let start = index || 0;
      let end = Math.min(start + pageSize, finds.length);
      for (let i = start; i < end; i++) {
        const current = finds[i];
        let html = current.title;
        let sum = 0;
        let positions = current.positions;
        positions.forEach(position => {
          html = insertStr(html, position.start + sum, position.count);
          sum += 9;
        })
        htmlResult += `<div class="item"><a class="result-title" href="${current.link}">${html}</a></div>`;
      }
      result.innerHTML = htmlResult;
      pageUl.innerHTML = '';
      let count = finds.length / pageSize;
      let lis = '';
      if (start !== 0) {
        lis += `<span class="fa fa-angle-left" data-i='${start - 1}'></span>`;
      }
      for (let i = 0; i < count; i++) {
        lis += `<span class='${i === start?'current':''}' data-i='${i}'>${i+1}</span>`;     
      }
      if (start+1 < count) {
        lis += `<span class="fa fa-angle-right" data-i='${start+1}'></span>`;  
      }
      pageUl.innerHTML = lis;
    }

    function search(delay) {
      let timer = null
      return function () {
        clearTimeout(timer)
        timer = setTimeout(() => {
          let start = Date.now();
          let segments = searchBox.value.split(' ').filter(c => c != '');
          if (segments.length <= 0) {
            return;
          }
          finds = [];
          let htmlResult = '';
          contents.forEach(content => {
            let title = content.title;
            let positions = [];
            let find = false;
            segments.forEach((segment) => {
              if (content.title.includes(segment)) {
                find = true;
                positions.push({
                  start: content.title.indexOf(segment),
                  count: segment.length
                })
              } else if (content.details.includes(segment)) {
                find = true;
              }
            });
            if (find) {
              finds.push({
                title: content.title,
                link: content.link,
                positions
              });
            }
          })
          appendResults(0);
          statCount.textContent = finds.length;
          statTimes.textContent = Date.now() - start;
        }, delay)
      }
    }
    searchBox.addEventListener('input', search(200));
  }()
</script>

<input hidden id="copy" />
<script>
  let language = '';
  if (language !== '') {
    let map = new Map();
    if (language === 'en') {
      map.set('search', 'Search');
      map.set('category', 'Categories');
      map.set('article', 'Articles');
      map.set('tag', 'Tags');
      map.set('top', 'Top');
      map.set('publish', 'published');
      map.set('minute', ' minutes');
      map.set('read-more', 'Read More');
      map.set('view', 'View');
      map.set('words', ' words');
      map.set('category-in', 'category in');
      map.set('preview', 'Meta');
      map.set('index', 'Toc');
      map.set('no-archives', "You haven't created yet");
      map.set('archives', " articles in total");
      map.set('cloud-tags', " tags in total");
      map.set('copyright', "Copyright: ");
      map.set('author', "Author: ");
      map.set('link', "Link: ");
      map.set('leave-message', "Leave a message");
      map.set('format', "Links Format");
      map.set('site-name', "Name: ");
      map.set('site-link', "Link: ");
      map.set('site-desc', "Desc: ");
      map.set('stat', " related results, taking ");
      map.set('stat-time', " ms");
      map.set('site-img', "Image: ");
    }

    if (map.size > 0) {
      let lanElems = document.querySelectorAll('.language');
      lanElems.forEach(elem => {
        let lan = elem.dataset.lan, text = map.get(lan);
        if (elem.__proto__ === HTMLInputElement.prototype) {
          elem.placeholder = text
        } else {
          if (elem.dataset.count) {
            text = elem.dataset.count + text;
          }
          elem.textContent = text;
        }
      })
    }
  }
  //æ‹¿æ¥ä¸»ä¹‰(çœŸé¦™)^_^ï¼ŒClipboard å®ç°æ‘˜è‡ªæ˜é‡‘ https://juejin.im/post/5aefeb6e6fb9a07aa43c20af
  window.Clipboard = (function (window, document, navigator) {
    var textArea,
      copy;

    // åˆ¤æ–­æ˜¯ä¸æ˜¯iosç«¯
    function isOS() {
      return navigator.userAgent.match(/ipad|iphone/i);
    }
    //åˆ›å»ºæ–‡æœ¬å…ƒç´ 
    function createTextArea(text) {
      textArea = document.createElement('textArea');
      textArea.value = text;
      textArea.style.width = 0;
      textArea.style.height = 0;
      textArea.clientHeight = 0;
      textArea.clientWidth = 0;
      document.body.appendChild(textArea);
    }
    //é€‰æ‹©å†…å®¹
    function selectText() {
      var range,
        selection;

      if (isOS()) {
        range = document.createRange();
        range.selectNodeContents(textArea);
        selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);
        textArea.setSelectionRange(0, 999999);
      } else {
        textArea.select();
      }
    }

    //å¤åˆ¶åˆ°å‰ªè´´æ¿
    function copyToClipboard() {
      try {
        document.execCommand("Copy")
      } catch (err) {
        alert("å¤åˆ¶é”™è¯¯ï¼è¯·æ‰‹åŠ¨å¤åˆ¶ï¼")
      }
      document.body.removeChild(textArea);
    }

    copy = function (text) {
      createTextArea(text);
      selectText();
      copyToClipboard();
    };

    return {
      copy: copy
    };
  })(window, document, navigator);

  function copyCode(e) {
    if (e.srcElement.tagName === 'SPAN' && e.srcElement.classList.contains('copy-code')) {
      let code = e.currentTarget.querySelector('code');
      var text = code.innerText;
      if (e.srcElement.textContent === 'å¤åˆ¶æˆåŠŸ') {
        console.log('å¤åˆ¶æ“ä½œé¢‘ç‡è¿‡é«˜');
        return;
      }
      e.srcElement.textContent = 'å¤åˆ¶æˆåŠŸ';
      (function (elem) {
        setTimeout(() => {
          if (elem.textContent === 'å¤åˆ¶æˆåŠŸ') {
            elem.textContent = 'å¤åˆ¶ä»£ç '
          }
        }, 1000);
      })(e.srcElement)
      Clipboard.copy(text);
    }
  }

  let pres = document.querySelectorAll('pre');
  pres.forEach(pre => {
    let code = pre.querySelector('code');
    let copyElem = document.createElement('span');
    copyElem.classList.add('copy-code');
    copyElem.textContent = 'å¤åˆ¶ä»£ç ';
    pre.appendChild(copyElem);
    pre.onclick = copyCode
  })

</script>
<script src="/media/js/motion.js"></script>

<script src="https://cdn.jsdelivr.net/gh/cferdinandi/smooth-scroll/dist/smooth-scroll.polyfills.min.js"></script>
<script>
  var scroll = new SmoothScroll('a[href*="#"]', {
    speed: 200
  });
</script>


<script src="/media/js/mouse/love.js"></script>


</html>